<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Risk and maps</title>

<script src="site_libs/header-attrs-2.5/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="my-style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">SBR and El Nino</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa fa fa-home"></span>
     
    About
  </a>
</li>
<li>
  <a href="data_code.html">
    <span class="fa fa fa fa-table"></span>
     
    Datasets
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa fa fa-file-code-o"></span>
     
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="main_spatial.html">Risk and maps</a>
    </li>
    <li>
      <a href="spatiotemporal.html">Spatiotemporal analysis</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Risk and maps</h1>

</div>


<div id="packages" class="section level1">
<h1>Packages</h1>
<pre class="r"><code>library(cowplot)
library(agricolae)
library(tidyverse)
library(epifitter)
library(ggthemes)
library(ggfortify)
library(survival)
library(survminer)
library(patchwork)
library(splancs)
library(stringr)
library(maptools)
library(maps)
library(grid)
library(ggsn)
library(raster)
library(viridis)
library(rgdal)
library(lubridate)
library(sf)
library(sp)
library(spatstat)
library(spatialEco)
library(gganimate)
library(gifski)
library(transformr)
library(rnaturalearth)
library(rnaturalearthhires)
library(&quot;GGally&quot;)
library(INLA)
library(spdep)
library(coxme)
library(gsheet)
library(directlabels)
library(ggrepel)
library(factoextra)
library(FactoMineR)
library(mgcv)
library(tidymv)
library(ggdist)</code></pre>
<p>Standard theme</p>
<pre class="r"><code>theme_set(theme_light())</code></pre>
</div>
<div id="load-sbr-data" class="section level1">
<h1>Load SBR data</h1>
<pre class="r"><code>sbr_rep = read.csv(&quot;data/sbr_rep.csv&quot;) %&gt;% 
  #removing ther X column 
  dplyr::select(-X) %&gt;% 
  
  # tranforming the date columns to type date
  mutate(start_season = as.Date(start_season),
         start_date = as.Date(start_date),
         date_report = as.Date(date_report)) %&gt;% 
  # tranforming the seasons column to type character
  mutate(season = as.character(season))</code></pre>
</div>
<div id="load-enso-data" class="section level1">
<h1>Load ENSO data</h1>
<pre class="r"><code>ensodata2 =read.csv( &quot;data/enso_tidy.csv&quot;) %&gt;% 
  #removing ther X column 
  dplyr::select(-X) %&gt;% 
  # reodering the enso column as &quot;Neutral&quot; &gt; &quot;El Niño&quot; &gt; &quot;La Niña&quot;
  mutate(enso = factor(enso, c(&quot;Neutral&quot;,&quot;El Niño&quot;, &quot;La Niña&quot;))) %&gt;% 
  # tranforming the seasons column to type character
  mutate(season = as.character(season))</code></pre>
<pre class="r"><code>ensodata2 %&gt;% 
  pivot_longer(1:12,
               names_to = &quot;trimester&quot;,
               values_to = &quot;ONI&quot;) %&gt;% 
  mutate(trimester = factor(trimester,
                            levels =c(&quot;DJF&quot;,&quot;JFM&quot;,&quot;FMA&quot;,&quot;MAM&quot;,&quot;AMJ&quot;,&quot;MJJ&quot;,&quot;JJA&quot;,&quot;JAS&quot;,&quot;ASO&quot;,&quot;SON&quot;,&quot;OND&quot;,&quot;NDJ&quot; ) )) %&gt;% 
  ggplot(aes(trimester, ONI, color = enso, group = season))+
  geom_hline(yintercept = 0, color = &quot;gray&quot;)+
  scale_color_colorblind()+
  geom_vline(xintercept = &quot;OND&quot;, color = &quot;gray&quot;)+
stat_summary(fun.y=sum, geom=&quot;line&quot;)+
  geom_hline(yintercept = 0.8, linetype = 2, color = &quot;gray&quot;)+
  geom_hline(yintercept = -0.82, linetype = 2, color = &quot;gray&quot;)+
  theme_half_open()</code></pre>
<pre><code>## Warning: `fun.y` is deprecated. Use `fun` instead.</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>ensodata2 %&gt;% 
  pivot_longer(1:12,
               names_to = &quot;trimester&quot;,
               values_to = &quot;ONI&quot;) %&gt;% 
  mutate(trimester = factor(trimester,
                            levels =c(&quot;DJF&quot;,&quot;JFM&quot;,&quot;FMA&quot;,&quot;MAM&quot;,&quot;AMJ&quot;,&quot;MJJ&quot;,&quot;JJA&quot;,&quot;JAS&quot;,&quot;ASO&quot;,&quot;SON&quot;,&quot;OND&quot;,&quot;NDJ&quot; ) )) %&gt;% 
  filter(trimester %in% c(&quot;JFM&quot;, &quot;MJJ&quot;, &quot;OND&quot;)) %&gt;% 
  ggplot(aes( season,ONI, group = trimester, color = enso))+
  geom_hline(yintercept = 0)+
  geom_hline(yintercept = c(-0.82,0.8), linetype = 2, color = &quot;gray&quot;)+
  geom_errorbar(aes(ymin=0, ymax  = ONI), width = 0, color = &quot;black&quot;)+
  geom_point(size = 3)+
  
  scale_color_colorblind()+
  theme_half_open(font_size = 12)+
  lemon::facet_rep_wrap(~trimester, ncol = 1)+
  scale_y_continuous(breaks = c(-0.82,0,0.8), limits = c(-2,2.6))+
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        # legend.position = &quot;top&quot;,
        strip.background = element_blank())+
  labs(x = &quot;Crop Season&quot;,
       y = &quot;Oceanic Niño Index&quot;,
       color = &quot;ENSO phase (OND)&quot;)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>ggsave(&quot;figs/ONItrimeter.png&quot;, dpi = 600, height = 6, width = 6)</code></pre>
</div>
<div id="overal-map" class="section level1">
<h1>Overal Map</h1>
<div id="loading-map-files" class="section level2">
<h2>Loading map files</h2>
<pre class="r"><code>SUL = ne_countries(
  continent = &quot;South America&quot;,
  returnclass = &quot;sf&quot;)
BRA &lt;- ne_states(
  country   = &quot;brazil&quot;,
  returnclass = &quot;sf&quot;
)

sul_sf = BRA[BRA$name %in% c(&quot;Rio Grande do Sul&quot;,&quot;Santa Catarina&quot;,&quot;Paraná&quot; ),]</code></pre>
</div>
</div>
<div id="summaries" class="section level1">
<h1>Summaries</h1>
<div id="number-of-reports" class="section level4">
<h4>Number of reports</h4>
<pre class="r"><code>sbr_rep %&gt;% 
  summarise(n_reports = length(date_report))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["n_reports"],"name":[1],"type":["int"],"align":["right"]}],"data":[{"1":"2441"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>sbr_rep %&gt;% 
  # group_by(region) %&gt;% 
  summarise(n_reports = length(date_report)) #%&gt;% </code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["n_reports"],"name":[1],"type":["int"],"align":["right"]}],"data":[{"1":"2441"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>  # ungroup() %&gt;% 
  # mutate(total = sum(n_reports),
         # percent = round((n_reports/total)*100,2))</code></pre>
</div>
<div id="number-of-reports-by-state" class="section level4">
<h4>Number of reports by state</h4>
<pre class="r"><code>sbr_rep %&gt;% 
  group_by(state) %&gt;%
  summarise(n_reports = length(date_report))# %&gt;%</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["state"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n_reports"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"PR","2":"1239"},{"1":"RS","2":"969"},{"1":"SC","2":"233"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>  # group_by(region) %&gt;% 
  # mutate(totaal_region = sum(n_reports)) %&gt;% 
  # arrange(region)</code></pre>
<pre class="r"><code>sbr_rep %&gt;% 
  group_by(state, region) %&gt;%
  summarise(n_reports = length(unique(location)))%&gt;% 
  arrange(-n_reports) %&gt;% 
  ggplot(aes(state, n_reports, fill = region))+
  geom_col(color = NA)+
  labs(x = &quot;State&quot;,
       y = &quot;Number of reports&quot;)+
  scale_fill_manual(values = c(&quot;#66c2a5&quot;,&quot;#fc8d62&quot;,&quot;#8da0cb&quot;))+
  scale_y_continuous(breaks = seq(0,400,by =25))+
  theme(legend.position = &quot;none&quot;,
        panel.background = element_blank(),
        panel.grid = element_blank(),
        panel.border = element_blank(),
        axis.line.x = element_line(color = &quot;black&quot;),
        axis.line.y = element_line(color = &quot;black&quot;),
        axis.text.x = element_text(angle = 0))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;state&#39; (override with `.groups` argument)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="number-of-reports-by-season" class="section level4">
<h4>Number of reports by season</h4>
<pre class="r"><code>sbr_rep %&gt;% 
  group_by(season) %&gt;%
  summarise(n_reports = length(date_report))</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n_reports"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"2005","2":"195"},{"1":"2006","2":"215"},{"1":"2007","2":"195"},{"1":"2008","2":"188"},{"1":"2009","2":"209"},{"1":"2010","2":"185"},{"1":"2011","2":"168"},{"1":"2012","2":"27"},{"1":"2013","2":"105"},{"1":"2014","2":"60"},{"1":"2015","2":"178"},{"1":"2016","2":"121"},{"1":"2017","2":"124"},{"1":"2018","2":"161"},{"1":"2019","2":"119"},{"1":"2020","2":"70"},{"1":"2021","2":"121"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>sbr_rep %&gt;% 
  group_by(season,state) %&gt;%
  summarise(n_reports = length(unique(location)))%&gt;% 
  arrange(-n_reports) %&gt;% 
  ggplot(aes(season, n_reports, fill = state))+
  geom_col(color =NA)+
  labs(x = &quot;Crop season&quot;,
       y = &quot;Number of reports&quot;,
       fill = &quot;&quot;)+
 scale_fill_manual(values = c(&quot;#66c2a5&quot;,&quot;#fc8d62&quot;,&quot;#8da0cb&quot;))+
  scale_y_continuous(breaks = seq(0,400,by =25))+
  theme(#legend.position = &quot;none&quot;,
        panel.background = element_blank(),
        panel.grid = element_blank(),
        panel.border = element_blank(),
        axis.line.x = element_line(color = &quot;black&quot;),
        axis.line.y = element_line(color = &quot;black&quot;),
        axis.text.x = element_text(angle = 20))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="early-reports" class="section level4">
<h4>Early reports</h4>
<pre class="r"><code>sbr_rep %&gt;% 
  group_by(season, state) %&gt;%
  summarise(min_report = min(date_report)) %&gt;% 
  mutate(month_min = month(min_report, label = T), 
         day_min = day(min_report)) %&gt;% 
  group_by(month_min) %&gt;% 
  arrange(day_min) %&gt;% 
  arrange(month_min)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["state"],"name":[2],"type":["chr"],"align":["left"]},{"label":["min_report"],"name":[3],"type":["date"],"align":["right"]},{"label":["month_min"],"name":[4],"type":["ord"],"align":["right"]},{"label":["day_min"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"2014","2":"RS","3":"2014-01-02","4":"jan","5":"2"},{"1":"2011","2":"SC","3":"2011-01-03","4":"jan","5":"3"},{"1":"2021","2":"SC","3":"2021-01-04","4":"jan","5":"4"},{"1":"2017","2":"SC","3":"2017-01-07","4":"jan","5":"7"},{"1":"2015","2":"SC","3":"2015-01-08","4":"jan","5":"8"},{"1":"2007","2":"SC","3":"2007-01-09","4":"jan","5":"9"},{"1":"2006","2":"RS","3":"2006-01-10","4":"jan","5":"10"},{"1":"2009","2":"RS","3":"2009-01-10","4":"jan","5":"10"},{"1":"2010","2":"SC","3":"2010-01-10","4":"jan","5":"10"},{"1":"2012","2":"RS","3":"2012-01-10","4":"jan","5":"10"},{"1":"2021","2":"RS","3":"2021-01-16","4":"jan","5":"16"},{"1":"2005","2":"SC","3":"2005-01-17","4":"jan","5":"17"},{"1":"2006","2":"SC","3":"2006-01-20","4":"jan","5":"20"},{"1":"2009","2":"SC","3":"2009-01-26","4":"jan","5":"26"},{"1":"2008","2":"SC","3":"2008-01-29","4":"jan","5":"29"},{"1":"2012","2":"SC","3":"2012-02-01","4":"fev","5":"1"},{"1":"2010","2":"PR","3":"2009-09-29","4":"set","5":"29"},{"1":"2019","2":"PR","3":"2018-10-31","4":"out","5":"31"},{"1":"2013","2":"SC","3":"2012-11-02","4":"nov","5":"2"},{"1":"2016","2":"PR","3":"2015-11-07","4":"nov","5":"7"},{"1":"2006","2":"PR","3":"2005-11-09","4":"nov","5":"9"},{"1":"2019","2":"SC","3":"2018-11-13","4":"nov","5":"13"},{"1":"2007","2":"PR","3":"2006-11-14","4":"nov","5":"14"},{"1":"2017","2":"PR","3":"2016-11-16","4":"nov","5":"16"},{"1":"2005","2":"PR","3":"2004-11-18","4":"nov","5":"18"},{"1":"2016","2":"SC","3":"2015-11-18","4":"nov","5":"18"},{"1":"2010","2":"RS","3":"2009-11-22","4":"nov","5":"22"},{"1":"2018","2":"PR","3":"2017-11-23","4":"nov","5":"23"},{"1":"2011","2":"PR","3":"2010-11-24","4":"nov","5":"24"},{"1":"2019","2":"RS","3":"2018-11-27","4":"nov","5":"27"},{"1":"2016","2":"RS","3":"2015-12-03","4":"dez","5":"3"},{"1":"2020","2":"PR","3":"2019-12-03","4":"dez","5":"3"},{"1":"2012","2":"PR","3":"2011-12-04","4":"dez","5":"4"},{"1":"2013","2":"PR","3":"2012-12-04","4":"dez","5":"4"},{"1":"2015","2":"PR","3":"2014-12-04","4":"dez","5":"4"},{"1":"2015","2":"RS","3":"2014-12-05","4":"dez","5":"5"},{"1":"2018","2":"RS","3":"2017-12-05","4":"dez","5":"5"},{"1":"2008","2":"PR","3":"2007-12-06","4":"dez","5":"6"},{"1":"2007","2":"RS","3":"2006-12-10","4":"dez","5":"10"},{"1":"2020","2":"SC","3":"2019-12-10","4":"dez","5":"10"},{"1":"2021","2":"PR","3":"2020-12-10","4":"dez","5":"10"},{"1":"2020","2":"RS","3":"2019-12-11","4":"dez","5":"11"},{"1":"2009","2":"PR","3":"2008-12-12","4":"dez","5":"12"},{"1":"2011","2":"RS","3":"2010-12-13","4":"dez","5":"13"},{"1":"2018","2":"SC","3":"2017-12-18","4":"dez","5":"18"},{"1":"2013","2":"RS","3":"2012-12-20","4":"dez","5":"20"},{"1":"2017","2":"RS","3":"2016-12-20","4":"dez","5":"20"},{"1":"2005","2":"RS","3":"2004-12-23","4":"dez","5":"23"},{"1":"2014","2":"PR","3":"2013-12-26","4":"dez","5":"26"},{"1":"2008","2":"RS","3":"2007-12-27","4":"dez","5":"27"},{"1":"2014","2":"SC","3":"2013-12-29","4":"dez","5":"29"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="later-reports" class="section level4">
<h4>Later reports</h4>
<pre class="r"><code>sbr_rep %&gt;% 
  group_by(season, state) %&gt;%
  summarise(max_report = max(date_report),
            dap = max(days)) %&gt;% 
  mutate(month_max = month(max_report, label = T), 
         day_max = day(max_report)) %&gt;% 
  group_by(month_max) %&gt;%
  arrange(day_max) %&gt;%
  arrange(month_max) %&gt;%
  ungroup()</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["state"],"name":[2],"type":["chr"],"align":["left"]},{"label":["max_report"],"name":[3],"type":["date"],"align":["right"]},{"label":["dap"],"name":[4],"type":["int"],"align":["right"]},{"label":["month_max"],"name":[5],"type":["ord"],"align":["right"]},{"label":["day_max"],"name":[6],"type":["int"],"align":["right"]}],"data":[{"1":"2016","2":"PR","3":"2016-01-07","4":"100","5":"jan","6":"7"},{"1":"2007","2":"PR","3":"2007-02-05","4":"118","5":"fev","6":"5"},{"1":"2013","2":"SC","3":"2013-02-08","4":"103","5":"fev","6":"8"},{"1":"2019","2":"SC","3":"2019-02-08","4":"93","5":"fev","6":"8"},{"1":"2021","2":"PR","3":"2021-02-12","4":"137","5":"fev","6":"12"},{"1":"2019","2":"PR","3":"2019-02-13","4":"120","5":"fev","6":"13"},{"1":"2017","2":"PR","3":"2017-02-14","4":"132","5":"fev","6":"14"},{"1":"2016","2":"RS","3":"2016-02-15","4":"94","5":"fev","6":"15"},{"1":"2011","2":"SC","3":"2011-02-17","4":"130","5":"fev","6":"17"},{"1":"2017","2":"SC","3":"2017-02-21","4":"106","5":"fev","6":"21"},{"1":"2019","2":"RS","3":"2019-02-21","4":"114","5":"fev","6":"21"},{"1":"2021","2":"SC","3":"2021-02-21","4":"120","5":"fev","6":"21"},{"1":"2005","2":"PR","3":"2005-02-22","4":"138","5":"fev","6":"22"},{"1":"2011","2":"RS","3":"2011-02-22","4":"115","5":"fev","6":"22"},{"1":"2018","2":"PR","3":"2018-02-24","4":"135","5":"fev","6":"24"},{"1":"2010","2":"SC","3":"2010-02-25","4":"141","5":"fev","6":"25"},{"1":"2015","2":"PR","3":"2015-02-27","4":"117","5":"fev","6":"27"},{"1":"2020","2":"SC","3":"2020-02-27","4":"129","5":"fev","6":"27"},{"1":"2010","2":"PR","3":"2010-02-28","4":"117","5":"fev","6":"28"},{"1":"2014","2":"PR","3":"2014-02-28","4":"114","5":"fev","6":"28"},{"1":"2015","2":"RS","3":"2015-03-02","4":"115","5":"mar","6":"2"},{"1":"2007","2":"SC","3":"2007-03-03","4":"125","5":"mar","6":"3"},{"1":"2011","2":"PR","3":"2011-03-03","4":"132","5":"mar","6":"3"},{"1":"2015","2":"SC","3":"2015-03-03","4":"116","5":"mar","6":"3"},{"1":"2020","2":"RS","3":"2020-03-03","4":"121","5":"mar","6":"3"},{"1":"2012","2":"PR","3":"2012-03-05","4":"150","5":"mar","6":"5"},{"1":"2005","2":"SC","3":"2005-03-09","4":"163","5":"mar","6":"9"},{"1":"2012","2":"SC","3":"2012-03-10","4":"141","5":"mar","6":"10"},{"1":"2008","2":"SC","3":"2008-03-11","4":"142","5":"mar","6":"11"},{"1":"2018","2":"RS","3":"2018-03-13","4":"135","5":"mar","6":"13"},{"1":"2020","2":"PR","3":"2020-03-13","4":"133","5":"mar","6":"13"},{"1":"2006","2":"PR","3":"2006-03-14","4":"151","5":"mar","6":"14"},{"1":"2013","2":"RS","3":"2013-03-14","4":"141","5":"mar","6":"14"},{"1":"2013","2":"PR","3":"2013-03-15","4":"128","5":"mar","6":"15"},{"1":"2021","2":"RS","3":"2021-03-15","4":"142","5":"mar","6":"15"},{"1":"2010","2":"RS","3":"2010-03-17","4":"161","5":"mar","6":"17"},{"1":"2009","2":"RS","3":"2009-03-18","4":"161","5":"mar","6":"18"},{"1":"2007","2":"RS","3":"2007-03-20","4":"143","5":"mar","6":"20"},{"1":"2012","2":"RS","3":"2012-03-20","4":"122","5":"mar","6":"20"},{"1":"2005","2":"RS","3":"2005-03-21","4":"147","5":"mar","6":"21"},{"1":"2018","2":"SC","3":"2018-03-21","4":"150","5":"mar","6":"21"},{"1":"2014","2":"RS","3":"2014-03-26","4":"128","5":"mar","6":"26"},{"1":"2017","2":"RS","3":"2017-03-28","4":"136","5":"mar","6":"28"},{"1":"2006","2":"RS","3":"2006-03-30","4":"143","5":"mar","6":"30"},{"1":"2009","2":"SC","3":"2009-04-01","4":"176","5":"abr","6":"1"},{"1":"2008","2":"PR","3":"2008-04-02","4":"172","5":"abr","6":"2"},{"1":"2008","2":"RS","3":"2008-04-09","4":"154","5":"abr","6":"9"},{"1":"2009","2":"PR","3":"2009-04-16","4":"191","5":"abr","6":"16"},{"1":"2006","2":"SC","3":"2006-04-24","4":"168","5":"abr","6":"24"},{"1":"2016","2":"SC","3":"2015-12-01","4":"85","5":"dez","6":"1"},{"1":"2014","2":"SC","3":"2013-12-29","4":"113","5":"dez","6":"29"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>epi_time_br = sbr_rep %&gt;% 
  dplyr::group_by(season) %&gt;%
  dplyr::summarise(min_report = min(date_report), 
            max_report = max(date_report),
            epidemic_time =as.numeric( max_report- min_report)) %&gt;% 
  arrange(epidemic_time)</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
</div>
<div id="epidemic-time-difference-between-early-and-later-reports" class="section level4">
<h4>Epidemic time: Difference between early and later reports</h4>
<pre class="r"><code>epi_time = sbr_rep %&gt;% 
  dplyr::group_by(season) %&gt;%
  dplyr::summarise(min_report = min(date_report), 
            max_report = max(date_report),
            epidemic_time =as.numeric( max_report- min_report)) %&gt;% 
  arrange(epidemic_time) %&gt;% 
  dplyr::select(-max_report,-min_report)</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre class="r"><code>epi_time  </code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["epidemic_time"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"2015","2":"89"},{"1":"2014","2":"90"},{"1":"2021","2":"95"},{"1":"2011","2":"99"},{"1":"2016","2":"100"},{"1":"2020","2":"101"},{"1":"2012","2":"107"},{"1":"2019","2":"113"},{"1":"2018","2":"118"},{"1":"2005","2":"123"},{"1":"2008","2":"125"},{"1":"2009","2":"125"},{"1":"2007","2":"126"},{"1":"2017","2":"132"},{"1":"2013","2":"133"},{"1":"2006","2":"166"},{"1":"2010","2":"169"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>sbr_rep %&gt;% 
  dplyr::group_by(season,region) %&gt;%
  dplyr::summarise(min_report = min(days_sep15), 
            max_report = max(days_sep15),
            time = as.numeric(max_report-min_report)) %&gt;%
  ggplot(aes(y = season, color= region))+
  geom_errorbar(aes(xmin= min_report, xmax = max_report),
                size = .8, width = .5,
                position = position_dodge())+
  labs(x = &quot;Days after September 15th&quot;,
       y = &quot;Crop season&quot;,
       color =&quot;&quot;)+
  scale_color_manual(values = c(&quot;#66c2a5&quot;,&quot;#fc8d62&quot;,&quot;#8da0cb&quot;))+
  scale_x_continuous(limits = c(0,275), breaks = seq(0,275,by = 25))+
  theme(legend.position = &quot;top&quot;,
        panel.background = element_blank(),
        panel.grid = element_blank(),
        panel.border = element_blank(),
        axis.line.x = element_line(color = &quot;black&quot;),
        axis.line.y = element_line(color = &quot;black&quot;),
        axis.text.x = element_text(angle = 0))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<pre class="r"><code># ggsave(&quot;figs/epidemic_rage.png&quot;, dpi=600, height = 6, width = 4)</code></pre>
<pre class="r"><code>sbr_rep %&gt;% 
  dplyr::group_by(season,state) %&gt;%
  dplyr::summarise(min_report = min(days_sep15), 
            max_report = max(days_sep15)
            # time = as.numeric(max_report-min_report)
            ) %&gt;%
  pivot_longer(3:4,
               names_to = &quot;min_max&quot;,
               values_to = &quot;time&quot;) %&gt;% 
  ggplot(aes(time, fill = min_max))+ 
  geom_density(alpha = 0.3)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="number-of-reports-per-day" class="section level4">
<h4>Number of reports per day</h4>
<pre class="r"><code>sbr_rep %&gt;%
  dplyr::group_by(season, date_report) %&gt;% 
  dplyr::summarise(count = n()) %&gt;% 
  arrange(-count)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["date_report"],"name":[2],"type":["date"],"align":["right"]},{"label":["count"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"2015","2":"2015-02-25","3":"21"},{"1":"2015","2":"2015-03-03","3":"19"},{"1":"2010","2":"2010-01-29","3":"17"},{"1":"2015","2":"2015-03-02","3":"15"},{"1":"2005","2":"2005-01-14","3":"14"},{"1":"2010","2":"2010-01-25","3":"14"},{"1":"2005","2":"2005-01-17","3":"13"},{"1":"2008","2":"2008-01-11","3":"13"},{"1":"2015","2":"2015-02-17","3":"13"},{"1":"2009","2":"2009-02-16","3":"12"},{"1":"2010","2":"2010-02-02","3":"12"},{"1":"2015","2":"2015-02-27","3":"12"},{"1":"2006","2":"2006-01-31","3":"11"},{"1":"2006","2":"2006-02-01","3":"11"},{"1":"2007","2":"2007-01-18","3":"11"},{"1":"2009","2":"2009-02-09","3":"11"},{"1":"2005","2":"2005-02-04","3":"10"},{"1":"2006","2":"2006-01-26","3":"10"},{"1":"2018","2":"2018-02-14","3":"10"},{"1":"2007","2":"2007-01-26","3":"9"},{"1":"2010","2":"2010-01-26","3":"9"},{"1":"2011","2":"2011-01-26","3":"9"},{"1":"2016","2":"2016-01-06","3":"9"},{"1":"2005","2":"2005-01-20","3":"8"},{"1":"2005","2":"2005-01-24","3":"8"},{"1":"2005","2":"2005-02-01","3":"8"},{"1":"2006","2":"2006-02-22","3":"8"},{"1":"2007","2":"2007-01-02","3":"8"},{"1":"2007","2":"2007-01-09","3":"8"},{"1":"2008","2":"2008-01-23","3":"8"},{"1":"2008","2":"2008-02-25","3":"8"},{"1":"2009","2":"2009-02-19","3":"8"},{"1":"2009","2":"2009-03-09","3":"8"},{"1":"2011","2":"2011-01-05","3":"8"},{"1":"2011","2":"2011-01-20","3":"8"},{"1":"2011","2":"2011-01-25","3":"8"},{"1":"2011","2":"2011-01-28","3":"8"},{"1":"2019","2":"2018-12-11","3":"8"},{"1":"2005","2":"2005-01-07","3":"7"},{"1":"2005","2":"2005-01-21","3":"7"},{"1":"2005","2":"2005-02-09","3":"7"},{"1":"2006","2":"2006-02-02","3":"7"},{"1":"2006","2":"2006-02-16","3":"7"},{"1":"2006","2":"2006-03-07","3":"7"},{"1":"2007","2":"2007-01-08","3":"7"},{"1":"2007","2":"2007-01-10","3":"7"},{"1":"2008","2":"2008-01-14","3":"7"},{"1":"2008","2":"2008-01-31","3":"7"},{"1":"2008","2":"2008-02-07","3":"7"},{"1":"2008","2":"2008-02-12","3":"7"},{"1":"2008","2":"2008-02-15","3":"7"},{"1":"2009","2":"2009-01-21","3":"7"},{"1":"2009","2":"2009-02-05","3":"7"},{"1":"2009","2":"2009-02-18","3":"7"},{"1":"2011","2":"2011-02-24","3":"7"},{"1":"2015","2":"2015-01-15","3":"7"},{"1":"2015","2":"2015-01-16","3":"7"},{"1":"2016","2":"2015-12-28","3":"7"},{"1":"2016","2":"2016-01-05","3":"7"},{"1":"2017","2":"2017-01-07","3":"7"},{"1":"2017","2":"2017-01-10","3":"7"},{"1":"2021","2":"2021-02-01","3":"7"},{"1":"2005","2":"2005-01-12","3":"6"},{"1":"2006","2":"2006-02-20","3":"6"},{"1":"2007","2":"2007-01-04","3":"6"},{"1":"2008","2":"2008-01-16","3":"6"},{"1":"2008","2":"2008-01-29","3":"6"},{"1":"2009","2":"2009-01-30","3":"6"},{"1":"2009","2":"2009-02-12","3":"6"},{"1":"2009","2":"2009-02-13","3":"6"},{"1":"2009","2":"2009-02-17","3":"6"},{"1":"2009","2":"2009-02-20","3":"6"},{"1":"2010","2":"2010-01-18","3":"6"},{"1":"2010","2":"2010-01-19","3":"6"},{"1":"2010","2":"2010-01-22","3":"6"},{"1":"2013","2":"2013-01-17","3":"6"},{"1":"2015","2":"2015-01-07","3":"6"},{"1":"2015","2":"2015-01-08","3":"6"},{"1":"2017","2":"2017-01-11","3":"6"},{"1":"2018","2":"2018-01-04","3":"6"},{"1":"2018","2":"2018-01-09","3":"6"},{"1":"2018","2":"2018-01-12","3":"6"},{"1":"2018","2":"2018-01-23","3":"6"},{"1":"2018","2":"2018-02-09","3":"6"},{"1":"2018","2":"2018-02-15","3":"6"},{"1":"2019","2":"2018-11-29","3":"6"},{"1":"2021","2":"2021-02-11","3":"6"},{"1":"2005","2":"2005-01-06","3":"5"},{"1":"2005","2":"2005-01-26","3":"5"},{"1":"2005","2":"2005-01-28","3":"5"},{"1":"2005","2":"2005-02-02","3":"5"},{"1":"2005","2":"2005-02-14","3":"5"},{"1":"2006","2":"2006-01-17","3":"5"},{"1":"2006","2":"2006-01-24","3":"5"},{"1":"2006","2":"2006-02-07","3":"5"},{"1":"2006","2":"2006-02-15","3":"5"},{"1":"2007","2":"2007-01-11","3":"5"},{"1":"2007","2":"2007-01-12","3":"5"},{"1":"2007","2":"2007-01-16","3":"5"},{"1":"2007","2":"2007-01-17","3":"5"},{"1":"2007","2":"2007-01-19","3":"5"},{"1":"2007","2":"2007-01-23","3":"5"},{"1":"2008","2":"2008-01-25","3":"5"},{"1":"2008","2":"2008-02-06","3":"5"},{"1":"2009","2":"2009-02-04","3":"5"},{"1":"2009","2":"2009-02-27","3":"5"},{"1":"2009","2":"2009-03-03","3":"5"},{"1":"2009","2":"2009-03-04","3":"5"},{"1":"2010","2":"2010-01-06","3":"5"},{"1":"2010","2":"2010-01-07","3":"5"},{"1":"2010","2":"2010-01-12","3":"5"},{"1":"2010","2":"2010-01-15","3":"5"},{"1":"2011","2":"2011-01-14","3":"5"},{"1":"2011","2":"2011-01-24","3":"5"},{"1":"2011","2":"2011-01-27","3":"5"},{"1":"2013","2":"2013-01-08","3":"5"},{"1":"2013","2":"2013-01-10","3":"5"},{"1":"2013","2":"2013-01-23","3":"5"},{"1":"2015","2":"2015-01-06","3":"5"},{"1":"2015","2":"2015-01-09","3":"5"},{"1":"2015","2":"2015-01-12","3":"5"},{"1":"2016","2":"2015-12-03","3":"5"},{"1":"2016","2":"2015-12-04","3":"5"},{"1":"2016","2":"2015-12-08","3":"5"},{"1":"2016","2":"2016-01-07","3":"5"},{"1":"2017","2":"2017-01-16","3":"5"},{"1":"2017","2":"2017-02-03","3":"5"},{"1":"2018","2":"2018-01-05","3":"5"},{"1":"2018","2":"2018-01-11","3":"5"},{"1":"2019","2":"2018-11-08","3":"5"},{"1":"2021","2":"2021-01-26","3":"5"},{"1":"2021","2":"2021-02-03","3":"5"},{"1":"2021","2":"2021-02-08","3":"5"},{"1":"2021","2":"2021-02-10","3":"5"},{"1":"2021","2":"2021-02-18","3":"5"},{"1":"2005","2":"2005-01-13","3":"4"},{"1":"2005","2":"2005-01-19","3":"4"},{"1":"2005","2":"2005-01-27","3":"4"},{"1":"2005","2":"2005-02-21","3":"4"},{"1":"2006","2":"2005-11-09","3":"4"},{"1":"2006","2":"2006-01-02","3":"4"},{"1":"2006","2":"2006-01-12","3":"4"},{"1":"2006","2":"2006-01-19","3":"4"},{"1":"2006","2":"2006-01-27","3":"4"},{"1":"2006","2":"2006-01-30","3":"4"},{"1":"2006","2":"2006-03-14","3":"4"},{"1":"2007","2":"2006-12-22","3":"4"},{"1":"2007","2":"2007-01-03","3":"4"},{"1":"2007","2":"2007-01-22","3":"4"},{"1":"2007","2":"2007-01-30","3":"4"},{"1":"2007","2":"2007-02-05","3":"4"},{"1":"2007","2":"2007-02-09","3":"4"},{"1":"2007","2":"2007-02-14","3":"4"},{"1":"2007","2":"2007-03-01","3":"4"},{"1":"2007","2":"2007-03-02","3":"4"},{"1":"2007","2":"2007-03-05","3":"4"},{"1":"2008","2":"2008-01-15","3":"4"},{"1":"2008","2":"2008-01-17","3":"4"},{"1":"2008","2":"2008-01-24","3":"4"},{"1":"2008","2":"2008-01-30","3":"4"},{"1":"2008","2":"2008-02-01","3":"4"},{"1":"2008","2":"2008-02-11","3":"4"},{"1":"2008","2":"2008-02-13","3":"4"},{"1":"2008","2":"2008-02-18","3":"4"},{"1":"2008","2":"2008-02-22","3":"4"},{"1":"2009","2":"2009-01-26","3":"4"},{"1":"2009","2":"2009-01-27","3":"4"},{"1":"2009","2":"2009-02-02","3":"4"},{"1":"2009","2":"2009-02-06","3":"4"},{"1":"2009","2":"2009-02-10","3":"4"},{"1":"2009","2":"2009-02-26","3":"4"},{"1":"2009","2":"2009-04-16","3":"4"},{"1":"2010","2":"2009-12-23","3":"4"},{"1":"2010","2":"2010-01-08","3":"4"},{"1":"2010","2":"2010-01-21","3":"4"},{"1":"2010","2":"2010-01-28","3":"4"},{"1":"2011","2":"2011-01-06","3":"4"},{"1":"2011","2":"2011-01-10","3":"4"},{"1":"2011","2":"2011-01-17","3":"4"},{"1":"2011","2":"2011-01-18","3":"4"},{"1":"2011","2":"2011-01-19","3":"4"},{"1":"2011","2":"2011-02-01","3":"4"},{"1":"2011","2":"2011-02-02","3":"4"},{"1":"2011","2":"2011-02-07","3":"4"},{"1":"2011","2":"2011-02-16","3":"4"},{"1":"2011","2":"2011-03-02","3":"4"},{"1":"2013","2":"2013-01-15","3":"4"},{"1":"2013","2":"2013-01-16","3":"4"},{"1":"2013","2":"2013-01-30","3":"4"},{"1":"2013","2":"2013-01-31","3":"4"},{"1":"2013","2":"2013-02-08","3":"4"},{"1":"2014","2":"2014-01-17","3":"4"},{"1":"2014","2":"2014-01-23","3":"4"},{"1":"2015","2":"2015-01-19","3":"4"},{"1":"2015","2":"2015-01-25","3":"4"},{"1":"2016","2":"2015-12-10","3":"4"},{"1":"2016","2":"2015-12-11","3":"4"},{"1":"2016","2":"2015-12-15","3":"4"},{"1":"2016","2":"2015-12-16","3":"4"},{"1":"2016","2":"2016-01-04","3":"4"},{"1":"2017","2":"2017-01-17","3":"4"},{"1":"2017","2":"2017-01-30","3":"4"},{"1":"2018","2":"2018-01-10","3":"4"},{"1":"2018","2":"2018-01-29","3":"4"},{"1":"2018","2":"2018-02-13","3":"4"},{"1":"2018","2":"2018-02-21","3":"4"},{"1":"2019","2":"2018-11-27","3":"4"},{"1":"2019","2":"2018-11-30","3":"4"},{"1":"2019","2":"2018-12-10","3":"4"},{"1":"2019","2":"2019-02-08","3":"4"},{"1":"2020","2":"2020-02-04","3":"4"},{"1":"2021","2":"2021-02-05","3":"4"},{"1":"2021","2":"2021-02-09","3":"4"},{"1":"2021","2":"2021-02-12","3":"4"},{"1":"2021","2":"2021-02-17","3":"4"},{"1":"2005","2":"2004-12-27","3":"3"},{"1":"2005","2":"2004-12-28","3":"3"},{"1":"2005","2":"2005-01-03","3":"3"},{"1":"2005","2":"2005-01-11","3":"3"},{"1":"2005","2":"2005-01-18","3":"3"},{"1":"2005","2":"2005-02-03","3":"3"},{"1":"2006","2":"2005-11-30","3":"3"},{"1":"2006","2":"2005-12-06","3":"3"},{"1":"2006","2":"2006-01-06","3":"3"},{"1":"2006","2":"2006-02-03","3":"3"},{"1":"2006","2":"2006-02-13","3":"3"},{"1":"2006","2":"2006-03-01","3":"3"},{"1":"2006","2":"2006-03-02","3":"3"},{"1":"2006","2":"2006-03-03","3":"3"},{"1":"2006","2":"2006-03-08","3":"3"},{"1":"2007","2":"2006-12-07","3":"3"},{"1":"2007","2":"2006-12-19","3":"3"},{"1":"2007","2":"2007-01-05","3":"3"},{"1":"2007","2":"2007-01-15","3":"3"},{"1":"2007","2":"2007-01-25","3":"3"},{"1":"2007","2":"2007-02-27","3":"3"},{"1":"2007","2":"2007-03-08","3":"3"},{"1":"2008","2":"2007-12-19","3":"3"},{"1":"2008","2":"2007-12-27","3":"3"},{"1":"2008","2":"2008-01-10","3":"3"},{"1":"2008","2":"2008-01-22","3":"3"},{"1":"2008","2":"2008-02-08","3":"3"},{"1":"2008","2":"2008-02-14","3":"3"},{"1":"2008","2":"2008-02-29","3":"3"},{"1":"2008","2":"2008-03-03","3":"3"},{"1":"2009","2":"2009-01-22","3":"3"},{"1":"2009","2":"2009-01-28","3":"3"},{"1":"2009","2":"2009-01-29","3":"3"},{"1":"2009","2":"2009-02-03","3":"3"},{"1":"2009","2":"2009-02-23","3":"3"},{"1":"2009","2":"2009-02-25","3":"3"},{"1":"2009","2":"2009-03-05","3":"3"},{"1":"2009","2":"2009-03-16","3":"3"},{"1":"2009","2":"2009-03-18","3":"3"},{"1":"2009","2":"2009-03-25","3":"3"},{"1":"2009","2":"2009-03-31","3":"3"},{"1":"2009","2":"2009-04-01","3":"3"},{"1":"2010","2":"2009-12-29","3":"3"},{"1":"2010","2":"2010-01-05","3":"3"},{"1":"2010","2":"2010-01-10","3":"3"},{"1":"2010","2":"2010-01-13","3":"3"},{"1":"2010","2":"2010-01-27","3":"3"},{"1":"2010","2":"2010-02-01","3":"3"},{"1":"2010","2":"2010-02-12","3":"3"},{"1":"2010","2":"2010-02-18","3":"3"},{"1":"2010","2":"2010-02-22","3":"3"},{"1":"2011","2":"2010-12-17","3":"3"},{"1":"2011","2":"2010-12-28","3":"3"},{"1":"2011","2":"2010-12-30","3":"3"},{"1":"2011","2":"2011-01-03","3":"3"},{"1":"2011","2":"2011-01-04","3":"3"},{"1":"2011","2":"2011-01-11","3":"3"},{"1":"2011","2":"2011-01-21","3":"3"},{"1":"2011","2":"2011-02-03","3":"3"},{"1":"2011","2":"2011-02-10","3":"3"},{"1":"2011","2":"2011-02-18","3":"3"},{"1":"2013","2":"2013-01-03","3":"3"},{"1":"2013","2":"2013-01-04","3":"3"},{"1":"2013","2":"2013-01-18","3":"3"},{"1":"2013","2":"2013-01-25","3":"3"},{"1":"2013","2":"2013-01-28","3":"3"},{"1":"2013","2":"2013-02-11","3":"3"},{"1":"2013","2":"2013-02-25","3":"3"},{"1":"2013","2":"2013-02-27","3":"3"},{"1":"2014","2":"2014-01-08","3":"3"},{"1":"2014","2":"2014-01-10","3":"3"},{"1":"2014","2":"2014-01-22","3":"3"},{"1":"2014","2":"2014-02-28","3":"3"},{"1":"2015","2":"2014-12-23","3":"3"},{"1":"2015","2":"2015-01-13","3":"3"},{"1":"2015","2":"2015-01-22","3":"3"},{"1":"2015","2":"2015-02-18","3":"3"},{"1":"2015","2":"2015-02-19","3":"3"},{"1":"2015","2":"2015-02-24","3":"3"},{"1":"2016","2":"2015-12-07","3":"3"},{"1":"2016","2":"2015-12-17","3":"3"},{"1":"2016","2":"2015-12-18","3":"3"},{"1":"2016","2":"2015-12-22","3":"3"},{"1":"2016","2":"2015-12-29","3":"3"},{"1":"2016","2":"2015-12-30","3":"3"},{"1":"2016","2":"2016-01-14","3":"3"},{"1":"2017","2":"2017-01-04","3":"3"},{"1":"2017","2":"2017-01-06","3":"3"},{"1":"2017","2":"2017-01-12","3":"3"},{"1":"2017","2":"2017-02-01","3":"3"},{"1":"2017","2":"2017-02-02","3":"3"},{"1":"2017","2":"2017-02-10","3":"3"},{"1":"2017","2":"2017-02-14","3":"3"},{"1":"2017","2":"2017-03-06","3":"3"},{"1":"2017","2":"2017-03-10","3":"3"},{"1":"2018","2":"2017-12-06","3":"3"},{"1":"2018","2":"2017-12-26","3":"3"},{"1":"2018","2":"2017-12-27","3":"3"},{"1":"2018","2":"2017-12-28","3":"3"},{"1":"2018","2":"2018-01-03","3":"3"},{"1":"2018","2":"2018-01-06","3":"3"},{"1":"2018","2":"2018-01-15","3":"3"},{"1":"2018","2":"2018-01-18","3":"3"},{"1":"2018","2":"2018-01-24","3":"3"},{"1":"2018","2":"2018-01-25","3":"3"},{"1":"2018","2":"2018-01-30","3":"3"},{"1":"2018","2":"2018-02-05","3":"3"},{"1":"2019","2":"2018-11-12","3":"3"},{"1":"2019","2":"2018-11-13","3":"3"},{"1":"2019","2":"2018-11-20","3":"3"},{"1":"2019","2":"2019-01-07","3":"3"},{"1":"2019","2":"2019-01-22","3":"3"},{"1":"2019","2":"2019-01-23","3":"3"},{"1":"2019","2":"2019-01-28","3":"3"},{"1":"2019","2":"2019-02-04","3":"3"},{"1":"2019","2":"2019-02-13","3":"3"},{"1":"2020","2":"2019-12-11","3":"3"},{"1":"2020","2":"2020-01-22","3":"3"},{"1":"2021","2":"2021-01-25","3":"3"},{"1":"2021","2":"2021-02-02","3":"3"},{"1":"2021","2":"2021-02-04","3":"3"},{"1":"2021","2":"2021-02-16","3":"3"},{"1":"2021","2":"2021-02-19","3":"3"},{"1":"2021","2":"2021-02-22","3":"3"},{"1":"2021","2":"2021-02-23","3":"3"},{"1":"2021","2":"2021-02-25","3":"3"},{"1":"2021","2":"2021-02-26","3":"3"},{"1":"2005","2":"2004-12-13","3":"2"},{"1":"2005","2":"2004-12-20","3":"2"},{"1":"2005","2":"2004-12-23","3":"2"},{"1":"2005","2":"2005-01-04","3":"2"},{"1":"2005","2":"2005-01-05","3":"2"},{"1":"2005","2":"2005-01-10","3":"2"},{"1":"2005","2":"2005-02-13","3":"2"},{"1":"2005","2":"2005-02-15","3":"2"},{"1":"2005","2":"2005-02-17","3":"2"},{"1":"2005","2":"2005-02-24","3":"2"},{"1":"2005","2":"2005-03-03","3":"2"},{"1":"2005","2":"2005-03-09","3":"2"},{"1":"2005","2":"2005-03-17","3":"2"},{"1":"2006","2":"2005-11-22","3":"2"},{"1":"2006","2":"2005-12-08","3":"2"},{"1":"2006","2":"2005-12-13","3":"2"},{"1":"2006","2":"2005-12-29","3":"2"},{"1":"2006","2":"2006-01-10","3":"2"},{"1":"2006","2":"2006-01-11","3":"2"},{"1":"2006","2":"2006-01-13","3":"2"},{"1":"2006","2":"2006-01-18","3":"2"},{"1":"2006","2":"2006-01-20","3":"2"},{"1":"2006","2":"2006-01-23","3":"2"},{"1":"2006","2":"2006-01-25","3":"2"},{"1":"2006","2":"2006-01-28","3":"2"},{"1":"2006","2":"2006-02-04","3":"2"},{"1":"2006","2":"2006-02-06","3":"2"},{"1":"2006","2":"2006-02-09","3":"2"},{"1":"2006","2":"2006-02-10","3":"2"},{"1":"2006","2":"2006-02-14","3":"2"},{"1":"2006","2":"2006-02-17","3":"2"},{"1":"2006","2":"2006-02-24","3":"2"},{"1":"2006","2":"2006-03-09","3":"2"},{"1":"2007","2":"2006-12-08","3":"2"},{"1":"2007","2":"2007-01-01","3":"2"},{"1":"2007","2":"2007-01-29","3":"2"},{"1":"2007","2":"2007-02-01","3":"2"},{"1":"2007","2":"2007-02-07","3":"2"},{"1":"2007","2":"2007-02-12","3":"2"},{"1":"2007","2":"2007-02-16","3":"2"},{"1":"2007","2":"2007-02-21","3":"2"},{"1":"2007","2":"2007-02-23","3":"2"},{"1":"2007","2":"2007-02-26","3":"2"},{"1":"2007","2":"2007-03-06","3":"2"},{"1":"2007","2":"2007-03-13","3":"2"},{"1":"2008","2":"2007-12-20","3":"2"},{"1":"2008","2":"2007-12-21","3":"2"},{"1":"2008","2":"2007-12-28","3":"2"},{"1":"2008","2":"2008-01-08","3":"2"},{"1":"2008","2":"2008-02-28","3":"2"},{"1":"2008","2":"2008-03-27","3":"2"},{"1":"2009","2":"2009-01-13","3":"2"},{"1":"2009","2":"2009-01-16","3":"2"},{"1":"2009","2":"2009-02-11","3":"2"},{"1":"2009","2":"2009-03-06","3":"2"},{"1":"2009","2":"2009-03-10","3":"2"},{"1":"2009","2":"2009-03-11","3":"2"},{"1":"2009","2":"2009-03-13","3":"2"},{"1":"2009","2":"2009-03-20","3":"2"},{"1":"2009","2":"2009-03-30","3":"2"},{"1":"2010","2":"2009-11-25","3":"2"},{"1":"2010","2":"2009-12-07","3":"2"},{"1":"2010","2":"2009-12-10","3":"2"},{"1":"2010","2":"2009-12-11","3":"2"},{"1":"2010","2":"2009-12-14","3":"2"},{"1":"2010","2":"2009-12-28","3":"2"},{"1":"2010","2":"2009-12-30","3":"2"},{"1":"2010","2":"2010-01-04","3":"2"},{"1":"2010","2":"2010-01-11","3":"2"},{"1":"2010","2":"2010-01-14","3":"2"},{"1":"2010","2":"2010-01-16","3":"2"},{"1":"2010","2":"2010-02-09","3":"2"},{"1":"2011","2":"2010-11-29","3":"2"},{"1":"2011","2":"2010-12-02","3":"2"},{"1":"2011","2":"2010-12-13","3":"2"},{"1":"2011","2":"2010-12-27","3":"2"},{"1":"2011","2":"2011-02-05","3":"2"},{"1":"2011","2":"2011-02-17","3":"2"},{"1":"2011","2":"2011-02-28","3":"2"},{"1":"2011","2":"2011-03-03","3":"2"},{"1":"2012","2":"2011-12-19","3":"2"},{"1":"2012","2":"2012-01-30","3":"2"},{"1":"2012","2":"2012-02-15","3":"2"},{"1":"2013","2":"2013-01-07","3":"2"},{"1":"2013","2":"2013-01-14","3":"2"},{"1":"2013","2":"2013-01-22","3":"2"},{"1":"2013","2":"2013-01-29","3":"2"},{"1":"2013","2":"2013-02-01","3":"2"},{"1":"2013","2":"2013-02-06","3":"2"},{"1":"2013","2":"2013-02-13","3":"2"},{"1":"2013","2":"2013-02-14","3":"2"},{"1":"2013","2":"2013-02-20","3":"2"},{"1":"2014","2":"2014-01-13","3":"2"},{"1":"2014","2":"2014-01-24","3":"2"},{"1":"2014","2":"2014-01-27","3":"2"},{"1":"2014","2":"2014-01-29","3":"2"},{"1":"2014","2":"2014-02-10","3":"2"},{"1":"2014","2":"2014-02-15","3":"2"},{"1":"2014","2":"2014-02-19","3":"2"},{"1":"2014","2":"2014-02-21","3":"2"},{"1":"2014","2":"2014-02-22","3":"2"},{"1":"2015","2":"2014-12-04","3":"2"},{"1":"2015","2":"2014-12-22","3":"2"},{"1":"2015","2":"2015-01-02","3":"2"},{"1":"2015","2":"2015-01-21","3":"2"},{"1":"2015","2":"2015-01-23","3":"2"},{"1":"2015","2":"2015-02-03","3":"2"},{"1":"2015","2":"2015-02-04","3":"2"},{"1":"2016","2":"2015-11-20","3":"2"},{"1":"2016","2":"2015-11-23","3":"2"},{"1":"2016","2":"2015-11-27","3":"2"},{"1":"2016","2":"2015-11-30","3":"2"},{"1":"2016","2":"2015-12-01","3":"2"},{"1":"2016","2":"2015-12-02","3":"2"},{"1":"2016","2":"2015-12-06","3":"2"},{"1":"2016","2":"2015-12-09","3":"2"},{"1":"2016","2":"2016-01-02","3":"2"},{"1":"2016","2":"2016-01-09","3":"2"},{"1":"2016","2":"2016-01-12","3":"2"},{"1":"2016","2":"2016-01-19","3":"2"},{"1":"2017","2":"2016-12-16","3":"2"},{"1":"2017","2":"2016-12-20","3":"2"},{"1":"2017","2":"2016-12-21","3":"2"},{"1":"2017","2":"2016-12-26","3":"2"},{"1":"2017","2":"2017-01-02","3":"2"},{"1":"2017","2":"2017-01-03","3":"2"},{"1":"2017","2":"2017-01-05","3":"2"},{"1":"2017","2":"2017-01-09","3":"2"},{"1":"2017","2":"2017-01-19","3":"2"},{"1":"2017","2":"2017-02-07","3":"2"},{"1":"2017","2":"2017-02-08","3":"2"},{"1":"2017","2":"2017-02-09","3":"2"},{"1":"2017","2":"2017-03-13","3":"2"},{"1":"2017","2":"2017-03-15","3":"2"},{"1":"2017","2":"2017-03-17","3":"2"},{"1":"2017","2":"2017-03-20","3":"2"},{"1":"2018","2":"2017-11-23","3":"2"},{"1":"2018","2":"2017-12-01","3":"2"},{"1":"2018","2":"2017-12-18","3":"2"},{"1":"2018","2":"2017-12-21","3":"2"},{"1":"2018","2":"2017-12-23","3":"2"},{"1":"2018","2":"2018-01-16","3":"2"},{"1":"2018","2":"2018-01-22","3":"2"},{"1":"2018","2":"2018-01-28","3":"2"},{"1":"2018","2":"2018-02-02","3":"2"},{"1":"2018","2":"2018-02-20","3":"2"},{"1":"2018","2":"2018-02-23","3":"2"},{"1":"2018","2":"2018-02-27","3":"2"},{"1":"2019","2":"2018-11-16","3":"2"},{"1":"2019","2":"2018-11-19","3":"2"},{"1":"2019","2":"2018-11-28","3":"2"},{"1":"2019","2":"2018-12-07","3":"2"},{"1":"2019","2":"2018-12-18","3":"2"},{"1":"2019","2":"2018-12-24","3":"2"},{"1":"2019","2":"2018-12-26","3":"2"},{"1":"2019","2":"2019-01-04","3":"2"},{"1":"2019","2":"2019-01-08","3":"2"},{"1":"2019","2":"2019-01-15","3":"2"},{"1":"2019","2":"2019-01-17","3":"2"},{"1":"2019","2":"2019-01-19","3":"2"},{"1":"2019","2":"2019-02-05","3":"2"},{"1":"2020","2":"2019-12-13","3":"2"},{"1":"2020","2":"2020-01-03","3":"2"},{"1":"2020","2":"2020-01-08","3":"2"},{"1":"2020","2":"2020-01-10","3":"2"},{"1":"2020","2":"2020-01-13","3":"2"},{"1":"2020","2":"2020-01-16","3":"2"},{"1":"2020","2":"2020-01-27","3":"2"},{"1":"2020","2":"2020-02-03","3":"2"},{"1":"2020","2":"2020-02-06","3":"2"},{"1":"2020","2":"2020-02-07","3":"2"},{"1":"2020","2":"2020-02-10","3":"2"},{"1":"2020","2":"2020-02-11","3":"2"},{"1":"2020","2":"2020-02-13","3":"2"},{"1":"2020","2":"2020-02-17","3":"2"},{"1":"2020","2":"2020-02-19","3":"2"},{"1":"2020","2":"2020-02-20","3":"2"},{"1":"2021","2":"2020-12-15","3":"2"},{"1":"2021","2":"2021-01-04","3":"2"},{"1":"2021","2":"2021-01-12","3":"2"},{"1":"2021","2":"2021-01-13","3":"2"},{"1":"2021","2":"2021-01-19","3":"2"},{"1":"2021","2":"2021-01-27","3":"2"},{"1":"2021","2":"2021-01-28","3":"2"},{"1":"2021","2":"2021-02-07","3":"2"},{"1":"2021","2":"2021-03-09","3":"2"},{"1":"2005","2":"2004-11-18","3":"1"},{"1":"2005","2":"2004-12-14","3":"1"},{"1":"2005","2":"2004-12-15","3":"1"},{"1":"2005","2":"2004-12-17","3":"1"},{"1":"2005","2":"2004-12-29","3":"1"},{"1":"2005","2":"2004-12-30","3":"1"},{"1":"2005","2":"2005-01-01","3":"1"},{"1":"2005","2":"2005-01-22","3":"1"},{"1":"2005","2":"2005-01-25","3":"1"},{"1":"2005","2":"2005-01-31","3":"1"},{"1":"2005","2":"2005-02-10","3":"1"},{"1":"2005","2":"2005-02-11","3":"1"},{"1":"2005","2":"2005-02-16","3":"1"},{"1":"2005","2":"2005-02-18","3":"1"},{"1":"2005","2":"2005-02-22","3":"1"},{"1":"2005","2":"2005-02-23","3":"1"},{"1":"2005","2":"2005-02-25","3":"1"},{"1":"2005","2":"2005-03-02","3":"1"},{"1":"2005","2":"2005-03-10","3":"1"},{"1":"2005","2":"2005-03-11","3":"1"},{"1":"2005","2":"2005-03-16","3":"1"},{"1":"2005","2":"2005-03-21","3":"1"},{"1":"2006","2":"2005-11-16","3":"1"},{"1":"2006","2":"2005-11-17","3":"1"},{"1":"2006","2":"2005-11-21","3":"1"},{"1":"2006","2":"2005-11-25","3":"1"},{"1":"2006","2":"2005-11-29","3":"1"},{"1":"2006","2":"2005-12-01","3":"1"},{"1":"2006","2":"2005-12-02","3":"1"},{"1":"2006","2":"2005-12-05","3":"1"},{"1":"2006","2":"2005-12-11","3":"1"},{"1":"2006","2":"2005-12-12","3":"1"},{"1":"2006","2":"2005-12-15","3":"1"},{"1":"2006","2":"2005-12-16","3":"1"},{"1":"2006","2":"2005-12-19","3":"1"},{"1":"2006","2":"2005-12-20","3":"1"},{"1":"2006","2":"2005-12-21","3":"1"},{"1":"2006","2":"2005-12-28","3":"1"},{"1":"2006","2":"2006-01-04","3":"1"},{"1":"2006","2":"2006-01-09","3":"1"},{"1":"2006","2":"2006-01-16","3":"1"},{"1":"2006","2":"2006-02-08","3":"1"},{"1":"2006","2":"2006-02-18","3":"1"},{"1":"2006","2":"2006-02-19","3":"1"},{"1":"2006","2":"2006-02-23","3":"1"},{"1":"2006","2":"2006-03-10","3":"1"},{"1":"2006","2":"2006-03-13","3":"1"},{"1":"2006","2":"2006-03-15","3":"1"},{"1":"2006","2":"2006-03-17","3":"1"},{"1":"2006","2":"2006-03-21","3":"1"},{"1":"2006","2":"2006-03-23","3":"1"},{"1":"2006","2":"2006-03-27","3":"1"},{"1":"2006","2":"2006-03-29","3":"1"},{"1":"2006","2":"2006-03-30","3":"1"},{"1":"2006","2":"2006-04-24","3":"1"},{"1":"2007","2":"2006-11-14","3":"1"},{"1":"2007","2":"2006-11-19","3":"1"},{"1":"2007","2":"2006-11-22","3":"1"},{"1":"2007","2":"2006-12-06","3":"1"},{"1":"2007","2":"2006-12-10","3":"1"},{"1":"2007","2":"2006-12-14","3":"1"},{"1":"2007","2":"2006-12-15","3":"1"},{"1":"2007","2":"2006-12-18","3":"1"},{"1":"2007","2":"2006-12-21","3":"1"},{"1":"2007","2":"2006-12-26","3":"1"},{"1":"2007","2":"2006-12-30","3":"1"},{"1":"2007","2":"2007-01-27","3":"1"},{"1":"2007","2":"2007-01-31","3":"1"},{"1":"2007","2":"2007-02-02","3":"1"},{"1":"2007","2":"2007-02-06","3":"1"},{"1":"2007","2":"2007-02-08","3":"1"},{"1":"2007","2":"2007-02-13","3":"1"},{"1":"2007","2":"2007-03-03","3":"1"},{"1":"2007","2":"2007-03-04","3":"1"},{"1":"2007","2":"2007-03-07","3":"1"},{"1":"2007","2":"2007-03-12","3":"1"},{"1":"2007","2":"2007-03-14","3":"1"},{"1":"2007","2":"2007-03-16","3":"1"},{"1":"2007","2":"2007-03-20","3":"1"},{"1":"2008","2":"2007-12-06","3":"1"},{"1":"2008","2":"2007-12-17","3":"1"},{"1":"2008","2":"2008-01-02","3":"1"},{"1":"2008","2":"2008-01-03","3":"1"},{"1":"2008","2":"2008-01-04","3":"1"},{"1":"2008","2":"2008-01-07","3":"1"},{"1":"2008","2":"2008-01-12","3":"1"},{"1":"2008","2":"2008-01-13","3":"1"},{"1":"2008","2":"2008-01-18","3":"1"},{"1":"2008","2":"2008-01-21","3":"1"},{"1":"2008","2":"2008-01-27","3":"1"},{"1":"2008","2":"2008-01-28","3":"1"},{"1":"2008","2":"2008-02-05","3":"1"},{"1":"2008","2":"2008-02-09","3":"1"},{"1":"2008","2":"2008-02-19","3":"1"},{"1":"2008","2":"2008-02-20","3":"1"},{"1":"2008","2":"2008-02-21","3":"1"},{"1":"2008","2":"2008-02-26","3":"1"},{"1":"2008","2":"2008-02-27","3":"1"},{"1":"2008","2":"2008-03-04","3":"1"},{"1":"2008","2":"2008-03-05","3":"1"},{"1":"2008","2":"2008-03-06","3":"1"},{"1":"2008","2":"2008-03-07","3":"1"},{"1":"2008","2":"2008-03-10","3":"1"},{"1":"2008","2":"2008-03-11","3":"1"},{"1":"2008","2":"2008-03-13","3":"1"},{"1":"2008","2":"2008-03-17","3":"1"},{"1":"2008","2":"2008-03-18","3":"1"},{"1":"2008","2":"2008-04-02","3":"1"},{"1":"2008","2":"2008-04-09","3":"1"},{"1":"2009","2":"2008-12-12","3":"1"},{"1":"2009","2":"2009-01-05","3":"1"},{"1":"2009","2":"2009-01-09","3":"1"},{"1":"2009","2":"2009-01-10","3":"1"},{"1":"2009","2":"2009-01-12","3":"1"},{"1":"2009","2":"2009-01-14","3":"1"},{"1":"2009","2":"2009-01-17","3":"1"},{"1":"2009","2":"2009-01-20","3":"1"},{"1":"2009","2":"2009-01-23","3":"1"},{"1":"2009","2":"2009-02-14","3":"1"},{"1":"2009","2":"2009-03-07","3":"1"},{"1":"2009","2":"2009-03-12","3":"1"},{"1":"2009","2":"2009-03-17","3":"1"},{"1":"2009","2":"2009-03-23","3":"1"},{"1":"2009","2":"2009-03-24","3":"1"},{"1":"2009","2":"2009-03-27","3":"1"},{"1":"2009","2":"2009-04-06","3":"1"},{"1":"2010","2":"2009-09-29","3":"1"},{"1":"2010","2":"2009-10-09","3":"1"},{"1":"2010","2":"2009-11-22","3":"1"},{"1":"2010","2":"2009-11-24","3":"1"},{"1":"2010","2":"2009-12-08","3":"1"},{"1":"2010","2":"2009-12-09","3":"1"},{"1":"2010","2":"2009-12-17","3":"1"},{"1":"2010","2":"2009-12-18","3":"1"},{"1":"2010","2":"2009-12-26","3":"1"},{"1":"2010","2":"2010-01-01","3":"1"},{"1":"2010","2":"2010-01-02","3":"1"},{"1":"2010","2":"2010-01-17","3":"1"},{"1":"2010","2":"2010-01-20","3":"1"},{"1":"2010","2":"2010-01-23","3":"1"},{"1":"2010","2":"2010-01-30","3":"1"},{"1":"2010","2":"2010-02-04","3":"1"},{"1":"2010","2":"2010-02-15","3":"1"},{"1":"2010","2":"2010-02-19","3":"1"},{"1":"2010","2":"2010-02-20","3":"1"},{"1":"2010","2":"2010-02-24","3":"1"},{"1":"2010","2":"2010-02-25","3":"1"},{"1":"2010","2":"2010-02-26","3":"1"},{"1":"2010","2":"2010-02-28","3":"1"},{"1":"2010","2":"2010-03-02","3":"1"},{"1":"2010","2":"2010-03-03","3":"1"},{"1":"2010","2":"2010-03-05","3":"1"},{"1":"2010","2":"2010-03-10","3":"1"},{"1":"2010","2":"2010-03-17","3":"1"},{"1":"2011","2":"2010-11-24","3":"1"},{"1":"2011","2":"2010-11-30","3":"1"},{"1":"2011","2":"2010-12-09","3":"1"},{"1":"2011","2":"2010-12-10","3":"1"},{"1":"2011","2":"2010-12-16","3":"1"},{"1":"2011","2":"2010-12-20","3":"1"},{"1":"2011","2":"2010-12-21","3":"1"},{"1":"2011","2":"2010-12-22","3":"1"},{"1":"2011","2":"2010-12-29","3":"1"},{"1":"2011","2":"2011-01-12","3":"1"},{"1":"2011","2":"2011-01-15","3":"1"},{"1":"2011","2":"2011-01-29","3":"1"},{"1":"2011","2":"2011-01-30","3":"1"},{"1":"2011","2":"2011-01-31","3":"1"},{"1":"2011","2":"2011-02-08","3":"1"},{"1":"2011","2":"2011-02-09","3":"1"},{"1":"2011","2":"2011-02-11","3":"1"},{"1":"2011","2":"2011-02-14","3":"1"},{"1":"2011","2":"2011-02-22","3":"1"},{"1":"2012","2":"2011-12-04","3":"1"},{"1":"2012","2":"2011-12-06","3":"1"},{"1":"2012","2":"2011-12-07","3":"1"},{"1":"2012","2":"2011-12-08","3":"1"},{"1":"2012","2":"2011-12-12","3":"1"},{"1":"2012","2":"2011-12-14","3":"1"},{"1":"2012","2":"2011-12-23","3":"1"},{"1":"2012","2":"2011-12-30","3":"1"},{"1":"2012","2":"2012-01-10","3":"1"},{"1":"2012","2":"2012-01-19","3":"1"},{"1":"2012","2":"2012-01-27","3":"1"},{"1":"2012","2":"2012-02-01","3":"1"},{"1":"2012","2":"2012-02-03","3":"1"},{"1":"2012","2":"2012-02-06","3":"1"},{"1":"2012","2":"2012-02-17","3":"1"},{"1":"2012","2":"2012-02-23","3":"1"},{"1":"2012","2":"2012-02-27","3":"1"},{"1":"2012","2":"2012-03-05","3":"1"},{"1":"2012","2":"2012-03-10","3":"1"},{"1":"2012","2":"2012-03-19","3":"1"},{"1":"2012","2":"2012-03-20","3":"1"},{"1":"2013","2":"2012-11-02","3":"1"},{"1":"2013","2":"2012-12-04","3":"1"},{"1":"2013","2":"2012-12-06","3":"1"},{"1":"2013","2":"2012-12-07","3":"1"},{"1":"2013","2":"2012-12-10","3":"1"},{"1":"2013","2":"2012-12-14","3":"1"},{"1":"2013","2":"2012-12-20","3":"1"},{"1":"2013","2":"2012-12-21","3":"1"},{"1":"2013","2":"2012-12-26","3":"1"},{"1":"2013","2":"2012-12-27","3":"1"},{"1":"2013","2":"2012-12-28","3":"1"},{"1":"2013","2":"2013-01-05","3":"1"},{"1":"2013","2":"2013-01-09","3":"1"},{"1":"2013","2":"2013-01-11","3":"1"},{"1":"2013","2":"2013-01-19","3":"1"},{"1":"2013","2":"2013-01-21","3":"1"},{"1":"2013","2":"2013-01-24","3":"1"},{"1":"2013","2":"2013-02-04","3":"1"},{"1":"2013","2":"2013-02-07","3":"1"},{"1":"2013","2":"2013-02-28","3":"1"},{"1":"2013","2":"2013-03-14","3":"1"},{"1":"2013","2":"2013-03-15","3":"1"},{"1":"2014","2":"2013-12-26","3":"1"},{"1":"2014","2":"2013-12-27","3":"1"},{"1":"2014","2":"2013-12-29","3":"1"},{"1":"2014","2":"2014-01-02","3":"1"},{"1":"2014","2":"2014-01-06","3":"1"},{"1":"2014","2":"2014-01-09","3":"1"},{"1":"2014","2":"2014-01-14","3":"1"},{"1":"2014","2":"2014-01-15","3":"1"},{"1":"2014","2":"2014-01-20","3":"1"},{"1":"2014","2":"2014-01-21","3":"1"},{"1":"2014","2":"2014-01-28","3":"1"},{"1":"2014","2":"2014-01-30","3":"1"},{"1":"2014","2":"2014-02-03","3":"1"},{"1":"2014","2":"2014-02-06","3":"1"},{"1":"2014","2":"2014-02-12","3":"1"},{"1":"2014","2":"2014-02-16","3":"1"},{"1":"2014","2":"2014-02-17","3":"1"},{"1":"2014","2":"2014-02-20","3":"1"},{"1":"2014","2":"2014-03-03","3":"1"},{"1":"2014","2":"2014-03-07","3":"1"},{"1":"2014","2":"2014-03-21","3":"1"},{"1":"2014","2":"2014-03-26","3":"1"},{"1":"2015","2":"2014-12-05","3":"1"},{"1":"2015","2":"2014-12-12","3":"1"},{"1":"2015","2":"2014-12-16","3":"1"},{"1":"2015","2":"2014-12-17","3":"1"},{"1":"2015","2":"2014-12-29","3":"1"},{"1":"2015","2":"2014-12-30","3":"1"},{"1":"2015","2":"2015-01-05","3":"1"},{"1":"2015","2":"2015-01-10","3":"1"},{"1":"2015","2":"2015-01-14","3":"1"},{"1":"2015","2":"2015-01-20","3":"1"},{"1":"2015","2":"2015-01-29","3":"1"},{"1":"2015","2":"2015-01-30","3":"1"},{"1":"2015","2":"2015-02-02","3":"1"},{"1":"2015","2":"2015-02-05","3":"1"},{"1":"2015","2":"2015-02-11","3":"1"},{"1":"2015","2":"2015-02-22","3":"1"},{"1":"2015","2":"2015-02-26","3":"1"},{"1":"2016","2":"2015-11-07","3":"1"},{"1":"2016","2":"2015-11-13","3":"1"},{"1":"2016","2":"2015-11-18","3":"1"},{"1":"2016","2":"2015-11-26","3":"1"},{"1":"2016","2":"2015-12-05","3":"1"},{"1":"2016","2":"2015-12-12","3":"1"},{"1":"2016","2":"2015-12-13","3":"1"},{"1":"2016","2":"2015-12-21","3":"1"},{"1":"2016","2":"2015-12-25","3":"1"},{"1":"2016","2":"2016-01-08","3":"1"},{"1":"2016","2":"2016-01-11","3":"1"},{"1":"2016","2":"2016-01-13","3":"1"},{"1":"2016","2":"2016-02-15","3":"1"},{"1":"2017","2":"2016-11-16","3":"1"},{"1":"2017","2":"2016-12-02","3":"1"},{"1":"2017","2":"2016-12-10","3":"1"},{"1":"2017","2":"2016-12-14","3":"1"},{"1":"2017","2":"2016-12-15","3":"1"},{"1":"2017","2":"2016-12-28","3":"1"},{"1":"2017","2":"2016-12-29","3":"1"},{"1":"2017","2":"2017-01-13","3":"1"},{"1":"2017","2":"2017-01-18","3":"1"},{"1":"2017","2":"2017-01-20","3":"1"},{"1":"2017","2":"2017-01-21","3":"1"},{"1":"2017","2":"2017-01-22","3":"1"},{"1":"2017","2":"2017-01-27","3":"1"},{"1":"2017","2":"2017-01-28","3":"1"},{"1":"2017","2":"2017-02-06","3":"1"},{"1":"2017","2":"2017-02-15","3":"1"},{"1":"2017","2":"2017-02-21","3":"1"},{"1":"2017","2":"2017-02-24","3":"1"},{"1":"2017","2":"2017-02-27","3":"1"},{"1":"2017","2":"2017-03-01","3":"1"},{"1":"2017","2":"2017-03-05","3":"1"},{"1":"2017","2":"2017-03-11","3":"1"},{"1":"2017","2":"2017-03-18","3":"1"},{"1":"2017","2":"2017-03-21","3":"1"},{"1":"2017","2":"2017-03-22","3":"1"},{"1":"2017","2":"2017-03-23","3":"1"},{"1":"2017","2":"2017-03-28","3":"1"},{"1":"2018","2":"2017-12-05","3":"1"},{"1":"2018","2":"2017-12-07","3":"1"},{"1":"2018","2":"2017-12-09","3":"1"},{"1":"2018","2":"2017-12-11","3":"1"},{"1":"2018","2":"2017-12-13","3":"1"},{"1":"2018","2":"2017-12-14","3":"1"},{"1":"2018","2":"2017-12-15","3":"1"},{"1":"2018","2":"2017-12-19","3":"1"},{"1":"2018","2":"2017-12-20","3":"1"},{"1":"2018","2":"2017-12-30","3":"1"},{"1":"2018","2":"2017-12-31","3":"1"},{"1":"2018","2":"2018-01-08","3":"1"},{"1":"2018","2":"2018-01-19","3":"1"},{"1":"2018","2":"2018-01-20","3":"1"},{"1":"2018","2":"2018-01-21","3":"1"},{"1":"2018","2":"2018-01-26","3":"1"},{"1":"2018","2":"2018-02-01","3":"1"},{"1":"2018","2":"2018-02-03","3":"1"},{"1":"2018","2":"2018-02-06","3":"1"},{"1":"2018","2":"2018-02-08","3":"1"},{"1":"2018","2":"2018-02-10","3":"1"},{"1":"2018","2":"2018-02-18","3":"1"},{"1":"2018","2":"2018-02-22","3":"1"},{"1":"2018","2":"2018-02-24","3":"1"},{"1":"2018","2":"2018-02-26","3":"1"},{"1":"2018","2":"2018-03-06","3":"1"},{"1":"2018","2":"2018-03-08","3":"1"},{"1":"2018","2":"2018-03-13","3":"1"},{"1":"2018","2":"2018-03-21","3":"1"},{"1":"2019","2":"2018-10-31","3":"1"},{"1":"2019","2":"2018-11-05","3":"1"},{"1":"2019","2":"2018-11-06","3":"1"},{"1":"2019","2":"2018-11-09","3":"1"},{"1":"2019","2":"2018-11-14","3":"1"},{"1":"2019","2":"2018-11-23","3":"1"},{"1":"2019","2":"2018-11-26","3":"1"},{"1":"2019","2":"2018-12-01","3":"1"},{"1":"2019","2":"2018-12-03","3":"1"},{"1":"2019","2":"2018-12-04","3":"1"},{"1":"2019","2":"2018-12-05","3":"1"},{"1":"2019","2":"2018-12-06","3":"1"},{"1":"2019","2":"2018-12-12","3":"1"},{"1":"2019","2":"2018-12-13","3":"1"},{"1":"2019","2":"2018-12-17","3":"1"},{"1":"2019","2":"2018-12-19","3":"1"},{"1":"2019","2":"2018-12-27","3":"1"},{"1":"2019","2":"2018-12-28","3":"1"},{"1":"2019","2":"2018-12-31","3":"1"},{"1":"2019","2":"2019-01-03","3":"1"},{"1":"2019","2":"2019-01-12","3":"1"},{"1":"2019","2":"2019-01-14","3":"1"},{"1":"2019","2":"2019-01-16","3":"1"},{"1":"2019","2":"2019-01-24","3":"1"},{"1":"2019","2":"2019-01-30","3":"1"},{"1":"2019","2":"2019-02-06","3":"1"},{"1":"2019","2":"2019-02-07","3":"1"},{"1":"2019","2":"2019-02-12","3":"1"},{"1":"2019","2":"2019-02-14","3":"1"},{"1":"2019","2":"2019-02-20","3":"1"},{"1":"2019","2":"2019-02-21","3":"1"},{"1":"2020","2":"2019-12-03","3":"1"},{"1":"2020","2":"2019-12-04","3":"1"},{"1":"2020","2":"2019-12-10","3":"1"},{"1":"2020","2":"2019-12-12","3":"1"},{"1":"2020","2":"2019-12-18","3":"1"},{"1":"2020","2":"2019-12-19","3":"1"},{"1":"2020","2":"2019-12-22","3":"1"},{"1":"2020","2":"2019-12-23","3":"1"},{"1":"2020","2":"2019-12-26","3":"1"},{"1":"2020","2":"2019-12-31","3":"1"},{"1":"2020","2":"2020-01-02","3":"1"},{"1":"2020","2":"2020-01-09","3":"1"},{"1":"2020","2":"2020-01-14","3":"1"},{"1":"2020","2":"2020-01-15","3":"1"},{"1":"2020","2":"2020-01-18","3":"1"},{"1":"2020","2":"2020-01-24","3":"1"},{"1":"2020","2":"2020-01-29","3":"1"},{"1":"2020","2":"2020-01-30","3":"1"},{"1":"2020","2":"2020-01-31","3":"1"},{"1":"2020","2":"2020-02-05","3":"1"},{"1":"2020","2":"2020-02-08","3":"1"},{"1":"2020","2":"2020-02-12","3":"1"},{"1":"2020","2":"2020-02-14","3":"1"},{"1":"2020","2":"2020-02-18","3":"1"},{"1":"2020","2":"2020-02-27","3":"1"},{"1":"2020","2":"2020-03-03","3":"1"},{"1":"2020","2":"2020-03-05","3":"1"},{"1":"2020","2":"2020-03-13","3":"1"},{"1":"2021","2":"2020-12-10","3":"1"},{"1":"2021","2":"2021-01-05","3":"1"},{"1":"2021","2":"2021-01-07","3":"1"},{"1":"2021","2":"2021-01-08","3":"1"},{"1":"2021","2":"2021-01-14","3":"1"},{"1":"2021","2":"2021-01-16","3":"1"},{"1":"2021","2":"2021-01-18","3":"1"},{"1":"2021","2":"2021-01-22","3":"1"},{"1":"2021","2":"2021-01-23","3":"1"},{"1":"2021","2":"2021-01-29","3":"1"},{"1":"2021","2":"2021-01-30","3":"1"},{"1":"2021","2":"2021-02-13","3":"1"},{"1":"2021","2":"2021-02-14","3":"1"},{"1":"2021","2":"2021-02-15","3":"1"},{"1":"2021","2":"2021-02-21","3":"1"},{"1":"2021","2":"2021-02-24","3":"1"},{"1":"2021","2":"2021-02-27","3":"1"},{"1":"2021","2":"2021-03-03","3":"1"},{"1":"2021","2":"2021-03-04","3":"1"},{"1":"2021","2":"2021-03-08","3":"1"},{"1":"2021","2":"2021-03-10","3":"1"},{"1":"2021","2":"2021-03-15","3":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="max-number-of-reports-per-week" class="section level4">
<h4>Max Number of reports per week</h4>
<pre class="r"><code>sbr_rep %&gt;%
  dplyr::group_by(season, week, state) %&gt;% 
  dplyr::summarise(count = n()) %&gt;%
  ungroup() %&gt;% 
  dplyr::filter(count == max(count))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39;, &#39;week&#39; (override with `.groups` argument)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["week"],"name":[2],"type":["int"],"align":["right"]},{"label":["state"],"name":[3],"type":["chr"],"align":["left"]},{"label":["count"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"2015","2":"25","3":"SC","4":"38"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="mean-number-of-reports-per-day" class="section level4">
<h4>Mean Number of reports per day</h4>
<pre class="r"><code>sbr_rep %&gt;%
  group_by(season, date_report) %&gt;% 
  summarise(count = n()) %&gt;%
  ungroup() %&gt;% 
  # group_by(region) %&gt;% 
  summarise(mean = mean(count))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mean"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"2.616292"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="mean-number-of-reports-per-day-per-state" class="section level4">
<h4>Mean number of reports per day per state</h4>
<pre class="r"><code>sbr_rep %&gt;%
  group_by(season, date_report, state) %&gt;% 
  summarise(count = n()) %&gt;%
  group_by(state) %&gt;% 
  summarise(mean = mean(count))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39;, &#39;date_report&#39; (override with `.groups` argument)</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["state"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mean"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"PR","2":"2.089376"},{"1":"RS","2":"1.874275"},{"1":"SC","2":"1.606897"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="maximum-number-of-reports-in-a-same-day" class="section level4">
<h4>Maximum number of reports in a same day</h4>
<pre class="r"><code>sbr_rep %&gt;%
  group_by(season, date_report, region) %&gt;% 
  summarise(count = n()) %&gt;%
  ungroup() %&gt;% 
  filter(count == max(count))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39;, &#39;date_report&#39; (override with `.groups` argument)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["date_report"],"name":[2],"type":["date"],"align":["right"]},{"label":["region"],"name":[3],"type":["chr"],"align":["left"]},{"label":["count"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"2015","2":"2015-02-25","3":"South","4":"21"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="planting-week-after-sep-15th-median" class="section level4">
<h4>Planting week after Sep 15th (Median)</h4>
<pre class="r"><code>pd = sbr_rep %&gt;% 
  mutate(plant_week = week(start_date)-37) %&gt;% 
  group_by(state) %&gt;% 
  summarise(pd = median(plant_week))</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre class="r"><code>  # ggplot(aes(plant_week))+
  # geom_histogram()+
  # facet_wrap(~state)
pd </code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["state"],"name":[1],"type":["chr"],"align":["left"]},{"label":["pd"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"PR","2":"4"},{"1":"RS","2":"8"},{"1":"SC","2":"8"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="planting-date-by-year" class="section level4">
<h4>Planting date by year</h4>
<pre class="r"><code>sbr_rep %&gt;%
  mutate(planting_daymonth = format(as.Date(start_date), &quot;%d-%m&quot;)) %&gt;% 
  mutate(planting_month = month(start_date)) %&gt;%
  filter(planting_month != 8) %&gt;% 
  group_by(season) %&gt;% 
  mutate(total = n()) %&gt;% 
  group_by(season, planting_month) %&gt;% 
  summarise(count = (n()/total)*100) %&gt;% 
  # mutate(planting_daymonth = factor(planting_daymonth, levels = c(&quot;07-08&quot;, &quot;07-09&quot;, &quot;21-09&quot;,&quot;01-10&quot;, &quot;07-10&quot;, &quot;21-10&quot;,&quot;07-11&quot;,&quot;21-11&quot;,&quot;07-12&quot;,&quot;21-12&quot;) )) %&gt;% 
  ggplot(aes(planting_month,season, fill = count))+
  geom_tile(color = &quot;white&quot;,size =1)+
  scale_fill_viridis_c()+
  labs(x = &quot;Mês de plantio&quot;,
       y = &quot;Safra&quot;,
       fill = &quot;Porcentagem\ndos plantios&quot;)+
  theme_minimal_hgrid()+
  coord_flip()</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39;, &#39;planting_month&#39; (override with `.groups` argument)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre class="r"><code># ggsave(&quot;figs/planting_dates.png&quot;, dpi = 600, height = 3, width =10)</code></pre>
</div>
<div id="convert-coordinates-to-utm" class="section level2">
<h2>Convert coordinates to UTM</h2>
<pre class="r"><code>source(&quot;coord_transform.R&quot;)
lat = sbr_rep$lat
lon = sbr_rep$lon

# new_coord = longlat_to_UTM(long = sbr_rep$lon, lat =sbr_rep$lat   , units = &#39;m&#39;)
#  sbr_rep$lat_utm =  new_coord$y
#  sbr_rep$lon_utm = new_coord$x
xy &lt;- data.frame(ID = 1:(length(lat)), lon, lat)
coordinates(xy) &lt;- c(&quot;lon&quot;, &quot;lat&quot;)
proj4string(xy) &lt;- CRS(&quot;+proj=longlat +datum=WGS84&quot;)
res &lt;- spTransform(xy, CRS(&quot;+proj=utm +zone=22 ellps=WGS84&quot;))</code></pre>
<pre><code>## Warning in showSRID(uprojargs, format = &quot;PROJ&quot;, multiline = &quot;NO&quot;): Discarded
## datum Unknown based on WGS84 ellipsoid in CRS definition</code></pre>
<pre class="r"><code>coords_utm = as.data.frame(res)
sbr_rep$lat_utm =  1e+07 + coords_utm$lat
sbr_rep$lon_utm = coords_utm$lon</code></pre>
</div>
</div>
<div id="temporal-aspects" class="section level1">
<h1>Temporal aspects</h1>
<p>Number of cases by month</p>
<pre class="r"><code>sbr_rep %&gt;%
  group_by(season, month) %&gt;% 
  summarise(count = n()
            ) %&gt;% 
  ggplot(aes(month,count)
         )+
  geom_bar(stat = &quot;identity&quot;,
           position = &quot;dodge&quot;,
           color = &quot;white&quot;,
           size = .5)+
  scale_fill_manual(values = c(&quot;black&quot;, &quot;gray40&quot;))+
  facet_wrap(~season)+
  labs(x = &quot;Month&quot;,
       y = &quot;Reports count&quot;,
       fill = &quot;Season&quot;
       )+
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = &quot;none&quot;
        )</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<pre class="r"><code> # ggsave(&quot;figs/fig1.png&quot;, dpi = 600, height = 8, width = 6)  </code></pre>
<div id="phenological-state" class="section level2">
<h2>Phenological state</h2>
<pre class="r"><code>sbr_rep %&gt;%
  mutate(Phen_state = as.character(Phen_state)) %&gt;% 
  mutate(Phen_state2 = case_when(Phen_state %in% c(&quot;VC&quot;,&quot;V1&quot;, &quot;V2&quot;, &quot;V3&quot;, &quot;Vn&quot;) ~ &quot;Vegetative&quot;,
                                Phen_state %in% c(&quot;R6&quot;,&quot;R7&quot;, &quot;R8&quot;, &quot;R9&quot;) ~ &quot;Late reproductive&quot;,
                                !Phen_state %in% c(&quot;VC&quot;,&quot;V1&quot;, &quot;V2&quot;, &quot;V3&quot;, &quot;Vn&quot;,&quot;R6&quot;,&quot;R7&quot;, &quot;R8&quot;, &quot;R9&quot;, &quot;Vn&quot;) ~ Phen_state),
         Phen_state2 = factor(Phen_state2,
                              levels = c(&quot;Vegetative&quot;,&quot;R1&quot;,&quot;R2&quot;,&quot;R3&quot;,&quot;R4&quot;,&quot;R5&quot;,&quot;Late reproductive&quot;))) %&gt;% 
  group_by(Phen_state2, season) %&gt;% 
  summarise(n())</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;Phen_state2&#39; (override with `.groups` argument)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Phen_state2"],"name":[1],"type":["fct"],"align":["left"]},{"label":["season"],"name":[2],"type":["chr"],"align":["left"]},{"label":["n()"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"Vegetative","2":"2005","3":"4"},{"1":"Vegetative","2":"2006","3":"8"},{"1":"Vegetative","2":"2007","3":"15"},{"1":"Vegetative","2":"2008","3":"12"},{"1":"Vegetative","2":"2009","3":"13"},{"1":"Vegetative","2":"2010","3":"32"},{"1":"Vegetative","2":"2011","3":"3"},{"1":"Vegetative","2":"2013","3":"3"},{"1":"Vegetative","2":"2014","3":"3"},{"1":"Vegetative","2":"2015","3":"7"},{"1":"Vegetative","2":"2016","3":"22"},{"1":"Vegetative","2":"2017","3":"11"},{"1":"Vegetative","2":"2018","3":"3"},{"1":"Vegetative","2":"2019","3":"10"},{"1":"Vegetative","2":"2020","3":"1"},{"1":"Vegetative","2":"2021","3":"1"},{"1":"R1","2":"2005","3":"14"},{"1":"R1","2":"2006","3":"30"},{"1":"R1","2":"2007","3":"24"},{"1":"R1","2":"2008","3":"19"},{"1":"R1","2":"2009","3":"29"},{"1":"R1","2":"2010","3":"34"},{"1":"R1","2":"2011","3":"24"},{"1":"R1","2":"2012","3":"2"},{"1":"R1","2":"2013","3":"17"},{"1":"R1","2":"2014","3":"9"},{"1":"R1","2":"2015","3":"14"},{"1":"R1","2":"2016","3":"25"},{"1":"R1","2":"2017","3":"12"},{"1":"R1","2":"2018","3":"9"},{"1":"R1","2":"2019","3":"20"},{"1":"R1","2":"2021","3":"1"},{"1":"R2","2":"2005","3":"26"},{"1":"R2","2":"2006","3":"33"},{"1":"R2","2":"2007","3":"24"},{"1":"R2","2":"2008","3":"21"},{"1":"R2","2":"2009","3":"26"},{"1":"R2","2":"2010","3":"18"},{"1":"R2","2":"2011","3":"22"},{"1":"R2","2":"2012","3":"3"},{"1":"R2","2":"2013","3":"13"},{"1":"R2","2":"2014","3":"4"},{"1":"R2","2":"2015","3":"11"},{"1":"R2","2":"2016","3":"9"},{"1":"R2","2":"2017","3":"11"},{"1":"R2","2":"2018","3":"8"},{"1":"R2","2":"2019","3":"15"},{"1":"R2","2":"2020","3":"4"},{"1":"R2","2":"2021","3":"6"},{"1":"R3","2":"2005","3":"41"},{"1":"R3","2":"2006","3":"38"},{"1":"R3","2":"2007","3":"41"},{"1":"R3","2":"2008","3":"41"},{"1":"R3","2":"2009","3":"31"},{"1":"R3","2":"2010","3":"25"},{"1":"R3","2":"2011","3":"29"},{"1":"R3","2":"2012","3":"3"},{"1":"R3","2":"2013","3":"13"},{"1":"R3","2":"2014","3":"5"},{"1":"R3","2":"2015","3":"17"},{"1":"R3","2":"2016","3":"21"},{"1":"R3","2":"2017","3":"9"},{"1":"R3","2":"2018","3":"11"},{"1":"R3","2":"2019","3":"17"},{"1":"R3","2":"2020","3":"8"},{"1":"R3","2":"2021","3":"14"},{"1":"R4","2":"2005","3":"23"},{"1":"R4","2":"2006","3":"33"},{"1":"R4","2":"2007","3":"28"},{"1":"R4","2":"2008","3":"25"},{"1":"R4","2":"2009","3":"25"},{"1":"R4","2":"2010","3":"12"},{"1":"R4","2":"2011","3":"15"},{"1":"R4","2":"2012","3":"6"},{"1":"R4","2":"2013","3":"9"},{"1":"R4","2":"2014","3":"3"},{"1":"R4","2":"2015","3":"43"},{"1":"R4","2":"2016","3":"10"},{"1":"R4","2":"2017","3":"12"},{"1":"R4","2":"2018","3":"17"},{"1":"R4","2":"2019","3":"10"},{"1":"R4","2":"2020","3":"6"},{"1":"R4","2":"2021","3":"13"},{"1":"R5","2":"2005","3":"86"},{"1":"R5","2":"2006","3":"67"},{"1":"R5","2":"2007","3":"58"},{"1":"R5","2":"2008","3":"62"},{"1":"R5","2":"2009","3":"73"},{"1":"R5","2":"2010","3":"60"},{"1":"R5","2":"2011","3":"58"},{"1":"R5","2":"2012","3":"11"},{"1":"R5","2":"2013","3":"42"},{"1":"R5","2":"2014","3":"35"},{"1":"R5","2":"2015","3":"82"},{"1":"R5","2":"2016","3":"33"},{"1":"R5","2":"2017","3":"54"},{"1":"R5","2":"2018","3":"104"},{"1":"R5","2":"2019","3":"43"},{"1":"R5","2":"2020","3":"38"},{"1":"R5","2":"2021","3":"70"},{"1":"Late reproductive","2":"2005","3":"1"},{"1":"Late reproductive","2":"2006","3":"6"},{"1":"Late reproductive","2":"2007","3":"5"},{"1":"Late reproductive","2":"2008","3":"8"},{"1":"Late reproductive","2":"2009","3":"12"},{"1":"Late reproductive","2":"2010","3":"4"},{"1":"Late reproductive","2":"2011","3":"17"},{"1":"Late reproductive","2":"2012","3":"2"},{"1":"Late reproductive","2":"2013","3":"8"},{"1":"Late reproductive","2":"2014","3":"1"},{"1":"Late reproductive","2":"2015","3":"4"},{"1":"Late reproductive","2":"2016","3":"1"},{"1":"Late reproductive","2":"2017","3":"15"},{"1":"Late reproductive","2":"2018","3":"9"},{"1":"Late reproductive","2":"2019","3":"4"},{"1":"Late reproductive","2":"2020","3":"13"},{"1":"Late reproductive","2":"2021","3":"16"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>library(ggmosaic)</code></pre>
<pre><code>## Warning: package &#39;ggmosaic&#39; was built under R version 4.0.5</code></pre>
<pre><code>## 
## Attaching package: &#39;ggmosaic&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:GGally&#39;:
## 
##     happy</code></pre>
<pre><code>## The following object is masked from &#39;package:raster&#39;:
## 
##     mosaic</code></pre>
<pre class="r"><code>sbr_rep %&gt;%
  mutate(Phen_state = as.character(Phen_state)) %&gt;% 
  mutate(Phen_state2 = case_when(Phen_state %in% c(&quot;VC&quot;,&quot;V1&quot;, &quot;V2&quot;, &quot;V3&quot;, &quot;Vn&quot;) ~ &quot;Vegetative&quot;,
                                Phen_state %in% c(&quot;R6&quot;,&quot;R7&quot;, &quot;R8&quot;, &quot;R9&quot;) ~ &quot;Late reproductive&quot;,
                                !Phen_state %in% c(&quot;VC&quot;,&quot;V1&quot;, &quot;V2&quot;, &quot;V3&quot;, &quot;Vn&quot;,&quot;R6&quot;,&quot;R7&quot;, &quot;R8&quot;, &quot;R9&quot;, &quot;Vn&quot;) ~ Phen_state),
         Phen_state2 = factor(Phen_state2,
                              levels = c(&quot;Vegetative&quot;,&quot;R1&quot;,&quot;R2&quot;,&quot;R3&quot;,&quot;R4&quot;,&quot;R5&quot;,&quot;Late reproductive&quot;))
                              # levels = c(&quot;Late reproductive&quot;,&quot;R5&quot;,&quot;R4&quot;,&quot;R3&quot;,&quot;R2&quot;,&quot;R1&quot;,&quot;Vegetative&quot;))
         
         ) %&gt;% 

  ggplot()+
  geom_mosaic(aes(x = product(Phen_state2, season), fill=Phen_state2),
              alpha =1, size =1.2)+
  scale_fill_brewer(direction = -1, palette = &quot;Spectral&quot;,
                    breaks = c(&quot;Late reproductive&quot;,&quot;R5&quot;,&quot;R4&quot;,&quot;R3&quot;,&quot;R2&quot;,&quot;R1&quot;,&quot;Vegetative&quot;))+
  labs(y =&quot;Phenological stages&quot;,
       x =  &quot;Crop season&quot;,
       fill =&quot;&quot;,
       color =&quot;&quot;)+
  # scale_y_discrete()+
  theme_half_open()+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<pre class="r"><code> ggsave(&quot;figs/phen_cout.png&quot;, dpi = 600, height = 6, width = 10)</code></pre>
<p>Number of cases by day</p>
<pre class="r"><code>sbr_rep %&gt;%
  group_by(season, week,region) %&gt;% 
  summarise(count = n()
            ) %&gt;% 
  ggplot(aes(week, count,
             group = season,  color =  season )
         )+
  geom_line(size =0.5)+
  geom_point()+
  facet_wrap(~region)+
  scale_fill_colorblind()+
  scale_color_viridis(discrete = T)+
  scale_x_continuous(breaks = seq(0,240, 30))+
  # facet_wrap(~season, ncol = 1)+
  labs(x = &quot;Days after Sep 15th&quot;,
       y = &quot;Daily reports count&quot;)+
  theme(legend.position = &quot;none&quot;, text = element_text(size = 14)
        )</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39;, &#39;week&#39; (override with `.groups` argument)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<pre class="r"><code>temp_lines_df = sbr_rep %&gt;% 
  group_by(season, days_sep15) %&gt;% 
  dplyr::summarise(count = n()) %&gt;%
  group_by(season) %&gt;% 
  dplyr::mutate(comulatice_prevalence = cumsum(count),
                total = max(cumsum(count)),
                days_sep15 = as.numeric(days_sep15)) %&gt;% 
  full_join(ensodata2)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<pre><code>## Joining, by = &quot;season&quot;</code></pre>
<pre class="r"><code>ggplot(data  = temp_lines_df,
       aes(days_sep15, comulatice_prevalence, group = season, color = enso))+
  # geom_vline(xintercept = c(100,130), linetype = 2, color = &quot;gray40&quot;)+
  geom_line(size = 0.3)+
  geom_text_repel(data  = temp_lines_df %&gt;% 
              filter(days_sep15 == last(days_sep15)),
            aes(x = days_sep15, y = comulatice_prevalence,
                label = season, group = season ),
            segment.size  = 0.2,
            force        = 1,
            hjust        = &quot;right&quot;,
            direction     = &quot;y&quot;,
            size = 2.5,
            point.padding = 0.2,
            seed = 1,
            fontface = &quot;bold&quot;,
            show.legend = F,
            # color = &quot;darkred&quot;
            )+
  # geom_dl(aes(label = season), method = list(dl.combine( &quot;last.points&quot;)), cex = 2)+
  scale_x_continuous(breaks = seq(10,240, 30), limits =c(0,240))+
  labs(x = &quot;Days after Sep 15th&quot;,
       y = &quot;Prevalence&quot;,
       color = &quot;&quot;,
       alpha=&quot;&quot;)+
  theme(legend.position = &quot;right&quot;, text = element_text(size = 14)
        )+
  # facet_wrap(~enso, ncol =1)+
  scale_color_colorblind()+
  theme_half_open()</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<pre class="r"><code>ggsave(&quot;figs/daily_prevalece.png&quot;, dpi = 600, height = 5, width = 8)</code></pre>
<div id="time-to-firsr-report" class="section level3">
<h3>Time to firsr report</h3>
<pre class="r"><code>min_sep15 = sbr_rep %&gt;% 
  group_by(season) %&gt;% 
  summarise(`Time to 1st report` = as.numeric(min(days_sep15))) %&gt;% 
  arrange(`Time to 1st report`)</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre class="r"><code>min_sep15</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Time to 1st report"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"2010","2":"14"},{"1":"2019","2":"46"},{"1":"2013","2":"48"},{"1":"2016","2":"53"},{"1":"2006","2":"55"},{"1":"2007","2":"60"},{"1":"2017","2":"62"},{"1":"2005","2":"64"},{"1":"2018","2":"69"},{"1":"2011","2":"70"},{"1":"2020","2":"79"},{"1":"2012","2":"80"},{"1":"2015","2":"80"},{"1":"2008","2":"82"},{"1":"2021","2":"86"},{"1":"2009","2":"88"},{"1":"2014","2":"102"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>median(min_sep15$`Time to 1st report`)</code></pre>
<pre><code>## [1] 69</code></pre>
<pre class="r"><code>max_prevalance = sbr_rep %&gt;% 
  group_by(season, days_sep15, region) %&gt;% 
  summarise(count = n()) %&gt;%
  group_by(season, region) %&gt;% 
  mutate(max_prev = cumsum(count)) %&gt;% 
  filter(max_prev == max(max_prev)) %&gt;% 
  dplyr::select(-days_sep15, -count)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39;, &#39;days_sep15&#39; (override with `.groups` argument)</code></pre>
<pre class="r"><code>max_prev = max_prevalance %&gt;% 
  ggplot(aes(as.numeric(season), max_prev, color = region))+
  geom_smooth(method = &quot;gam&quot;, alpha =  0.1, size =2, formula = y~s(x))+
  geom_point(size =3)+
  labs(y = &quot;Max_prevalence&quot;, x = &quot;season&quot;)+
  scale_color_colorblind()
max_prev</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
</div>
<div id="daily" class="section level2">
<h2>Daily</h2>
<p>Number or municipality by states</p>
<pre class="r"><code>n_mun = sbr_rep %&gt;% 
  group_by(state) %&gt;%
  summarise(n_mun = length(unique(location)))# %&gt;%</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre class="r"><code>   # group_by(state) %&gt;% 
  # summarise(n_mun = max(n_mun))</code></pre>
<pre class="r"><code>sbr_rep %&gt;% 
  group_by(season, days_sep15) %&gt;% 
  dplyr::summarise(count = n()) %&gt;%
  group_by(season) %&gt;% 
  dplyr::mutate(comulatice_prevalence = cumsum(count),
                days_sep15 = days_sep15 - min(days_sep15)
                ) %&gt;% 
  ggplot(aes(days_sep15, comulatice_prevalence))+
  geom_vline(xintercept = c(90,120), linetype = 2, color = &quot;gray40&quot;)+
  geom_line(size = 1)+
  scale_color_viridis(discrete = T)+
  scale_x_continuous(breaks = seq(0,240, 30))+
  facet_wrap(~season)+
  labs(x = &quot;Days after Sep 15th&quot;,
       y = &quot;Cumulative reports count&quot;,
       color = &quot;&quot;)+
  theme(legend.position = &quot;right&quot;, text = element_text(size = 14)
        )</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
<div id="infection-rate" class="section level2">
<h2>Infection rate</h2>
<pre class="r"><code>data_for_inf_br = sbr_rep %&gt;% 
  group_by(season, days_sep15) %&gt;% 
  summarise(count = n()) %&gt;%
  # left_join(n_mun) %&gt;% 
  group_by(season) %&gt;%
  mutate(cum_prevalence = cumsum(count)/634, #(max(cumsum(count))),
         days_sep15 = days_sep15 - min(days_sep15)
         ) %&gt;%
  mutate(week = as.numeric(days_sep15))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<pre class="r"><code>fitted_curves_br =  fit_multi(time_col = &quot;week&quot;,
             intensity_col = &quot;cum_prevalence&quot;,
             data = data_for_inf_br,
             strata_cols = c(&quot;season&quot;),
             starting_par = list(y0 = 0.001, r = 0.05, K = 0.4),
              nlin = T,
             estimate_K = T)</code></pre>
<pre><code>## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;DescTools&#39;:
##   method         from 
##   reorder.factor gdata</code></pre>
<pre><code>## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos

## Warning in log(y0/K): NaNs produzidos</code></pre>
<pre class="r"><code>fitted_curves_br$Data %&gt;%
  left_join(fitted_curves_br$Parameters) %&gt;% 
  # group_by(season) %&gt;% 
  # filter(best_model==1) %&gt;%
  # filter(RSE==min(RSE)) %&gt;%
  filter(model == &quot;Logistic&quot;) %&gt;%
  ggplot(aes(time,predicted))+
  geom_point(aes(time,y), color =&quot;gray70&quot;)+
  geom_line(size = 1)+
  scale_color_colorblind()+
  facet_wrap(~season)+
  labs(x = &quot;Days after first report&quot;, y = &quot;Prevalence&quot;, color =&quot;Model&quot;, linetype = &quot;State&quot;)+
  ylim(0,1)+
  theme(
    legend.position = &quot;right&quot;, text = element_text(size = 12),
    strip.text = element_text(color = &quot;black&quot;),
    strip.background = element_rect(fill = &quot;white&quot;)
  )</code></pre>
<pre><code>## Joining, by = c(&quot;season&quot;, &quot;model&quot;)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<pre class="r"><code># ggsave(&quot;figs/fitted_models.png&quot;, height = 6, width = 8)</code></pre>
<pre class="r"><code>r = fitted_curves_br$Parameters %&gt;% 
  filter(model == &quot;Logistic&quot;) %&gt;% 
  dplyr::select(season, y0,r, K) %&gt;% 
  full_join(
    sbr_rep %&gt;% 
  group_by(season) %&gt;%
  summarise(n_reports = length(unique(location)))
  ) %&gt;%
  full_join(epi_time_br) %&gt;% 
  mutate(Rate = (r*K)) %&gt;% 
  # mutate(Rate = (r/n_reports)*100) %&gt;% 
  dplyr::select(season, Rate) %&gt;% 
  arrange(Rate)</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;</code></pre>
<pre class="r"><code>r</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Rate"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"2012","2":"0.001708074"},{"1":"2020","2":"0.006582059"},{"1":"2014","2":"0.007544833"},{"1":"2019","2":"0.008628750"},{"1":"2017","2":"0.012901717"},{"1":"2013","2":"0.014752344"},{"1":"2018","2":"0.016270448"},{"1":"2016","2":"0.016833275"},{"1":"2006","2":"0.019576819"},{"1":"2021","2":"0.020726815"},{"1":"2008","2":"0.022117973"},{"1":"2007","2":"0.022457225"},{"1":"2010","2":"0.026610893"},{"1":"2009","2":"0.028089533"},{"1":"2005","2":"0.029136094"},{"1":"2011","2":"0.030174254"},{"1":"2015","2":"0.030940533"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>fitted_curves_br$Parameters %&gt;% 
  filter(model == &quot;Logistic&quot;) %&gt;% 
  dplyr::select(season, r, K) %&gt;% 
  full_join(
    sbr_rep %&gt;% 
  group_by(season) %&gt;%
  summarise(n_reports = length(unique(location)))
  ) %&gt;%
  full_join(epi_time_br) %&gt;%
  mutate(Rate = (r*K)) %&gt;%
  full_join(min_sep15) %&gt;% 
  dplyr::select( season,`Time to 1st report`, n_reports, epidemic_time, Rate) %&gt;% 
  arrange(Rate)</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Time to 1st report"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["n_reports"],"name":[3],"type":["int"],"align":["right"]},{"label":["epidemic_time"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Rate"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"2012","2":"80","3":"27","4":"107","5":"0.001708074"},{"1":"2020","2":"79","3":"70","4":"101","5":"0.006582059"},{"1":"2014","2":"102","3":"60","4":"90","5":"0.007544833"},{"1":"2019","2":"46","3":"119","4":"113","5":"0.008628750"},{"1":"2017","2":"62","3":"124","4":"132","5":"0.012901717"},{"1":"2013","2":"48","3":"105","4":"133","5":"0.014752344"},{"1":"2018","2":"69","3":"161","4":"118","5":"0.016270448"},{"1":"2016","2":"53","3":"121","4":"100","5":"0.016833275"},{"1":"2006","2":"55","3":"215","4":"166","5":"0.019576819"},{"1":"2021","2":"86","3":"121","4":"95","5":"0.020726815"},{"1":"2008","2":"82","3":"187","4":"125","5":"0.022117973"},{"1":"2007","2":"60","3":"194","4":"126","5":"0.022457225"},{"1":"2010","2":"14","3":"184","4":"169","5":"0.026610893"},{"1":"2009","2":"88","3":"209","4":"125","5":"0.028089533"},{"1":"2005","2":"64","3":"195","4":"123","5":"0.029136094"},{"1":"2011","2":"70","3":"167","4":"99","5":"0.030174254"},{"1":"2015","2":"80","3":"178","4":"89","5":"0.030940533"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>sbr_rep %&gt;% 
  group_by(season) %&gt;%
  summarise(n_reports = length(unique(location))) %&gt;% 
  ungroup() %&gt;% 
  summarise(median(n_reports))</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["median(n_reports)"],"name":[1],"type":["int"],"align":["right"]}],"data":[{"1":"161"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>fitted_curves_br$Parameters %&gt;% 
  filter(model == &quot;Logistic&quot;) %&gt;% 
  dplyr::select(season, r, K) %&gt;% 
  full_join(
    sbr_rep %&gt;% 
  group_by(season) %&gt;%
  summarise(n_reports = length(unique(location)))
  ) %&gt;%
  full_join(epi_time_br) %&gt;%
  mutate(Rate = (r*K)) %&gt;%
  full_join(min_sep15) %&gt;% 
  dplyr::select( season,`Time to 1st report`, n_reports, epidemic_time, Rate) %&gt;% 
  full_join(ensodata2) %&gt;% 
  group_by(enso) %&gt;% 
  summarise(median(`Time to 1st report`),
            median(n_reports),
            median(epidemic_time),
            mean(Rate))</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["enso"],"name":[1],"type":["fct"],"align":["left"]},{"label":["median(`Time to 1st report`)"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["median(n_reports)"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["median(epidemic_time)"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["mean(Rate)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Neutral","2":"69.0","3":"161.0","4":"123.0","5":"0.01842160"},{"1":"El Niño","2":"49.5","3":"152.5","4":"119.5","5":"0.01863254"},{"1":"La Niña","2":"81.0","3":"144.0","4":"103.0","5":"0.01868178"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="audpc" class="section level2">
<h2>AUDPC</h2>
<pre class="r"><code>audpc = sbr_rep %&gt;% 
  group_by(season, days_sep15) %&gt;% 
  summarise(count = n()) %&gt;%
  group_by(season) %&gt;%
  mutate(cum_prevalence = cumsum(count)/634) %&gt;%
  group_by(season) %&gt;% 
  mutate(days_sep15 = as.numeric(days_sep15)) %&gt;% 
  summarise(audpc = AUDPC(cum_prevalence, days_sep15)/(max(days_sep15)-min(days_sep15)))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre class="r"><code>audpc%&gt;% 
  ggplot(aes(as.numeric(season), audpc))+
  # geom_line(size = 1)+
  # geom_point(size = 3)+
  geom_col(width = 0.5)+
  # geom_smooth(alpha =  0.1, size =1.5)+
  scale_color_colorblind()+
  scale_fill_colorblind()+
  scale_x_continuous(breaks = c(seq(2005, 2021, by = 1)))+
  labs(x = &quot;Harvest season&quot;, y = &quot;AUDPC&quot;)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
</div>
<div id="time-to-prevalence" class="section level2">
<h2>time to prevalence</h2>
<pre class="r"><code>time_2.5 = sbr_rep %&gt;% 
  group_by(season, days_sep15) %&gt;% 
  summarise(count = n()) %&gt;%
  # left_join(n_mun) %&gt;% 
  group_by(season) %&gt;%
  mutate(cum_prevalence = cumsum(count)/max(cumsum(count))) %&gt;%
  group_by(season) %&gt;% 
  filter(cum_prevalence &lt;=  0.025) %&gt;%
  summarise(time_2.5 = as.numeric(max(days_sep15)))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre class="r"><code>time_5 = sbr_rep %&gt;% 
  group_by(season, days_sep15, state) %&gt;% 
  summarise(count = n()) %&gt;%
  # left_join(n_mun) %&gt;% 
  group_by(season) %&gt;%
  mutate(cum_prevalence = cumsum(count)/max(cumsum(count))) %&gt;%
  group_by(season) %&gt;% 
  filter(cum_prevalence &lt;=  0.05) %&gt;%
  summarise(time_5 = as.numeric(max(days_sep15)))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39;, &#39;days_sep15&#39; (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre class="r"><code>time_10 = sbr_rep %&gt;% 
  group_by(season, days_sep15) %&gt;% 
  summarise(count = n()) %&gt;%
  # left_join(n_mun) %&gt;% 
  group_by(season) %&gt;%
  mutate(cum_prevalence = cumsum(count)/max(cumsum(count))) %&gt;%
  group_by(season) %&gt;% 
  filter(cum_prevalence &lt;=  0.1) %&gt;%
  summarise(time_10 = as.numeric(max(days_sep15)))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre class="r"><code>all_times = time_2.5 %&gt;%
  full_join(time_5) %&gt;% 
  left_join(time_10)</code></pre>
<pre><code>## Joining, by = &quot;season&quot;</code></pre>
<pre><code>## Joining, by = &quot;season&quot;</code></pre>
<pre class="r"><code>all_times</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["time_2.5"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["time_5"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["time_10"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"2005","2":"90","3":"99","4":"108"},{"1":"2006","2":"62","3":"71","4":"82"},{"1":"2007","2":"82","3":"84","4":"97"},{"1":"2008","2":"93","3":"97","4":"114"},{"1":"2009","2":"119","3":"123","4":"128"},{"1":"2010","2":"70","3":"84","4":"94"},{"1":"2011","2":"76","3":"86","4":"97"},{"1":"2013","2":"80","3":"86","4":"103"},{"1":"2014","2":"102","3":"105","4":"113"},{"1":"2015","2":"88","3":"98","4":"112"},{"1":"2016","2":"64","3":"66","4":"76"},{"1":"2017","2":"86","3":"91","4":"97"},{"1":"2018","2":"77","3":"82","4":"94"},{"1":"2019","2":"51","3":"52","4":"55"},{"1":"2020","2":"79","3":"86","4":"88"},{"1":"2021","2":"91","3":"112","4":"120"},{"1":"2012","2":"NA","3":"80","4":"82"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="prevalence-to-time" class="section level2">
<h2>Prevalence to time</h2>
<pre class="r"><code>prev_90 =sbr_rep %&gt;%
  group_by(season, days_sep15) %&gt;% 
  summarise(count = n()) %&gt;%
  # left_join(n_mun) %&gt;% 
  group_by(season) %&gt;%
  mutate(cum_prevalence = cumsum(count)) %&gt;%
  group_by(season) %&gt;% 
  filter(days_sep15 &lt;=  as.numeric(100)) %&gt;%
  summarise(prev_100 = as.numeric(max(cum_prevalence))) </code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre class="r"><code>prev_120 =sbr_rep %&gt;%
  group_by(season, days_sep15) %&gt;% 
  summarise(count = n()) %&gt;%
  # left_join(n_mun) %&gt;% 
  group_by(season) %&gt;%
  mutate(cum_prevalence = cumsum(count)) %&gt;%
  group_by(season) %&gt;% 
  filter(days_sep15 &lt;=  as.numeric(130)) %&gt;%
  summarise(prev_130 = as.numeric(max(cum_prevalence)))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)
## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre class="r"><code>prev_all = prev_90 %&gt;% 
  full_join(prev_120) %&gt;% 
  mutate_if(is.numeric, ~replace(., is.na(.), 0))</code></pre>
<pre><code>## Joining, by = &quot;season&quot;</code></pre>
<pre class="r"><code>prev_all</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["prev_100"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["prev_130"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"2005","2":"10","3":"103"},{"1":"2006","2":"31","3":"69"},{"1":"2007","2":"21","3":"116"},{"1":"2008","2":"9","3":"72"},{"1":"2009","2":"1","3":"23"},{"1":"2010","2":"22","3":"98"},{"1":"2011","2":"17","3":"81"},{"1":"2012","2":"9","3":"12"},{"1":"2013","2":"8","3":"60"},{"1":"2015","2":"11","3":"74"},{"1":"2016","2":"67","3":"120"},{"1":"2017","2":"11","3":"68"},{"1":"2018","2":"22","3":"91"},{"1":"2019","2":"68","3":"96"},{"1":"2020","2":"13","3":"33"},{"1":"2021","2":"3","3":"19"},{"1":"2014","2":"0","3":"29"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="cumulative-reports" class="section level2">
<h2>Cumulative reports</h2>
<pre class="r"><code>weeks = sort(unique(sbr_rep$week))
sbr_rep_cum = data.frame()
for(i in 1:(length(weeks))){
  
cumulative = sbr_rep %&gt;%
  ungroup() %&gt;% 
    filter(week &lt;= weeks[i]) %&gt;% 
    dplyr::select(season,state,Phen_state,lat_utm, lon_utm, lat, lon, days,month, days_sep15) %&gt;% 
    mutate(week = weeks[i])

sbr_rep_cum = sbr_rep_cum %&gt;% 
  bind_rows(cumulative)
}

# max(sbr_rep$days)
# sbr_rep_cum$month = factor(sbr_rep_cum$month, levels = c(&quot;Set&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;, &quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;,&quot;Apr&quot;))</code></pre>
<p>Visualization</p>
<pre class="r"><code>sbr_rep_cum %&gt;%
  group_by(season, week) %&gt;% 
  summarise(count = n()
            ) %&gt;% 
  ggplot(aes(week,count)
         )+
  geom_bar(stat = &quot;identity&quot;,
           position = &quot;dodge&quot;,
           color = &quot;black&quot;,
           size = .5)+
  scale_fill_manual(values = c(&quot;black&quot;, &quot;gray40&quot;))+
  facet_wrap(~season)+
  labs(x = &quot;Month&quot;,
       y = &quot;Reports count&quot;,
       fill = &quot;Season&quot;
       )+
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = &quot;none&quot;
        )</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<pre class="r"><code># ggsave(&quot;figs/fig3.png&quot;, dpi = 600, height = 12, width = 6)</code></pre>
<p>Shape BR</p>
<pre class="r"><code>shape_BR = readOGR(&quot;shapefiles/shape-files-BRA&quot;,&quot;BRA_adm1&quot; )</code></pre>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;G:\Meu Drive\Kaique-Alves\SBR-soybean\02 - SBR_spatiotemporal-description\Data_analysis\shapefiles\shape-files-BRA&quot;, layer: &quot;BRA_adm1&quot;
## with 27 features
## It has 16 fields</code></pre>
<pre class="r"><code>shape_BR@data$id = rownames(shape_BR@data)
BR_points = fortify(shape_BR)</code></pre>
<pre><code>## Regions defined for each Polygons</code></pre>
<pre class="r"><code>BR_df =plyr::join(BR_points, shape_BR@data, by=&quot;id&quot;)</code></pre>
</div>
</div>
<div id="spatial" class="section level1">
<h1>Spatial</h1>
<div id="nnd" class="section level2">
<h2>NND</h2>
<pre class="r"><code>last_nnd = sbr_rep_cum %&gt;%
  group_by(season, week) %&gt;% 
  filter(n() &gt; 1)%&gt;%
  summarise(mean_nnd = median(nndist(lon_utm/1000, lat_utm/1000))) %&gt;% 
  group_by(season) %&gt;% 
  filter(week == last(week)) %&gt;%
  mutate(last_nnd = mean_nnd) %&gt;% 
  dplyr::select(-week, -mean_nnd)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<pre class="r"><code>last_nnd</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["last_nnd"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"2005","2":"18.43010"},{"1":"2006","2":"15.62614"},{"1":"2007","2":"18.83579"},{"1":"2008","2":"17.93641"},{"1":"2009","2":"16.81897"},{"1":"2010","2":"18.28933"},{"1":"2011","2":"17.26430"},{"1":"2012","2":"40.51447"},{"1":"2013","2":"21.90546"},{"1":"2014","2":"20.17550"},{"1":"2015","2":"21.20187"},{"1":"2016","2":"20.66928"},{"1":"2017","2":"23.60880"},{"1":"2018","2":"19.56702"},{"1":"2019","2":"27.08831"},{"1":"2020","2":"29.83811"},{"1":"2021","2":"20.09777"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>sbr_rep_cum %&gt;%
  group_by(season, week) %&gt;% 
  filter(n() &gt; 1)%&gt;%
  summarise(mean_nnd = median(nndist(lon_utm/1000, lat_utm/1000))) %&gt;% 
  arrange(mean_nnd) %&gt;% 
  filter(mean_nnd == max(mean_nnd))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["week"],"name":[2],"type":["int"],"align":["right"]},{"label":["mean_nnd"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"2021","2":"19","3":"34.71428"},{"1":"2019","2":"8","3":"39.44504"},{"1":"2012","2":"26","3":"40.51447"},{"1":"2012","2":"27","3":"40.51447"},{"1":"2012","2":"28","3":"40.51447"},{"1":"2012","2":"29","3":"40.51447"},{"1":"2012","2":"30","3":"40.51447"},{"1":"2012","2":"31","3":"40.51447"},{"1":"2012","2":"32","3":"40.51447"},{"1":"2012","2":"33","3":"40.51447"},{"1":"2011","2":"11","3":"41.95194"},{"1":"2017","2":"13","3":"50.43214"},{"1":"2008","2":"15","3":"51.41052"},{"1":"2008","2":"16","3":"51.41052"},{"1":"2005","2":"13","3":"65.94598"},{"1":"2006","2":"9","3":"71.22690"},{"1":"2014","2":"15","3":"77.28122"},{"1":"2014","2":"16","3":"77.28122"},{"1":"2014","2":"17","3":"77.28122"},{"1":"2007","2":"10","3":"80.92312"},{"1":"2007","2":"11","3":"80.92312"},{"1":"2018","2":"11","3":"85.19463"},{"1":"2016","2":"9","3":"109.16143"},{"1":"2015","2":"12","3":"109.96444"},{"1":"2015","2":"13","3":"109.96444"},{"1":"2013","2":"12","3":"162.19206"},{"1":"2009","2":"17","3":"164.49793"},{"1":"2010","2":"10","3":"169.00753"},{"1":"2010","2":"11","3":"169.00753"},{"1":"2020","2":"12","3":"302.37029"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>first_nnd = sbr_rep_cum %&gt;%
  group_by(season, week) %&gt;% 
  filter(n() &gt; 1)%&gt;%
  summarise(mean_nnd = median(nndist(lon_utm/1000, lat_utm/1000))) %&gt;% 
  group_by(season) %&gt;%
  filter(week == first(week)) %&gt;%
  mutate(first_nnd = mean_nnd) %&gt;%
  dplyr::select(-week, -mean_nnd)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<pre class="r"><code>first_nnd</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["first_nnd"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"2005","2":"65.94598"},{"1":"2006","2":"47.82860"},{"1":"2007","2":"80.92312"},{"1":"2008","2":"40.71973"},{"1":"2009","2":"164.49793"},{"1":"2010","2":"125.10123"},{"1":"2011","2":"41.95194"},{"1":"2012","2":"24.02233"},{"1":"2013","2":"162.19206"},{"1":"2014","2":"77.28122"},{"1":"2015","2":"109.96444"},{"1":"2016","2":"109.16143"},{"1":"2017","2":"46.62350"},{"1":"2018","2":"24.26974"},{"1":"2019","2":"39.44504"},{"1":"2020","2":"302.37029"},{"1":"2021","2":"16.47882"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>sbr_rep_cum %&gt;%
  group_by(season, week) %&gt;% 
  filter(n()&gt;1)%&gt;%
  summarise(mean_nnd = median(nndist(lon_utm/1000, lat_utm/1000))) %&gt;% 
  ggplot(aes(week,mean_nnd)
         )+
  geom_bar(stat = &quot;identity&quot;,
           position = &quot;dodge&quot;,
           color = &quot;white&quot;,
           size = .5)+
  # scale_fill_colorblind() + 
  scale_fill_manual(values = c(&quot;black&quot;, &quot;gray40&quot;))+
  facet_wrap(~season)+
  labs(x = &quot;Week&quot;,
       y = &quot;MEdian NND&quot;,
       fill = &quot;Season&quot;
       )+
  theme(axis.text.x = element_text(angle = 0, vjust = 0),
        legend.position = &quot;none&quot;
        )</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<pre class="r"><code># ggsave(&quot;figs/nnd.png&quot;, dpi = 300, height = 10, width = 6)</code></pre>
<pre class="r"><code>nnd = sbr_rep_cum %&gt;%
  group_by(season, week) %&gt;% 
  filter(n()&gt;1)%&gt;%
  summarise(mean_nnd = median(nndist(lon_utm/1000, lat_utm/1000))) %&gt;% 
  full_join(ensodata2) %&gt;%
  ggplot(aes(week, mean_nnd,  group =season, color = enso))+
  geom_line(alpha = 0.2)+
  geom_smooth(aes(group = enso), alpha=0.2)+
  scale_color_colorblind()+
  labs(x = &quot;Week&quot;,
       y = &quot;Median NND&quot;,
       color = &quot;&quot;)+
  theme(text = element_text(size = 14))+
  scale_x_continuous(limits =  c(5,35), breaks = seq(0,35, by = 5))+
  theme_half_open()+
  theme(legend.position = &quot;bottom&quot;)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<pre><code>## Joining, by = &quot;season&quot;</code></pre>
<pre class="r"><code>nnd</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 1 row(s) containing missing values (geom_path).</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<pre class="r"><code>nnd_for_gam = sbr_rep_cum %&gt;%
  group_by(season, week) %&gt;% 
  filter(n()&gt;1)%&gt;%
  summarise(mean_nnd = median(nndist(lon_utm/1000, lat_utm/1000))) %&gt;% 
  full_join(ensodata2)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<pre><code>## Joining, by = &quot;season&quot;</code></pre>
<div id="gam-nnd" class="section level4">
<h4>gam NND</h4>
<pre class="r"><code>lm_nnd = mgcv::gamm(mean_nnd ~ enso+s(week, by= enso),
                    random = list(season=~1),
                    family =Gamma(link = &quot;log&quot;),
                    data = nnd_for_gam)</code></pre>
<pre><code>## 
##  Maximum number of PQL iterations:  20</code></pre>
<pre><code>## iteration 1</code></pre>
<pre><code>## iteration 2</code></pre>
<pre><code>## iteration 3</code></pre>
<pre><code>## iteration 4</code></pre>
<pre class="r"><code>summary(lm_nnd$gam)</code></pre>
<pre><code>## 
## Family: Gamma 
## Link function: log 
## 
## Formula:
## mean_nnd ~ enso + s(week, by = enso)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.40226    0.06156  55.263   &lt;2e-16 ***
## ensoEl Niño -0.17574    0.11011  -1.596    0.111    
## ensoLa Niña -0.20991    0.11084  -1.894    0.059 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                       edf Ref.df      F p-value    
## s(week):ensoNeutral 4.343  4.343 83.600  &lt;2e-16 ***
## s(week):ensoEl Niño 4.204  4.204 49.819  &lt;2e-16 ***
## s(week):ensoLa Niña 1.000  1.000  3.702  0.0551 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.409   
##   Scale est. = 0.10862   n = 384</code></pre>
<pre class="r"><code>nnd = plot_smooths(
  model = lm_nnd$gam,
  series = week,
  comparison = enso,
  transform = exp
)+
  guides(fill = F, linetype =F)+
  scale_color_colorblind()+
  scale_fill_manual(values = c(&quot;gray50&quot;,&quot;gray50&quot;,&quot;gray50&quot;))+
  scale_linetype_manual(values = c(1,1,1))+
  theme_half_open()+
  geom_line(data = nnd_for_gam,
            aes(week,mean_nnd, group = season, color = enso),
            alpha = 0.2)+
  geom_line(size =1, aes(color = enso))+
  labs(x = &quot;Week&quot;,
       y = &quot;NND (km)&quot;,
       color = &quot;&quot;, 
       title = &quot;Nearest-neighbor distances&quot;)+
  scale_x_continuous(limits = c(8,30), breaks = seq(5,30,by =5))+
  theme(legend.position = &quot;none&quot;)
nnd</code></pre>
<pre><code>## Warning: Removed 21 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 53 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 21 row(s) containing missing values (geom_path).</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
</div>
</div>
<div id="area" class="section level2">
<h2>Area</h2>
<p>Example</p>
<pre class="r"><code>dat &lt;- matrix(stats::rnorm(6), ncol = 2)
ch &lt;- chull(dat)
coords &lt;- dat[c(ch, ch[1]), ]  # closed polygon

# plot(dat, pch=19)
# lines(coords, col= &quot;red&quot;)
pol1 &lt;- spPolygons(coords, crs=&quot;+proj=utm +zone=22 +datum=WGS84&quot;)
# raster::area(pol1)</code></pre>
<pre class="r"><code>area_calc = function(lon, lat){
lat = as.matrix(lat)
lon = as.matrix(lon)
dat = cbind(lon,lat)
ch &lt;- chull(dat)
coords &lt;- dat[c(ch, ch[1]), ]  # closed polygon

pol1 &lt;- spPolygons(coords, crs=&quot;+proj=utm +zone=22 +datum=WGS84&quot;)
area1 = raster::area(pol1)
return(as.numeric(area1))
}</code></pre>
<div id="max-area" class="section level3">
<h3>Max area</h3>
<pre class="r"><code>areas_stats = sbr_rep_cum %&gt;%
  group_by(season, week) %&gt;% 
  filter(n()&gt;=3)%&gt;%
  summarise(area = area_calc(lon = lon_utm, lat = lat_utm)/1000000) %&gt;%
  # mutate(area_state = case_when(state == &quot;PR&quot; ~ 199307.922 ,
  #                               state == &quot;RS&quot; ~281730.223 )) %&gt;% 
  group_by(season) %&gt;% 
  summarise(max_area = max(area), min_area = min(area))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre class="r"><code>areas_stats %&gt;% 
  arrange(max_area)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["max_area"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["min_area"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"2012","2":"249999.8","3":"3660.2188"},{"1":"2014","2":"253507.2","3":"6670.2131"},{"1":"2020","2":"305260.9","3":"109889.5049"},{"1":"2007","2":"319332.9","3":"7808.6806"},{"1":"2013","2":"345133.2","3":"51751.0475"},{"1":"2011","2":"348826.0","3":"15516.5286"},{"1":"2006","2":"358942.9","3":"3645.1739"},{"1":"2018","2":"370747.8","3":"32068.2625"},{"1":"2009","2":"380001.1","3":"58730.3422"},{"1":"2021","2":"390225.3","3":"168.6608"},{"1":"2008","2":"397662.9","3":"19218.1876"},{"1":"2019","2":"410095.6","3":"22788.4118"},{"1":"2005","2":"411529.4","3":"41664.6524"},{"1":"2017","2":"426816.9","3":"9630.2847"},{"1":"2016","2":"440652.7","3":"8911.0661"},{"1":"2010","2":"447259.8","3":"90960.3069"},{"1":"2015","2":"507303.8","3":"21428.5092"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="visualization" class="section level2">
<h2>Visualization</h2>
<pre class="r"><code>area_df = sbr_rep_cum %&gt;%
  group_by(season, week) %&gt;% 
  filter(n()&gt;=3)%&gt;%
  summarise(area = area_calc(lon = lon_utm, lat = lat_utm)/1000000)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<pre class="r"><code>area_df2 = area_df %&gt;% 
  full_join(ensodata2) %&gt;% 
  group_by(season) %&gt;% 
  mutate(dif = (`area`)-lag(area)) %&gt;% 
  ungroup() %&gt;% 
  filter(dif != 0)</code></pre>
<pre><code>## Joining, by = &quot;season&quot;</code></pre>
<div id="rate-of-increase-in-the-epidemic-area" class="section level5">
<h5>rate of increase in the epidemic area</h5>
<pre class="r"><code>area_rate = area_df2 %&gt;% 
  group_by(season) %&gt;% 
  summarise(rate_area = mean(dif))</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre class="r"><code>area = area_df2  %&gt;%
  # full_join(ensodata2) %&gt;% 
  ggplot(aes(week, area/10000, group = season, color =enso))+
  geom_line(alpha = 0.2)+
  geom_smooth(aes(group = enso), alpha=0.2)+
  scale_color_colorblind() + 
  labs(x = &quot;Week&quot;,
       y = expression(paste(&quot;Area 10&quot;^4, &quot; km²&quot;)),
       color = &quot;&quot;)+
  theme(text = element_text(size = 14))+
  scale_x_continuous(limits =  c(5,35), breaks = seq(0,35, by = 5))+
  theme_half_open()+
  theme(legend.position = &quot;bottom&quot;)

area </code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<pre class="r"><code>  # ggsave(&quot;figs/area.png&quot;, dpi = 600, height = 4, width = 8)</code></pre>
</div>
<div id="gam-area" class="section level4">
<h4>gam area</h4>
<pre class="r"><code>lm_area = mgcv::gamm(area/10000 ~ enso+s(week, by= enso),
                     random = list(season=~1),
                     family =Gamma(link = &quot;log&quot;),
                     data = area_df%&gt;% 
                       full_join(ensodata2))</code></pre>
<pre><code>## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;</code></pre>
<pre><code>## 
##  Maximum number of PQL iterations:  20</code></pre>
<pre><code>## iteration 1</code></pre>
<pre><code>## iteration 2</code></pre>
<pre><code>## iteration 3</code></pre>
<pre><code>## iteration 4</code></pre>
<pre><code>## iteration 5</code></pre>
<pre><code>## iteration 6</code></pre>
<pre class="r"><code>summary(lm_area$gam)</code></pre>
<pre><code>## 
## Family: Gamma 
## Link function: log 
## 
## Formula:
## area/10000 ~ enso + s(week, by = enso)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.05141    0.09308  32.783   &lt;2e-16 ***
## ensoEl Niño  0.32475    0.16730   1.941   0.0530 .  
## ensoLa Niña -0.41908    0.16801  -2.494   0.0131 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                       edf Ref.df      F p-value    
## s(week):ensoNeutral 6.176  6.176 119.61  &lt;2e-16 ***
## s(week):ensoEl Niño 4.697  4.697  80.66  &lt;2e-16 ***
## s(week):ensoLa Niña 4.706  4.706 200.56  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.764   
##   Scale est. = 0.10392   n = 376</code></pre>
<pre class="r"><code># plot(lm_area$gam)</code></pre>
<pre class="r"><code>area =plot_smooths(
  model = lm_area$gam,
  series = week,
  comparison = enso,
  transform = exp
)+
  guides(fill = F, linetype =F)+
  scale_color_colorblind()+
  scale_fill_manual(values = c(&quot;gray50&quot;,&quot;gray50&quot;,&quot;gray50&quot;))+
  scale_linetype_manual(values = c(1,1,1))+
  theme_half_open()+
  geom_line(data = area_df %&gt;% full_join(ensodata2),
            aes(week,area/10000, group = season, color = enso),
            alpha = 0.2)+
  geom_line(size =1, aes(color = enso))+
  labs(x = &quot;Week&quot;,
       y = expression(paste(&quot;Area 10&quot;^4, &quot; km²&quot;)),
       color = &quot;&quot;,
       title = &quot;Epidemic area&quot;)+
  scale_x_continuous(limits = c(8,30), breaks = seq(5,30,by =5))+
  theme(legend.position = &quot;bottom&quot;)</code></pre>
<pre><code>## Joining, by = &quot;season&quot;</code></pre>
<pre class="r"><code>area</code></pre>
<pre><code>## Warning: Removed 9 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 51 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 9 row(s) containing missing values (geom_path).</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
</div>
</div>
<div id="density-index" class="section level2">
<h2>Density index</h2>
<pre class="r"><code>week_count = sbr_rep_cum %&gt;%
  group_by(season, week) %&gt;% 
  filter(n()&gt;=3)%&gt;%
  summarise(count = n()) %&gt;% 
  # group_by(season) %&gt;% 
  # dplyr::mutate(prevalence = cumsum(count)) %&gt;% 
  full_join(area_df) %&gt;%
  mutate(density =  count/area,
         density = case_when(density&gt;0.002 ~ 0.002,
                             density&lt;=0.02 ~ density)) %&gt;% 
  mutate(period =  case_when(season &gt; 2011 ~ &quot;POSt&quot;,
                             season &lt;= 2011 ~ &quot;PRE&quot;)) %&gt;%
  full_join(ensodata2)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39; (override with `.groups` argument)</code></pre>
<pre><code>## Joining, by = c(&quot;season&quot;, &quot;week&quot;)</code></pre>
<pre><code>## Joining, by = &quot;season&quot;</code></pre>
<pre class="r"><code>density = week_count   %&gt;% 
  ggplot(aes(week, density, group = season, color=enso))+
  geom_line(alpha = 0.2)+
  geom_smooth(aes(group = enso), alpha=0.2, method= &quot;gam&quot;, formula = y ~s(x))+
  scale_y_log10()+
  scale_color_colorblind()+
  labs(y = &quot;Density&quot;, x =&quot;Week&quot;, color = &quot;&quot;)+
  theme(text = element_text(size = 14))+
  scale_x_continuous(limits =  c(5,35), breaks = seq(0,35, by = 5))+
  theme_half_open()+
  theme(legend.position = &quot;bottom&quot;)
  
density</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-66-1.png" width="672" /> #### gam density</p>
<pre class="r"><code>lm_dens = mgcv::gamm(density*1000 ~ enso+s(week, by= enso, k=10, bs= &quot;cr&quot;),
                    random = list(season=~1),
                    family =Gamma(link = &quot;log&quot;),
                    data = week_count)</code></pre>
<pre><code>## 
##  Maximum number of PQL iterations:  20</code></pre>
<pre><code>## iteration 1</code></pre>
<pre><code>## iteration 2</code></pre>
<pre><code>## iteration 3</code></pre>
<pre><code>## iteration 4</code></pre>
<pre><code>## iteration 5</code></pre>
<pre><code>## iteration 6</code></pre>
<pre><code>## iteration 7</code></pre>
<pre><code>## iteration 8</code></pre>
<pre><code>## iteration 9</code></pre>
<pre><code>## iteration 10</code></pre>
<pre><code>## iteration 11</code></pre>
<pre class="r"><code>summary(lm_dens$gam)</code></pre>
<pre><code>## 
## Family: Gamma 
## Link function: log 
## 
## Formula:
## density * 1000 ~ enso + s(week, by = enso, k = 10, bs = &quot;cr&quot;)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -1.25009    0.09701 -12.887   &lt;2e-16 ***
## ensoEl Niño  0.13945    0.17406   0.801   0.4236    
## ensoLa Niña  0.30101    0.17569   1.713   0.0875 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                       edf Ref.df      F  p-value    
## s(week):ensoNeutral 4.972  4.972 18.679  &lt; 2e-16 ***
## s(week):ensoEl Niño 2.866  2.866  8.661 1.87e-05 ***
## s(week):ensoLa Niña 5.983  5.983 17.815  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =   0.25   
##   Scale est. = 0.1736    n = 376</code></pre>
<pre class="r"><code>density = plot_smooths(
  model = lm_dens$gam,
  series = week,
  comparison = enso,
  transform = exp
)+
  guides(fill = F, linetype =F)+
  scale_color_colorblind()+
  scale_fill_manual(values = c(&quot;gray50&quot;,&quot;gray50&quot;,&quot;gray50&quot;))+
  scale_linetype_manual(values = c(1,1,1))+
  theme_half_open()+
  geom_line(data = week_count,
            aes(week,density*1000, group = season, color = enso),
            alpha = 0.2)+
  scale_x_continuous(limits = c(8,30), breaks = seq(5,30,by =5))+
  geom_line(size =1, aes(color = enso))+
  labs(x = &quot;Week&quot;,
       y = &quot;Density&quot;,
       color = &quot;&quot;,
       title = &quot;Spatial density&quot;)+
  coord_cartesian(ylim = c(0,1.2))+
  theme(legend.position = &quot;none&quot;)
density</code></pre>
<pre><code>## Warning: Removed 9 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 51 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 9 row(s) containing missing values (geom_path).</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
</div>
<div id="correlation-weekly-area" class="section level2">
<h2>Correlation weekly area</h2>
<pre class="r"><code>area_df %&gt;%
  group_by(season) %&gt;% 
  mutate(last_area = last(area)) %&gt;%
  group_by(week) %&gt;% 
  filter(n()&gt;2) %&gt;%
  ggplot(aes(area, last_area))+
  geom_point()+
  geom_abline(intercept = 0, slope = 1, color =  &quot;red&quot;)+
  geom_smooth(method = &quot;lm&quot;, se =F)+
  facet_wrap(~week)+
  theme(#legend.position = &quot;none&quot;,
        panel.background = element_blank(),
        panel.grid = element_blank(),
        panel.border = element_blank(),
        axis.line.x = element_line(color = &quot;black&quot;),
        axis.line.y = element_line(color = &quot;black&quot;),
        axis.text.x = element_text(angle = 0))</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<pre class="r"><code>area_df %&gt;%
  group_by(season) %&gt;% 
  mutate(last_area = last(area)) %&gt;%
  group_by(week) %&gt;% 
  filter(n()&gt;2) %&gt;% 
  summarise(cor = cor.test(area, last_area)$estimate,
            p_value = cor.test(area, last_area)$p.value) %&gt;%
  filter(p_value &lt;0.05) %&gt;%
  ggplot(aes(week, cor))+
  # ylim(0,1)+
  geom_line()+
  geom_point(aes(size = p_value))+
  scale_x_continuous(breaks = seq(0,32,by = 2))+
  theme(#legend.position = &quot;none&quot;,
        panel.background = element_blank(),
        panel.grid = element_blank(),
        panel.border = element_blank(),
        axis.line.x = element_line(color = &quot;black&quot;),
        axis.line.y = element_line(color = &quot;black&quot;),
        axis.text.x = element_text(angle = 0))  </code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
</div>
<div id="max-distance" class="section level2">
<h2>Max distance</h2>
<pre class="r"><code>box1 = data.frame()
seasons = as.numeric(unique(sbr_rep$season))
for(i in 1:length(seasons)){


sbr_dist1 = sbr_rep %&gt;% 
  mutate(season = as.numeric(season)) %&gt;% 
  filter(season == seasons[i]) 

weeks1 = unique(sbr_dist1$week)


for(j in 1:length(weeks1)){
sbr_dist2 = sbr_dist1%&gt;% 
  filter(week &lt;= weeks1[j]) %&gt;%
  dplyr::select(lon_utm, lat_utm) %&gt;% 
  mutate(ID = 1:length(lon_utm),
         ZZZ = 1) 
  



dist_df = sbr_dist2 %&gt;% 
  full_join(sbr_dist2,c(&quot;ZZZ&quot;=&quot;ZZZ&quot;)) %&gt;% 
  filter(ID.x != ID.y) %&gt;% 
        mutate(dist=sqrt((lon_utm.x-lon_utm.y)^2 + (lat_utm.x-lat_utm.y)^2)) %&gt;% 
  arrange(dist)

d = max(dist_df$dist, na.rm = T)/1000

lil_box = data.frame(season = seasons[i], week  = weeks1[j], dist = d)
box1 = box1 %&gt;% 
  bind_rows(lil_box)
}

}</code></pre>
<pre><code>## Warning in max(dist_df$dist, na.rm = T): nenhum argumento não faltante para max;
## retornando -Inf

## Warning in max(dist_df$dist, na.rm = T): nenhum argumento não faltante para max;
## retornando -Inf

## Warning in max(dist_df$dist, na.rm = T): nenhum argumento não faltante para max;
## retornando -Inf

## Warning in max(dist_df$dist, na.rm = T): nenhum argumento não faltante para max;
## retornando -Inf

## Warning in max(dist_df$dist, na.rm = T): nenhum argumento não faltante para max;
## retornando -Inf

## Warning in max(dist_df$dist, na.rm = T): nenhum argumento não faltante para max;
## retornando -Inf

## Warning in max(dist_df$dist, na.rm = T): nenhum argumento não faltante para max;
## retornando -Inf

## Warning in max(dist_df$dist, na.rm = T): nenhum argumento não faltante para max;
## retornando -Inf

## Warning in max(dist_df$dist, na.rm = T): nenhum argumento não faltante para max;
## retornando -Inf

## Warning in max(dist_df$dist, na.rm = T): nenhum argumento não faltante para max;
## retornando -Inf</code></pre>
<pre class="r"><code>box1_dist = box1 %&gt;%
  mutate(season = as.character(season)) %&gt;% 
  full_join(ensodata2)%&gt;% 
  filter(!is.infinite(dist))</code></pre>
<pre><code>## Joining, by = &quot;season&quot;</code></pre>
<div id="gam-dist" class="section level4">
<h4>gam dist</h4>
<pre class="r"><code>lm_dist = mgcv::gamm(dist ~ enso+s(week, by= enso),
                     random = list(season=~1),
                     family =Gamma(link = &quot;log&quot;),
                     data = box1_dist)</code></pre>
<pre><code>## 
##  Maximum number of PQL iterations:  20</code></pre>
<pre><code>## iteration 1</code></pre>
<pre><code>## iteration 2</code></pre>
<pre><code>## iteration 3</code></pre>
<pre><code>## iteration 4</code></pre>
<pre class="r"><code>summary(lm_dist$gam)</code></pre>
<pre><code>## 
## Family: Gamma 
## Link function: log 
## 
## Formula:
## dist ~ enso + s(week, by = enso)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  6.56377    0.03109 211.099  &lt; 2e-16 ***
## ensoEl Niño  0.21212    0.05779   3.670 0.000297 ***
## ensoLa Niña -0.14835    0.05741  -2.584 0.010343 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                       edf Ref.df     F p-value    
## s(week):ensoNeutral 5.588  5.588 85.44  &lt;2e-16 ***
## s(week):ensoEl Niño 4.078  4.078 49.21  &lt;2e-16 ***
## s(week):ensoLa Niña 3.536  3.536 83.73  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.743   
##   Scale est. = 0.035552  n = 264</code></pre>
<pre class="r"><code># plot(lm_area$gam)</code></pre>
<pre class="r"><code>dist_plot =plot_smooths(
  model = lm_dist$gam,
  series = week,
  comparison = enso,
  transform = exp
)+
  guides(fill = F, linetype =F)+
  scale_color_colorblind()+
  scale_fill_manual(values = c(&quot;gray50&quot;,&quot;gray50&quot;,&quot;gray50&quot;))+
  scale_linetype_manual(values = c(1,1,1))+
  theme_half_open()+
  geom_line(data = box1_dist,
            aes(week,dist, group = season, color = enso),
            alpha = 0.2)+
  geom_line(size =1, aes(color = enso))+
  labs(x = &quot;Week&quot;,
       y = &quot;Distance (km)&quot;,
       color = &quot;&quot;,
       title = &quot;Epidemic front&quot;)+
  scale_x_continuous(limits = c(8,30), breaks = seq(5,30,by =5))+
  coord_cartesian(ylim = c(0,1300))+
  theme(legend.position = &quot;none&quot;)
dist_plot</code></pre>
<pre><code>## Warning: Removed 21 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 4 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 21 row(s) containing missing values (geom_path).</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<div id="combo" class="section level5">
<h5>Combo</h5>
<pre class="r"><code>nnd+dist_plot+area+density+
  plot_layout(nrow = 2)+
  plot_annotation(tag_levels = &quot;A&quot;)&amp;
  theme(plot.title = element_text(size = 11))</code></pre>
<pre><code>## Warning: Removed 21 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 53 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 21 row(s) containing missing values (geom_path).

## Warning: Removed 21 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 4 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 21 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 9 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 51 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 9 row(s) containing missing values (geom_path).

## Warning: Removed 9 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 51 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 9 row(s) containing missing values (geom_path).</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<pre class="r"><code>ggsave(&quot;figs/nnd_area.png&quot;, dpi = 600, height =8, width =10)</code></pre>
<pre><code>## Warning: Removed 21 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 53 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 21 row(s) containing missing values (geom_path).

## Warning: Removed 21 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 4 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 21 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 9 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 51 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 9 row(s) containing missing values (geom_path).

## Warning: Removed 9 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 51 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 9 row(s) containing missing values (geom_path).</code></pre>
</div>
</div>
<div id="table" class="section level4">
<h4>Table</h4>
<pre class="r"><code>last_nnd %&gt;% 
  full_join(areas_stats[,1:2] %&gt;% 
              mutate(max_area = max_area/10000)) %&gt;% 
  full_join(area_rate %&gt;% mutate(rate_area = rate_area/10000)) %&gt;% 
  full_join(week_count %&gt;% 
    group_by(season) %&gt;% 
    filter(week == max(week)) %&gt;% 
    dplyr::select(season, density) %&gt;% mutate(density = density*10000)) %&gt;% 
  full_join(box1_dist %&gt;% 
    group_by(season) %&gt;% 
    filter(week == max(week))%&gt;% 
    dplyr::select(season, dist)) %&gt;% 
  full_join(ensodata2[13:14]) %&gt;% 
  arrange(dist) %&gt;%
  ungroup() %&gt;% 
  # group_by(enso) %&gt;% 
  summarise(mean(dist))</code></pre>
<pre><code>## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mean(dist)"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"1029.836"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="principal-components-analysis" class="section level1">
<h1>Principal components analysis</h1>
<p>libraries</p>
<p>gathering the variables</p>
<pre class="r"><code>pca_data = epi_time %&gt;% 
  full_join(max_prevalance) %&gt;% 
  full_join(r) %&gt;%
  full_join(audpc) %&gt;%
  full_join(time_10) %&gt;%
  full_join(min_sep15) %&gt;% 
  # full_join(time_to_outbreak) %&gt;%
  # full_join(last_nnd) %&gt;%
  full_join(first_nnd) %&gt;%
  full_join(areas_stats) %&gt;%
  full_join(prev_all) %&gt;% 
  dplyr::select(-region)</code></pre>
<pre><code>## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;
## Joining, by = &quot;season&quot;</code></pre>
<pre class="r"><code>pca_data</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["chr"],"align":["left"]},{"label":["epidemic_time"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["max_prev"],"name":[3],"type":["int"],"align":["right"]},{"label":["Rate"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["audpc"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["time_10"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Time to 1st report"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["first_nnd"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["max_area"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["min_area"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["prev_100"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["prev_130"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"2015","2":"89","3":"178","4":"0.030940533","5":"0.44094035","6":"112","7":"80","8":"109.96444","9":"507303.8","10":"21428.5092","11":"11","12":"74"},{"1":"2014","2":"90","3":"60","4":"0.007544833","5":"0.14130740","6":"113","7":"102","8":"77.28122","9":"253507.2","10":"6670.2131","11":"0","12":"29"},{"1":"2021","2":"95","3":"121","4":"0.020726815","5":"0.28643533","6":"120","7":"86","8":"16.47882","9":"390225.3","10":"168.6608","11":"3","12":"19"},{"1":"2011","2":"99","3":"168","4":"0.030174254","5":"0.33966638","6":"97","7":"70","8":"41.95194","9":"348826.0","10":"15516.5286","11":"17","12":"81"},{"1":"2016","2":"100","3":"121","4":"0.016833275","5":"0.18119874","6":"76","7":"53","8":"109.16143","9":"440652.7","10":"8911.0661","11":"67","12":"120"},{"1":"2020","2":"101","3":"70","4":"0.006582059","5":"0.13859044","6":"88","7":"79","8":"302.37029","9":"305260.9","10":"109889.5049","11":"13","12":"33"},{"1":"2012","2":"107","3":"27","4":"0.001708074","5":"0.04929391","6":"82","7":"80","8":"24.02233","9":"249999.8","10":"3660.2188","11":"9","12":"12"},{"1":"2019","2":"113","3":"119","4":"0.008628750","5":"0.16068089","6":"55","7":"46","8":"39.44504","9":"410095.6","10":"22788.4118","11":"68","12":"96"},{"1":"2018","2":"118","3":"161","4":"0.016270448","5":"0.26912795","6":"94","7":"69","8":"24.26974","9":"370747.8","10":"32068.2625","11":"22","12":"91"},{"1":"2005","2":"123","3":"195","4":"0.029136094","5":"0.32441461","6":"108","7":"64","8":"65.94598","9":"411529.4","10":"41664.6524","11":"10","12":"103"},{"1":"2008","2":"125","3":"188","4":"0.022117973","5":"0.32632808","6":"114","7":"82","8":"40.71973","9":"397662.9","10":"19218.1876","11":"9","12":"72"},{"1":"2009","2":"125","3":"209","4":"0.028089533","5":"0.40768454","6":"128","7":"88","8":"164.49793","9":"380001.1","10":"58730.3422","11":"1","12":"23"},{"1":"2007","2":"126","3":"195","4":"0.022457225","5":"0.31324170","6":"97","7":"60","8":"80.92312","9":"319332.9","10":"7808.6806","11":"21","12":"116"},{"1":"2017","2":"132","3":"124","4":"0.012901717","5":"0.19508771","6":"97","7":"62","8":"46.62350","9":"426816.9","10":"9630.2847","11":"11","12":"68"},{"1":"2013","2":"133","3":"105","4":"0.014752344","5":"0.15808449","6":"103","7":"48","8":"162.19206","9":"345133.2","10":"51751.0475","11":"8","12":"60"},{"1":"2006","2":"166","3":"215","4":"0.019576819","5":"0.27317472","6":"82","7":"55","8":"47.82860","9":"358942.9","10":"3645.1739","11":"31","12":"69"},{"1":"2010","2":"169","3":"185","4":"0.026610893","5":"0.21420305","6":"94","7":"14","8":"125.10123","9":"447259.8","10":"90960.3069","11":"22","12":"98"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>correlogram</p>
<pre class="r"><code>ggpairs(pca_data[,-1], progress = FALSE)+
  theme_bw()</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-78-1.png" width="960" /></p>
<div id="pca" class="section level2">
<h2>PCA</h2>
<pre class="r"><code>pca1 = prcomp(pca_data[,-1] , center = TRUE, scale. = TRUE)
summary(pca1)</code></pre>
<pre><code>## Importance of components:
##                           PC1    PC2    PC3     PC4     PC5     PC6     PC7
## Standard deviation     1.9438 1.7566 1.4057 1.02650 0.66823 0.54693 0.39170
## Proportion of Variance 0.3435 0.2805 0.1796 0.09579 0.04059 0.02719 0.01395
## Cumulative Proportion  0.3435 0.6240 0.8036 0.89944 0.94003 0.96722 0.98117
##                            PC8     PC9    PC10    PC11
## Standard deviation     0.34583 0.25972 0.13857 0.02909
## Proportion of Variance 0.01087 0.00613 0.00175 0.00008
## Cumulative Proportion  0.99205 0.99818 0.99992 1.00000</code></pre>
<pre class="r"><code>fm_pca1 = PCA(pca_data[,-1],graph = FALSE)
fviz_screeplot(fm_pca1)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-80-1.png" width="480" /></p>
<pre class="r"><code>plot_grid(fviz_contrib(fm_pca1, choice = &quot;var&quot;, axes = 1),
          fviz_contrib(fm_pca1, choice = &quot;var&quot;, axes = 2))</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-81-1.png" width="960" /></p>
<pre class="r"><code>fviz_contrib(fm_pca1, choice = &quot;var&quot;, axes = 1:2)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-82-1.png" width="480" /></p>
</div>
<div id="biplot" class="section level2">
<h2>biplot</h2>
<pre class="r"><code>fviz_pca_biplot(fm_pca1,
                col.var=&quot;contrib&quot;,
                repel = TRUE, 
                col.ind = NA)+
  geom_text(aes(label = pca_data$season),
                   fontface = &quot;bold&quot;,
                  size = 4,
                   color = &quot;black&quot;,
                   alpha= 1)+
  scale_color_viridis(option = &quot;B&quot;, direction = -1, end = 0.8, begin = 0.2)+
  coord_equal()+
  labs(title =&quot;&quot;)</code></pre>
<pre><code>## Warning: Removed 17 rows containing missing values (geom_point).</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
<pre class="r"><code># ggsave(&quot;figs/pca.png&quot;, dpi = 600, height = 6, width = 8)</code></pre>
<pre class="r"><code>pca_data2 = pca_data %&gt;% full_join(ensodata2[,13:14])</code></pre>
<pre><code>## Joining, by = &quot;season&quot;</code></pre>
<pre class="r"><code>fviz_pca_ind(fm_pca1,
             # col.var=&quot;contrib&quot;,
             habillage = pca_data2$enso,
             repel = TRUE,
             label = &quot;none&quot;,
             addEllipses = T,
             pointshape = 75,
             col.ind = NA,
             ellipse.level=0.8)+
  geom_text(aes(label = pca_data2$season, color =pca_data2$enso),
            # fontface = &quot;bold&quot;,
            size = 4,
            show.legend = F,
            # color = &quot;black&quot;,
            alpha= 1)+
  scale_fill_colorblind()+
  scale_color_colorblind()+
  # scale_fill_manual(values = c(NA,NA, NA))+
  coord_equal()+
  labs(title =&quot;&quot;)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
</div>
<div id="clustering" class="section level2">
<h2>clustering</h2>
<pre class="r"><code>library(&quot;ape&quot;)</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;ape&#39;:
##   method   from 
##   plot.mst spdep</code></pre>
<pre><code>## 
## Attaching package: &#39;ape&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:spatstat&#39;:
## 
##     edges, rotate</code></pre>
<pre><code>## The following objects are masked from &#39;package:raster&#39;:
## 
##     rotate, zoom</code></pre>
<pre><code>## The following object is masked from &#39;package:splancs&#39;:
## 
##     zoom</code></pre>
<pre><code>## The following object is masked from &#39;package:ggpubr&#39;:
## 
##     rotate</code></pre>
<pre><code>## The following object is masked from &#39;package:agricolae&#39;:
## 
##     consensus</code></pre>
<pre class="r"><code>library(&quot;ggdendro&quot;)</code></pre>
<pre><code>## 
## Attaching package: &#39;ggdendro&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:maptools&#39;:
## 
##     label</code></pre>
<pre class="r"><code>cluss_data = as.matrix(data.frame(scale(pca_data[-1])))
row.names(cluss_data) = as.matrix((pca_data2$enso))

NHCA = kmeans(cluss_data,3)
NHCA</code></pre>
<pre><code>## K-means clustering with 3 clusters of sizes 7, 3, 7
## 
## Cluster means:
##   epidemic_time   max_prev       Rate      audpc    time_10 Time.to.1st.report
## 1   -0.01255154 -0.4555083 -0.7356508 -0.6352865 -0.6721739        -0.01102127
## 2    0.68447746 -0.4222628 -0.2839164 -0.7410278 -0.1473450        -0.96864754
## 3   -0.28079594  0.6364781  0.8573293  0.9528698  0.7353217         0.42615593
##    first_nnd   max_area   min_area   prev_100    prev_130
## 1 -0.4749762 -0.2310193 -0.5410291  0.5364692  0.02363166
## 2  1.5161455 -0.1245457  1.7155251 -0.2336622 -0.13927250
## 3 -0.1748004  0.2843961 -0.1941959 -0.4363283  0.03605655
## 
## Clustering vector:
## Neutral Neutral La Niña La Niña El Niño Neutral La Niña El Niño Neutral Neutral 
##       3       1       3       3       1       2       1       1       1       3 
## La Niña Neutral El Niño Neutral Neutral Neutral El Niño 
##       3       3       3       1       2       1       2 
## 
## Within cluster sum of squares by cluster:
## [1] 60.40472 24.05277 29.25799
##  (between_SS / total_SS =  35.4 %)
## 
## Available components:
## 
## [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;     &quot;tot.withinss&quot;
## [6] &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;         &quot;ifault&quot;</code></pre>
<pre class="r"><code>dd = dist(scale(cluss_data), method = &quot;euclidean&quot;)
hc &lt;- hclust(dd, method = &quot;average&quot;)


mypal = c(&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;)
clus5 = cutree(hc, 3)
dend_field1 &lt;-plot(as.phylo(hc), type = &quot;unrooted&quot;,
                   cex = 0.6,
                   no.margin = TRUE)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<pre class="r"><code>dend &lt;- as.dendrogram(hc)
dend_data &lt;- dendro_data(dend, type = &quot;rectangle&quot;)


row.names(cluss_data) = as.matrix(
  unite_(pca_data2, &quot;season_state&quot;, c(&quot;season&quot;,&quot;enso&quot;), sep = &quot;: &quot;)$season_state
  )
dd2 = dist(scale(cluss_data), method = &quot;euclidean&quot;)
hc2 &lt;- hclust(dd2, method = &quot;ward.D2&quot;)
dend2 &lt;- as.dendrogram(hc2)
dend_data2 &lt;- dendro_data(dend2, type = &quot;rectangle&quot;)</code></pre>
<pre class="r"><code>ggplot(dend_data2$segments) + 
  # geom_rect(aes(xmin=0, xmax=4.5, ymin=4, ymax=-2), fill=&quot;gray&quot;, alpha=0.01, size = 1)+
  geom_segment(aes(x = x, y = y, xend = xend, yend = yend))+
  
  geom_text(data = dend_data2$labels %&gt;% 
              separate(label, into=c(&quot;season&quot;, &quot;enso&quot;),sep = &quot;:&quot;, remove = F),
            aes(x, y = -2 ,
                label = label,
                color = enso,
                ),
            hjust = 1, angle = 0, size = 3, fontface = &quot;bold&quot;)+
  coord_flip()+
  scale_y_reverse()+
  scale_color_colorblind()+
  labs(x = &quot;&quot;, y=&quot;&quot;, color =&quot;&quot;)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
</div>
</div>
<div id="survival-analysis" class="section level1">
<h1>Survival analysis</h1>
<div id="frequentist" class="section level2">
<h2>Frequentist</h2>
<div id="kaplan-meier-non-parametric-survival" class="section level4">
<h4>kaplan-meier non-parametric survival</h4>
<div id="data" class="section level6">
<h6>Data</h6>
<pre class="r"><code>sbr_rep_count = sbr_rep %&gt;%
  mutate(count =  1) %&gt;% 
  mutate(season = as.character(season))</code></pre>
</div>
<div id="null-model" class="section level5">
<h5>null model</h5>
<pre class="r"><code>KM0 = survfit(Surv(days, count) ~ 1, conf.type=&quot;log&quot;, type=&quot;kaplan-meier&quot;, data=sbr_rep_count)
KM0</code></pre>
<pre><code>## Call: survfit(formula = Surv(days, count) ~ 1, data = sbr_rep_count, 
##     conf.type = &quot;log&quot;, type = &quot;kaplan-meier&quot;)
## 
##       n  events  median 0.95LCL 0.95UCL 
##    2441    2441      91      90      93</code></pre>
<pre class="r"><code>overal_t = as.matrix(summary(KM0)$table)[&quot;median&quot;,1]</code></pre>
<pre class="r"><code>surv_curve_geral =  data.frame(time = KM0$time, surv = KM0$surv, lower = KM0$lower , upper = KM0$upper) 
surv_curve_geral%&gt;% 
  ggplot(aes(time, surv))+
  geom_step(size =1)+
  RcmdrPlugin.KMggplot2::geom_stepribbon(aes(ymin = lower, ymax = upper),
                                         alpha = 0.1, color = NA)+
  theme_half_open()</code></pre>
<pre><code>## Registered S3 methods overwritten by &#39;lme4&#39;:
##   method                          from
##   cooks.distance.influence.merMod car 
##   influence.merMod                car 
##   dfbeta.influence.merMod         car 
##   dfbetas.influence.merMod        car</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
</div>
<div id="season-covariate" class="section level5">
<h5>Season covariate</h5>
<pre class="r"><code>KM0_s = survfit(Surv(days, count) ~ season, conf.type=&quot;log&quot;, type=&quot;kaplan-meier&quot;, data=sbr_rep_count)
KM0_s</code></pre>
<pre><code>## Call: survfit(formula = Surv(days, count) ~ season, data = sbr_rep_count, 
##     conf.type = &quot;log&quot;, type = &quot;kaplan-meier&quot;)
## 
##               n events median 0.95LCL 0.95UCL
## season=2005 195    195   89.0      86      94
## season=2006 215    215   94.0      89     101
## season=2007 195    195   87.0      80      90
## season=2008 188    188  100.0      98     107
## season=2009 209    209  112.0     108     118
## season=2010 185    185   80.0      76      83
## season=2011 168    168   87.5      82      91
## season=2012  27     27   88.0      78     102
## season=2013 105    105   82.0      78      89
## season=2014  60     60   81.0      77      93
## season=2015 178    178  102.0      98     103
## season=2016 121    121   61.0      59      67
## season=2017 124    124   88.0      83      94
## season=2018 161    161   96.0      94      98
## season=2019 119    119   70.0      67      78
## season=2020  70     70  101.0      92     108
## season=2021 121    121   97.0      96     104</code></pre>
<pre class="r"><code>outbreak = as.data.frame(summary(KM0_s)$table[, c(&quot;*rmean&quot;,&quot;0.95LCL&quot;,&quot;0.95UCL&quot;,&quot;*se(rmean)&quot;)])
outbreak =rownames_to_column(outbreak, var = &quot;season&quot;)

out_day = outbreak %&gt;%
  separate(season, sep =&quot;=&quot;, remove = T, into = c(&quot;trash&quot;, &quot;season&quot;)) %&gt;% 
  full_join(ensodata2) %&gt;%
  mutate(season = as.numeric(season)) %&gt;% 
  # arrange(`*rmean`)
  ggplot(aes(season, `*rmean`, color = enso)) +
  geom_hline(yintercept = overal_t, color= &quot;gray&quot;, linetype = 2)+
  geom_line(color = &quot;gray&quot;,size =0.3)+
  geom_errorbar(aes(ymin = 0 , ymax = `*rmean`+`*se(rmean)`),
                size =0.3, width =0, color = &quot;gray70&quot;)+
  geom_errorbar(aes(ymin = `*rmean`-`*se(rmean)` , ymax = `*rmean`+`*se(rmean)`),
                size =0.7, width =0 #color = &quot;black&quot;
                )+
  geom_point(size = 2)+
  scale_x_continuous(breaks = 2005:2021) +
  scale_color_colorblind() + 
  labs(x = &quot;Crop season&quot;,
       y = &quot;Time to disease outbreak&quot;,
       color = &quot;&quot;)+
  theme_half_open()+
  theme(axis.text.x = element_text(angle=45, hjust =1)) </code></pre>
<pre><code>## Joining, by = &quot;season&quot;</code></pre>
<pre class="r"><code>out_day</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<pre class="r"><code>ss = summary(KM0_s)
surv_curves = data.frame(time = KM0_s$time, surv = KM0_s$surv, lower = KM0_s$lower , upper = KM0_s$upper, strata =ss$strata) %&gt;% 
  separate(strata, into = c(&quot;s&quot;, &quot;season&quot;), sep =&quot;=&quot;) %&gt;%
  full_join(ensodata2) %&gt;% 
  ggplot()+
  geom_step(aes(time, surv,  group = season, color = enso),
            size =.5,
            # color = &quot;gray&quot;,
            alpha = 0.4)+
  RcmdrPlugin.KMggplot2::geom_stepribbon(aes(time, ymin = lower, ymax = upper, group = season),
                                         alpha = 0.05, color = NA)+
  geom_step(data = surv_curve_geral,
            aes(time, surv),
            color = &quot;red&quot;, 
            size = 0.8)+
  geom_segment(x = 91, y = 0, xend = 91, yend = 0.5, linetype = 2, size =0.7)+
  geom_segment(x = 0, y = 0.5, xend = 91, yend = 0.5, linetype = 2, size =0.7)+
  scale_color_colorblind()+
  guides(color = guide_legend(override.aes = list(alpha=1, size =1)))+
  theme_half_open()+
  labs(color = &quot;&quot;,
       y = &quot;Survival probability&quot;,
       x = &quot;Days&quot;)</code></pre>
<pre><code>## Joining, by = &quot;season&quot;</code></pre>
<pre class="r"><code>surv_curves</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
<pre class="r"><code>surv_curves+out_day+
  # plot_layout(guides = &quot;collect&quot;)+
  plot_annotation(tag_levels = &quot;A&quot;)&amp;
  theme(legend.position = &quot;top&quot;)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<pre class="r"><code>ggsave(&quot;figs/hsurvival.png&quot;, dpi = 600, height = 4.5, width = 10)</code></pre>
<pre class="r"><code>time_to_outbreak =outbreak %&gt;%
  # separate(season, sep =&quot;,&quot;, remove = T, into = c(&quot;season&quot;, &quot;state&quot;)) %&gt;%
  separate(season, sep =&quot;=&quot;, remove = T, into = c(&quot;trash&quot;, &quot;season&quot;)) %&gt;% 
  # separate(state, sep =&quot;=&quot;, remove = T, into = c(&quot;trash&quot;, &quot;state&quot;)) %&gt;% 
  mutate(`time_outbreak` = `*rmean`) %&gt;% 
  dplyr::select(-trash, -`0.95LCL`, -`0.95UCL`, - `*se(rmean)`, -`*rmean`)</code></pre>
<pre class="r"><code>outbreak %&gt;%
  # separate(season, sep =&quot;,&quot;, remove = T, into = c(&quot;season&quot;, &quot;state&quot;)) %&gt;%
  separate(season, sep =&quot;=&quot;, remove = T, into = c(&quot;trash&quot;, &quot;season&quot;)) %&gt;% 
  # separate(state, sep =&quot;=&quot;, remove = T, into = c(&quot;trash&quot;, &quot;state&quot;)) %&gt;% 
  # group_by(state) %&gt;%
  summarise(mean_T = mean(`*rmean`),
            mean_se = mean(`*se(rmean)`),
            min_T = min(`*rmean`),
            max_T = max (`*rmean`))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mean_T"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["mean_se"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["min_T"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["max_T"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"89.60891","2":"1.991809","3":"63.47934","4":"111.5837"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="cox-proportional-hazards-model" class="section level3">
<h3>Cox Proportional Hazards Model</h3>
<pre class="r"><code>cox = coxph(Surv(days, count) ~ season, data = sbr_rep_count )
summary(cox)</code></pre>
<pre><code>## Call:
## coxph(formula = Surv(days, count) ~ season, data = sbr_rep_count)
## 
##   n= 2441, number of events= 2441 
## 
##                coef exp(coef) se(coef)      z Pr(&gt;|z|)    
## season2006 -0.12141   0.88567  0.09897 -1.227 0.219899    
## season2007  0.31294   1.36744  0.10168  3.078 0.002086 ** 
## season2008 -0.50781   0.60181  0.10274 -4.943 7.70e-07 ***
## season2009 -0.90166   0.40590  0.10254 -8.793  &lt; 2e-16 ***
## season2010  0.23304   1.26243  0.10270  2.269 0.023266 *  
## season2011  0.29799   1.34715  0.10569  2.819 0.004811 ** 
## season2012 -0.14659   0.86365  0.20553 -0.713 0.475690    
## season2013  0.40698   1.50227  0.12140  3.352 0.000801 ***
## season2014  0.34412   1.41075  0.14798  2.325 0.020046 *  
## season2015 -0.03134   0.96915  0.10446 -0.300 0.764186    
## season2016  1.64509   5.18146  0.11888 13.839  &lt; 2e-16 ***
## season2017  0.17354   1.18951  0.11509  1.508 0.131596    
## season2018 -0.01747   0.98268  0.10662 -0.164 0.869831    
## season2019  0.94645   2.57656  0.11745  8.058 7.73e-16 ***
## season2020 -0.18856   0.82815  0.13954 -1.351 0.176621    
## season2021 -0.20543   0.81430  0.11584 -1.773 0.076174 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##            exp(coef) exp(-coef) lower .95 upper .95
## season2006    0.8857     1.1291    0.7295    1.0753
## season2007    1.3674     0.7313    1.1204    1.6690
## season2008    0.6018     1.6616    0.4921    0.7361
## season2009    0.4059     2.4637    0.3320    0.4962
## season2010    1.2624     0.7921    1.0323    1.5439
## season2011    1.3472     0.7423    1.0951    1.6572
## season2012    0.8636     1.1579    0.5773    1.2921
## season2013    1.5023     0.6657    1.1842    1.9058
## season2014    1.4108     0.7088    1.0556    1.8854
## season2015    0.9691     1.0318    0.7897    1.1893
## season2016    5.1815     0.1930    4.1045    6.5409
## season2017    1.1895     0.8407    0.9493    1.4905
## season2018    0.9827     1.0176    0.7974    1.2111
## season2019    2.5766     0.3881    2.0468    3.2435
## season2020    0.8282     1.2075    0.6300    1.0887
## season2021    0.8143     1.2280    0.6489    1.0219
## 
## Concordance= 0.644  (se = 0.006 )
## Likelihood ratio test= 557.7  on 16 df,   p=&lt;2e-16
## Wald test            = 609.4  on 16 df,   p=&lt;2e-16
## Score (logrank) test = 709.5  on 16 df,   p=&lt;2e-16</code></pre>
<pre class="r"><code>HR = as.data.frame(summary(cox)$conf.int[1:16, c(&quot;exp(coef)&quot;,&quot;lower .95&quot;,&quot;upper .95&quot;)])
HR = rownames_to_column(HR, var = &quot;season&quot;)

hr_risk = HR %&gt;% 
  separate(season, sep =&quot;season&quot;, remove = T, into = c(&quot;trash&quot;, &quot;season&quot;)) %&gt;% 
  filter(!is.na(season)) %&gt;% 
  ggplot(aes(season, log(`exp(coef)`))) + 
  geom_hline(yintercept = 0, size = 1, color = &quot;gray40&quot;,linetype =2, label = &quot;2005&quot;)+
  geom_point(size = 2, position = position_dodge(width = .5),
             color = &quot;steelblue&quot;)+
  geom_errorbar(aes(ymin = log(`lower .95`), ymax = log(`upper .95`)),
                position = position_dodge(width = .5), size =1, width =0,
                color = &quot;steelblue&quot;)+ 
  
  geom_text(aes(12,0,label = &quot;2005&quot;, vjust = -0.5,angle = 90), size =3.5,color = &quot;gray40&quot;)+
  coord_flip()+
  labs(x = &quot;Crop season&quot;, y = &quot;Hazard risk&quot;, color = &quot;State&quot;)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: label</code></pre>
<pre class="r"><code># ggsave(&quot;figs/hazard_risk.png&quot;, dpi = 600, height = 6, width = 4)</code></pre>
<pre class="r"><code>out_day+hr_risk+
  plot_annotation(tag_levels = &quot;A&quot;)&amp;
  theme_half_open()</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
</div>
</div>
<div id="bayesian" class="section level2">
<h2>Bayesian</h2>
<div id="loading-shapefiles" class="section level3">
<h3>Loading shapefiles</h3>
<pre class="r"><code>shape_sul= readOGR(&quot;shapefiles/BR_MUN1997_S_region&quot;,&quot;BR_MUN1997_S_region&quot; )</code></pre>
<pre><code>## Warning in OGRSpatialRef(dsn, layer, morphFromESRI = morphFromESRI, dumpSRS =
## dumpSRS, : Discarded ellps South_American_1969 in CRS definition: +proj=longlat
## +a=6378160 +rf=298.249997276159 +no_defs</code></pre>
<pre><code>## Warning in OGRSpatialRef(dsn, layer, morphFromESRI = morphFromESRI, dumpSRS =
## dumpSRS, : Discarded datum D_SA1969 in CRS definition: +proj=longlat +a=6378160
## +rf=298.249997276159 +no_defs</code></pre>
<pre><code>## Warning in showSRID(wkt2, &quot;PROJ&quot;): Discarded ellps South_American_1969 in CRS
## definition: +proj=longlat +a=6378160 +rf=298.249997276159 +no_defs</code></pre>
<pre><code>## Warning in showSRID(wkt2, &quot;PROJ&quot;): Discarded datum D_SA1969 in CRS definition</code></pre>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;G:\Meu Drive\Kaique-Alves\SBR-soybean\02 - SBR_spatiotemporal-description\Data_analysis\shapefiles\BR_MUN1997_S_region&quot;, layer: &quot;BR_MUN1997_S_region&quot;
## with 1159 features
## It has 19 fields</code></pre>
<pre class="r"><code>shape_sul@data$id = rownames(shape_sul@data)
sul_points = fortify(shape_sul)</code></pre>
<pre><code>## Regions defined for each Polygons</code></pre>
<pre class="r"><code>sul_df =plyr::join(sul_points, shape_sul@data, by=&quot;id&quot;)</code></pre>
<pre class="r"><code>IDs = unique(sul_df$id)
location2 = numeric(length(sbr_rep_count$lat))
for(i in 1:length(IDs)){
 qqq = sul_df %&gt;%
  filter(id == IDs[i])

city = as.character(unique(qqq$MUNIC_PIO))

 for(j in 1:length(sbr_rep_count$lat)){
    pip = point.in.polygon(point.x = sbr_rep_count$lon[j],
                           point.y = sbr_rep_count$lat[j],
                           pol.x = qqq$long,
                           pol.y = qqq$lat)

      if(pip &gt; 0){location2[j] = city}

 }
}
sbr_rep_count_new = sbr_rep_count %&gt;%
  mutate(MUNIC_PIO = location2)</code></pre>
</div>
<div id="data-1" class="section level3">
<h3>Data</h3>
<pre class="r"><code>months = c(&quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;, &quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;,&quot;Apr&quot;,&quot;May&quot;)
inla_data_geral = sbr_rep_count %&gt;%
  mutate(month = factor(month, levels = months)) %&gt;% 
  full_join(sbr_rep_count_new %&gt;% mutate(month = factor(month, levels = months))) %&gt;% 
  full_join(data.frame(MUNIC_PIO = unique(sbr_rep_count_new$MUNIC_PIO)) %&gt;% 
  mutate(S = 1:length(MUNIC_PIO)))</code></pre>
<pre><code>## Joining, by = c(&quot;start_date&quot;, &quot;season&quot;, &quot;state&quot;, &quot;location&quot;, &quot;date_report&quot;, &quot;Phen_state&quot;, &quot;month&quot;, &quot;days&quot;, &quot;lat&quot;, &quot;lon&quot;, &quot;Phen_state_int&quot;, &quot;start_season&quot;, &quot;days_sep15&quot;, &quot;week&quot;, &quot;region&quot;, &quot;lat_utm&quot;, &quot;lon_utm&quot;, &quot;count&quot;)</code></pre>
<pre><code>## Joining, by = &quot;MUNIC_PIO&quot;</code></pre>
</div>
<div id="model-iid-unestructured" class="section level3">
<h3>Model iid unestructured</h3>
<pre class="r"><code>form_surv_pr = inla.surv(days, count) ~ 1 + season +
  f(S, model = &quot;iid&quot;)


surv_fit_pr.inla = inla(form_surv_pr,
                        data = inla_data_geral,
                        family = &quot;coxph&quot;,
                        control.hazard = list(hyper = list(prec = list(param = c(0.001, 0.001)))),
                        control.compute=list(dic=TRUE,
                                             cpo=TRUE,
                                             waic=TRUE,
                                             openmp.strategy=&quot;huge&quot;))
# summary(surv_fit_pr.inla)
# surv_fit_pr.inla &lt;- inla.rerun(surv_fit_pr.inla)
saveRDS(surv_fit_pr.inla, &quot;./models/model_seasons_idd.RDS&quot;)</code></pre>
<pre class="r"><code>surv_fit_pr.inla = readRDS(&quot;./models/model_seasons_idd.RDS&quot;)
summary(surv_fit_pr.inla)</code></pre>
<pre><code>## 
## Call:
##    c(&quot;inla(formula = cph$formula, family = cph$family, contrasts = 
##    contrasts, &quot;, &quot; data = c(as.list(cph$data), cph$data.list), quantiles = 
##    quantiles, &quot;, &quot; E = cph$E, offset = offset, scale = scale, weights = 
##    weights, &quot;, &quot; Ntrials = NULL, strata = NULL, verbose = verbose, lincomb 
##    = lincomb, &quot;, &quot; control.compute = control.compute, control.predictor = 
##    control.predictor, &quot;, &quot; control.family = control.family, control.inla = 
##    control.inla, &quot;, &quot; control.results = control.results, control.fixed = 
##    control.fixed, &quot;, &quot; control.mode = control.mode, control.expert = 
##    control.expert, &quot;, &quot; control.hazard = control.hazard, control.lincomb = 
##    control.lincomb, &quot;, &quot; control.update = control.update, only.hyperparam 
##    = only.hyperparam, &quot;, &quot; inla.call = inla.call, inla.arg = inla.arg, 
##    num.threads = num.threads, &quot;, &quot; blas.num.threads = blas.num.threads, 
##    keep = keep, working.directory = working.directory, &quot;, &quot; silent = 
##    silent, debug = debug)&quot;) 
## Time used:
##     Pre = 0.615, Running = 445, Post = 1.11, Total = 447 
## Fixed effects:
##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld
## (Intercept) -3.912 0.115     -4.143   -3.911     -3.689 -3.908   0
## season2006  -0.129 0.104     -0.333   -0.129      0.076 -0.129   0
## season2007   0.268 0.107      0.058    0.268      0.478  0.268   0
## season2008  -0.562 0.108     -0.775   -0.561     -0.350 -0.561   0
## season2009  -0.966 0.108     -1.179   -0.966     -0.754 -0.966   0
## season2010   0.311 0.110      0.094    0.310      0.527  0.310   0
## season2011   0.289 0.111      0.071    0.289      0.506  0.290   0
## season2012  -0.235 0.218     -0.679   -0.229      0.177 -0.218   0
## season2013   0.382 0.128      0.128    0.383      0.631  0.384   0
## season2014   0.285 0.156     -0.027    0.287      0.585  0.291   0
## season2015  -0.019 0.109     -0.234   -0.019      0.195 -0.019   0
## season2016   1.608 0.125      1.362    1.608      1.851  1.609   0
## season2017   0.168 0.120     -0.070    0.168      0.402  0.169   0
## season2018  -0.037 0.112     -0.258   -0.037      0.181 -0.037   0
## season2019   0.943 0.124      0.699    0.944      1.185  0.945   0
## season2020  -0.257 0.146     -0.548   -0.255      0.025 -0.252   0
## season2021  -0.222 0.121     -0.461   -0.221      0.014 -0.220   0
## 
## Random effects:
##   Name     Model
##     S IID model
##    baseline.hazard RW1 model
## 
## Model hyperparameters:
##                                mean    sd 0.025quant 0.5quant 0.975quant  mode
## Precision for S               12.48  3.33       7.52    11.93      20.46 10.89
## Precision for baseline.hazard 32.52 12.12      14.19    30.79      61.21 27.36
## 
## Expected number of effective parameters(stdev): 160.94(24.48)
## Number of equivalent replicates : 115.96 
## 
## Deviance Information Criterion (DIC) ...............: 14731.50
## Deviance Information Criterion (DIC, saturated) ....: 9849.49
## Effective number of parameters .....................: 161.23
## 
## Watanabe-Akaike information criterion (WAIC) ...: 14732.41
## Effective number of parameters .................: 158.53
## 
## Marginal log-Likelihood:  -7471.32 
## CPO and PIT are computed
## 
## Posterior marginals for the linear predictor and
##  the fitted values are computed</code></pre>
</div>
<div id="plot-effect" class="section level3">
<h3>Plot effect</h3>
<pre class="r"><code>surv_fit_pr.inla$summary.fixed %&gt;% 
  rownames_to_column(&quot;season&quot;) %&gt;%
  filter(season != &quot;(Intercept)&quot;) %&gt;%
  separate(season, into = c(&quot;t&quot;, &quot;season&quot;), sep = &quot;on&quot;) %&gt;%
  ggplot(aes(mean,season))+
  geom_vline(xintercept = 0, linetype = 2, color = &quot;gray&quot;)+
  geom_point(size =2 )+
  geom_errorbar(aes(xmin = `0.025quant`, xmax = `0.975quant`),
                width = 0)+
  theme(#legend.position = &quot;none&quot;,
        panel.background = element_blank(),
        panel.grid = element_blank(),
        panel.border = element_blank(),
        axis.line.x = element_line(color = &quot;black&quot;),
        axis.line.y = element_line(color = &quot;black&quot;),
        axis.text.x = element_text(angle = 0)) </code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
</div>
</div>
<div id="neighbour-by-distance" class="section level2">
<h2>Neighbour by distance</h2>
<pre class="r"><code>sul_locations = unique(sbr_rep_count_new$MUNIC_PIO)
shape_sul_sub = subset(shape_sul, shape_sul$MUNIC_PIO%in%sul_locations )

coords_pr = coords &lt;- coordinates(shape_sul_sub)
IDs_pr &lt;- row.names(as(shape_sul_sub, &quot;data.frame&quot;))

long = coords_pr[,1]
lat = coords_pr[,2]
xy &lt;- data.frame(ID = 1:(length(lat)), long, lat)
coordinates(xy) &lt;- c(&quot;long&quot;, &quot;lat&quot;)
proj4string(xy) &lt;- CRS(&quot;+init=epsg:4326&quot;)
res &lt;- spTransform(xy, CRS(&quot;+proj=utm +zone=22 +south ellps=WGS84&quot;))</code></pre>
<pre><code>## Warning in showSRID(uprojargs, format = &quot;PROJ&quot;, multiline = &quot;NO&quot;): Discarded
## datum Unknown based on WGS84 ellipsoid in CRS definition</code></pre>
<pre class="r"><code>coords_grid = as.data.frame(res)
coords2 = as.matrix(coords_grid[,2:3])
colnames(coords2) &lt;- c(&quot;x1&quot;,&quot;x2&quot;)</code></pre>
<pre class="r"><code>u &lt;- 0.2/0.31
alpha &lt;- 0.01
phi.u &lt;- 0.5
phi.alpha &lt;- 2/3</code></pre>
<div id="km" class="section level4">
<h4>200 km</h4>
<pre class="r"><code>dnear_dist_200 = dnearneigh(coords2, 0,200000, row.names=IDs_pr)

nb2INLA(&quot;./models/grid200.graph&quot;,dnear_dist_200)
W.pr_dist200 = inla.read.graph(&quot;./models/grid200.graph&quot;)
plot(shape_sul_sub)
plot(dnear_dist_200,coordinates(shape_sul_sub), add = T)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-109-1.png" width="672" /></p>
<pre class="r"><code>form_surv_spt.200 = inla.surv(days, count) ~ 1 + season + 
  f(S, model = &quot;bym2&quot;, graph = W.pr_dist200,
    hyper = list(prec = list(param = c(0.001, 0.001)), 
                 phi = list(prior = &quot;pc&quot;, 
                            param = c(phi.u, phi.alpha),
                            initial = -3)))


surv_fit_200 = inla(form_surv_spt.200,
                   data = inla_data_geral,
                   family = &quot;coxph&quot;,
                   control.hazard = list(hyper = list(prec = list(param = c(0.001, 0.001)))),
                   control.compute=list(dic=TRUE,
                                        cpo=TRUE,
                                        waic=TRUE,
                                        openmp.strategy=&quot;huge&quot;),
                   verbose=F)

saveRDS(surv_fit_200, &quot;./models/model_seasons_200.RDS&quot;)</code></pre>
<pre class="r"><code>surv_fit_200 = readRDS(&quot;./models/model_seasons_200.RDS&quot;)
summary(surv_fit_200)</code></pre>
<pre><code>## 
## Call:
##    c(&quot;inla(formula = cph$formula, family = cph$family, contrasts = 
##    contrasts, &quot;, &quot; data = c(as.list(cph$data), cph$data.list), quantiles = 
##    quantiles, &quot;, &quot; E = cph$E, offset = offset, scale = scale, weights = 
##    weights, &quot;, &quot; Ntrials = NULL, strata = NULL, verbose = verbose, lincomb 
##    = lincomb, &quot;, &quot; control.compute = control.compute, control.predictor = 
##    control.predictor, &quot;, &quot; control.family = control.family, control.inla = 
##    control.inla, &quot;, &quot; control.results = control.results, control.fixed = 
##    control.fixed, &quot;, &quot; control.mode = control.mode, control.expert = 
##    control.expert, &quot;, &quot; control.hazard = control.hazard, control.lincomb = 
##    control.lincomb, &quot;, &quot; control.update = control.update, only.hyperparam 
##    = only.hyperparam, &quot;, &quot; inla.call = inla.call, inla.arg = inla.arg, 
##    num.threads = num.threads, &quot;, &quot; blas.num.threads = blas.num.threads, 
##    keep = keep, working.directory = working.directory, &quot;, &quot; silent = 
##    silent, debug = debug)&quot;) 
## Time used:
##     Pre = 30, Running = 168, Post = 0.805, Total = 199 
## Fixed effects:
##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld
## (Intercept) -3.988 0.109     -4.206   -3.986     -3.779 -3.983   0
## season2006  -0.117 0.099     -0.311   -0.117      0.077 -0.117   0
## season2007   0.314 0.102      0.114    0.314      0.513  0.314   0
## season2008  -0.509 0.103     -0.711   -0.509     -0.308 -0.509   0
## season2009  -0.899 0.102     -1.100   -0.899     -0.698 -0.899   0
## season2010   0.230 0.103      0.028    0.230      0.431  0.230   0
## season2011   0.294 0.106      0.086    0.294      0.501  0.294   0
## season2012  -0.137 0.205     -0.557   -0.130      0.249 -0.118   0
## season2013   0.402 0.121      0.161    0.402      0.638  0.404   0
## season2014   0.336 0.148      0.039    0.338      0.620  0.343   0
## season2015  -0.018 0.104     -0.223   -0.018      0.187 -0.018   0
## season2016   1.603 0.119      1.368    1.603      1.834  1.605   0
## season2017   0.172 0.115     -0.055    0.173      0.397  0.174   0
## season2018  -0.019 0.107     -0.229   -0.019      0.189 -0.019   0
## season2019   0.929 0.117      0.696    0.929      1.158  0.931   0
## season2020  -0.185 0.140     -0.464   -0.183      0.084 -0.180   0
## season2021  -0.202 0.116     -0.431   -0.201      0.024 -0.200   0
## 
## Random effects:
##   Name     Model
##     S BYM2 model
##    baseline.hazard RW1 model
## 
## Model hyperparameters:
##                                   mean       sd 0.025quant 0.5quant 0.975quant
## Precision for S               2.01e+09 5.61e+10   4.02e+06 1.07e+08   1.13e+10
## Phi for S                     2.82e-01 2.49e-01   9.00e-03 2.01e-01   8.68e-01
## Precision for baseline.hazard 3.43e+01 1.28e+01   1.49e+01 3.24e+01   6.46e+01
##                                   mode
## Precision for S               7.41e+06
## Phi for S                     1.60e-02
## Precision for baseline.hazard 2.88e+01
## 
## Expected number of effective parameters(stdev): 29.10(0.435)
## Number of equivalent replicates : 641.25 
## 
## Deviance Information Criterion (DIC) ...............: 14792.22
## Deviance Information Criterion (DIC, saturated) ....: 9910.22
## Effective number of parameters .....................: 29.03
## 
## Watanabe-Akaike information criterion (WAIC) ...: 14791.24
## Effective number of parameters .................: 27.81
## 
## Marginal log-Likelihood:  -6909.82 
## CPO and PIT are computed
## 
## Posterior marginals for the linear predictor and
##  the fitted values are computed</code></pre>
<pre class="r"><code># inla.mar</code></pre>
</div>
<div id="plot-effect-1" class="section level3">
<h3>Plot effect</h3>
<pre class="r"><code>surv_fit_200$summary.fixed %&gt;% 
  rownames_to_column(&quot;season&quot;) %&gt;%
  filter(season != &quot;(Intercept)&quot;) %&gt;%
  separate(season, into = c(&quot;t&quot;, &quot;season&quot;), sep = &quot;on&quot;) %&gt;% 
  mutate(model = &quot;Structured&quot;) %&gt;% 
  full_join(

surv_fit_pr.inla$summary.fixed %&gt;% 
  rownames_to_column(&quot;season&quot;) %&gt;%
  filter(season != &quot;(Intercept)&quot;) %&gt;%
  separate(season, into = c(&quot;t&quot;, &quot;season&quot;), sep = &quot;on&quot;) %&gt;% 
  mutate(model = &quot;Unstructured&quot;)
)%&gt;%
  full_join(ensodata2) %&gt;% 
  filter(season != &quot;2005&quot;) %&gt;% 
  ggplot(aes(mean,season, color = enso, linetype = model))+
  geom_vline(xintercept = 0, linetype = 2, color = &quot;gray&quot;)+
  geom_point(size =2, position = position_dodge(width = -0.4))+
  geom_errorbar(aes(xmin = `0.025quant`, xmax = `0.975quant`),
                position = position_dodge(width = -0.4),
                width = 0)+
  theme(#legend.position = &quot;none&quot;,
        panel.background = element_blank(),
        panel.grid = element_blank(),
        panel.border = element_blank(),
        axis.line.x = element_line(color = &quot;black&quot;),
        axis.line.y = element_line(color = &quot;black&quot;),
        axis.text.x = element_text(angle = 0))+
  scale_color_colorblind()+
  scale_alpha_manual(values = c(0.5,1))+
  labs(x = &quot;Effect&quot;,
       y = &quot;Crop season&quot;,
       color = &quot;ENSO phase&quot;,
       linetype =  &quot;Model&quot;)</code></pre>
<pre><code>## Joining, by = c(&quot;t&quot;, &quot;season&quot;, &quot;mean&quot;, &quot;sd&quot;, &quot;0.025quant&quot;, &quot;0.5quant&quot;, &quot;0.975quant&quot;, &quot;mode&quot;, &quot;kld&quot;, &quot;model&quot;)</code></pre>
<pre><code>## Joining, by = &quot;season&quot;</code></pre>
<pre><code>## Warning: position_dodge requires non-overlapping x intervals</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
<pre class="r"><code>ggsave(&quot;figs/bayes_hazard_season.png&quot;, dpi = 600, height = 5, width = 4)</code></pre>
<pre><code>## Warning: position_dodge requires non-overlapping x intervals</code></pre>
</div>
</div>
<div id="effect-of-enso" class="section level2">
<h2>Effect of ENSO</h2>
<pre class="r"><code>inla_data_enso = inla_data_geral %&gt;% 
  full_join(ensodata2) %&gt;% 
  mutate(enso = factor(enso, c(&quot;Neutral&quot;,&quot;El Niño&quot;, &quot;La Niña&quot;)))</code></pre>
<pre><code>## Joining, by = &quot;season&quot;</code></pre>
<div id="survival" class="section level4">
<h4>Survival</h4>
<div id="iid-seasons" class="section level5">
<h5>iid seasons</h5>
<pre class="r"><code>form_surv_enso1 = inla.surv(days, count) ~ 1 + enso + 
  f(season, model = &quot;iid&quot;, hyper = list(prec = list(param = c(0.001,0.001))))+
  f(S, model = &quot;bym2&quot;, graph = W.pr_dist200,
    hyper = list(prec = list(param = c(0.001, 0.001)), 
                 phi = list(prior = &quot;pc&quot;, 
                            param = c(phi.u, phi.alpha),
                            initial = -3)))


surv_fit_enso1 = inla(form_surv_enso1,
                        data = inla_data_enso,
                        family = &quot;coxph&quot;,
                      control.hazard = list(hyper = list(prec = list(param = c(0.001, 0.001)))),
                        control.compute=list(dic=TRUE,
                                             cpo=TRUE,
                                             waic=TRUE,
                                             openmp.strategy=&quot;huge&quot;))
# summary(surv_fit_pr.inla)
# surv_fit_pr.inla &lt;- inla.rerun(surv_fit_pr.inla)
saveRDS(surv_fit_enso1, &quot;./models/model_enso1.RDS&quot;)</code></pre>
<pre class="r"><code>surv_fit_enso1 = readRDS(&quot;./models/model_enso1.RDS&quot;)
summary(surv_fit_enso1)</code></pre>
<pre><code>## 
## Call:
##    c(&quot;inla(formula = cph$formula, family = cph$family, contrasts = 
##    contrasts, &quot;, &quot; data = c(as.list(cph$data), cph$data.list), quantiles = 
##    quantiles, &quot;, &quot; E = cph$E, offset = offset, scale = scale, weights = 
##    weights, &quot;, &quot; Ntrials = NULL, strata = NULL, verbose = verbose, lincomb 
##    = lincomb, &quot;, &quot; control.compute = control.compute, control.predictor = 
##    control.predictor, &quot;, &quot; control.family = control.family, control.inla = 
##    control.inla, &quot;, &quot; control.results = control.results, control.fixed = 
##    control.fixed, &quot;, &quot; control.mode = control.mode, control.expert = 
##    control.expert, &quot;, &quot; control.hazard = control.hazard, control.lincomb = 
##    control.lincomb, &quot;, &quot; control.update = control.update, only.hyperparam 
##    = only.hyperparam, &quot;, &quot; inla.call = inla.call, inla.arg = inla.arg, 
##    num.threads = num.threads, &quot;, &quot; blas.num.threads = blas.num.threads, 
##    keep = keep, working.directory = working.directory, &quot;, &quot; silent = 
##    silent, debug = debug)&quot;) 
## Time used:
##     Pre = 29.9, Running = 305, Post = 0.724, Total = 336 
## Fixed effects:
##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld
## (Intercept) -4.037 0.174     -4.382   -4.037     -3.693 -4.036   0
## ensoEl Niño  0.803 0.278      0.251    0.803      1.355  0.802   0
## ensoLa Niña -0.100 0.280     -0.658   -0.099      0.456 -0.099   0
## 
## Random effects:
##   Name     Model
##     season IID model
##    S BYM2 model
##    baseline.hazard RW1 model
## 
## Model hyperparameters:
##                                   mean       sd 0.025quant 0.5quant 0.975quant
## Precision for season          5.43e+00 2.17e+00   2.24e+00 5.09e+00   1.06e+01
## Precision for S               2.12e+09 6.06e+10   4.19e+06 1.11e+08   1.20e+10
## Phi for S                     2.85e-01 2.50e-01   9.00e-03 2.05e-01   8.70e-01
## Precision for baseline.hazard 3.43e+01 1.29e+01   1.50e+01 3.23e+01   6.51e+01
##                                   mode
## Precision for season          4.43e+00
## Precision for S               7.83e+06
## Phi for S                     1.50e-02
## Precision for baseline.hazard 2.86e+01
## 
## Expected number of effective parameters(stdev): 28.43(0.494)
## Number of equivalent replicates : 656.50 
## 
## Deviance Information Criterion (DIC) ...............: 14791.72
## Deviance Information Criterion (DIC, saturated) ....: 9909.71
## Effective number of parameters .....................: 28.43
## 
## Watanabe-Akaike information criterion (WAIC) ...: 14790.70
## Effective number of parameters .................: 27.19
## 
## Marginal log-Likelihood:  -6866.30 
## CPO and PIT are computed
## 
## Posterior marginals for the linear predictor and
##  the fitted values are computed</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_enso1$marginals.fixed$`(Intercept)`)</code></pre>
<pre><code>##                  low      high
## level:0.95 -4.381905 -3.694154</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_enso1$marginals.fixed$`ensoEl Niño`)</code></pre>
<pre><code>##                  low     high
## level:0.95 0.2509854 1.352712</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_enso1$marginals.fixed$`ensoLa Niña`)</code></pre>
<pre><code>##                   low      high
## level:0.95 -0.6576375 0.4544466</code></pre>
<pre class="r"><code>round(surv_fit_enso1$summary.hyperpar, 4)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["mean"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["0.025quant"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["0.5quant"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["0.975quant"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["mode"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"5.432500e+00","2":"2.170700e+00","3":"2.2401","4":"5.095000e+00","5":"1.06465e+01","6":"4.43130e+00","_rn_":"Precision for season"},{"1":"2.120793e+09","2":"6.062086e+10","3":"4186244.0300","4":"1.108628e+08","5":"1.19960e+10","6":"7.82723e+06","_rn_":"Precision for S"},{"1":"2.845000e-01","2":"2.500000e-01","3":"0.0088","4":"2.051000e-01","5":"8.70400e-01","6":"1.46000e-02","_rn_":"Phi for S"},{"1":"3.425360e+01","2":"1.293090e+01","3":"14.9831","4":"3.231370e+01","5":"6.51062e+01","6":"2.85507e+01","_rn_":"Precision for baseline.hazard"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_enso1$marginals.hyperpar$`Precision for season`)</code></pre>
<pre><code>##                 low     high
## level:0.95 1.805355 9.694313</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_enso1$marginals.hyperpar$`Precision for S`)</code></pre>
<pre><code>##                 low        high
## level:0.95 16023.26 64608269219</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_enso1$marginals.hyperpar$`Phi for S`)</code></pre>
<pre><code>##                     low      high
## level:0.95 6.971666e-08 0.8037537</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_enso1$marginals.hyperpar$`Precision for baseline.hazard`)</code></pre>
<pre><code>##               low     high
## level:0.95 12.402 59.72263</code></pre>
<div id="plot-effect-2" class="section level6">
<h6>Plot effect</h6>
<pre class="r"><code>bind_rows(
as.data.frame(surv_fit_enso1$marginals.fixed$`ensoEl Niño`) %&gt;% 
  mutate(ENSO = &quot;El Niño&quot;),
as.data.frame(surv_fit_enso1$marginals.fixed$`ensoLa Niña`)%&gt;% 
  mutate(ENSO = &quot;La Niña&quot;)
) %&gt;% 

ggplot() +
  geom_vline(xintercept = 0, linetype = 2)+
  geom_area(aes(x, y, fill = ENSO), alpha = 0.5) + 
  facet_wrap(~ENSO,
             nrow = 2)+
  labs(x = &quot;Hazard risk&quot;,
       y = &quot;Density&quot;)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-119-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="fitting-oni" class="section level4">
<h4>Fitting ONI</h4>
<div id="ond" class="section level5">
<h5>OND</h5>
<pre class="r"><code>form_surv_ONI1 = inla.surv(days, count) ~ 1 + OND + 
  f(season, model = &quot;iid&quot;, hyper = list(prec = list(param = c(0.001,0.001))))+
  f(S, model = &quot;bym2&quot;, graph = W.pr_dist200,
    hyper = list(prec = list(param = c(0.001, 0.001)), 
                 phi = list(prior = &quot;pc&quot;, 
                            param = c(phi.u, phi.alpha),
                            initial = -3)))


surv_fit_ONI1 = inla(form_surv_ONI1,
                        data = inla_data_enso,
                        family = &quot;coxph&quot;,
                      control.hazard = list(hyper = list(prec = list(param = c(0.001, 0.001)))),
                        control.compute=list(dic=TRUE,
                                             cpo=TRUE,
                                             waic=TRUE,
                                             openmp.strategy=&quot;huge&quot;))
# summary(surv_fit_pr.inla)
saveRDS(surv_fit_ONI1, &quot;./models/model_oni1.RDS&quot;)</code></pre>
<pre class="r"><code>surv_fit_ONI1 = readRDS(&quot;./models/model_oni1.RDS&quot;)
summary(surv_fit_ONI1)</code></pre>
<pre><code>## 
## Call:
##    c(&quot;inla(formula = cph$formula, family = cph$family, contrasts = 
##    contrasts, &quot;, &quot; data = c(as.list(cph$data), cph$data.list), quantiles = 
##    quantiles, &quot;, &quot; E = cph$E, offset = offset, scale = scale, weights = 
##    weights, &quot;, &quot; Ntrials = NULL, strata = NULL, verbose = verbose, lincomb 
##    = lincomb, &quot;, &quot; control.compute = control.compute, control.predictor = 
##    control.predictor, &quot;, &quot; control.family = control.family, control.inla = 
##    control.inla, &quot;, &quot; control.results = control.results, control.fixed = 
##    control.fixed, &quot;, &quot; control.mode = control.mode, control.expert = 
##    control.expert, &quot;, &quot; control.hazard = control.hazard, control.lincomb = 
##    control.lincomb, &quot;, &quot; control.update = control.update, only.hyperparam 
##    = only.hyperparam, &quot;, &quot; inla.call = inla.call, inla.arg = inla.arg, 
##    num.threads = num.threads, &quot;, &quot; blas.num.threads = blas.num.threads, 
##    keep = keep, working.directory = working.directory, &quot;, &quot; silent = 
##    silent, debug = debug)&quot;) 
## Time used:
##     Pre = 29.6, Running = 306, Post = 0.862, Total = 336 
## Fixed effects:
##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld
## (Intercept) -3.857 0.135     -4.125   -3.857     -3.593 -3.855   0
## OND          0.322 0.097      0.129    0.322      0.514  0.321   0
## 
## Random effects:
##   Name     Model
##     season IID model
##    S BYM2 model
##    baseline.hazard RW1 model
## 
## Model hyperparameters:
##                                   mean       sd 0.025quant 0.5quant 0.975quant
## Precision for season          5.89e+00 2.27e+00   2.49e+00 5.56e+00   1.13e+01
## Precision for S               1.89e+09 4.79e+10   3.95e+06 1.07e+08   1.08e+10
## Phi for S                     2.81e-01 2.49e-01   9.00e-03 2.01e-01   8.68e-01
## Precision for baseline.hazard 3.45e+01 1.29e+01   1.49e+01 3.27e+01   6.50e+01
##                                   mode
## Precision for season          4.89e+00
## Precision for S               7.04e+06
## Phi for S                     1.60e-02
## Precision for baseline.hazard 2.90e+01
## 
## Expected number of effective parameters(stdev): 28.28(0.516)
## Number of equivalent replicates : 659.84 
## 
## Deviance Information Criterion (DIC) ...............: 14791.60
## Deviance Information Criterion (DIC, saturated) ....: 9909.60
## Effective number of parameters .....................: 28.32
## 
## Watanabe-Akaike information criterion (WAIC) ...: 14790.58
## Effective number of parameters .................: 27.07
## 
## Marginal log-Likelihood:  -6862.56 
## CPO and PIT are computed
## 
## Posterior marginals for the linear predictor and
##  the fitted values are computed</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.fixed$`(Intercept)`)</code></pre>
<pre><code>##                  low      high
## level:0.95 -4.124198 -3.592892</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.fixed$OND)</code></pre>
<pre><code>##                  low      high
## level:0.95 0.1291425 0.5135768</code></pre>
<pre class="r"><code>round(surv_fit_ONI1$summary.hyperpar, 3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["mean"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["0.025quant"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["0.5quant"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["0.975quant"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["mode"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"5.894000e+00","2":"2.275000e+00","3":"2.494","4":"5.558000e+00","5":"1.131300e+01","6":"4.889","_rn_":"Precision for season"},{"1":"1.885156e+09","2":"4.787629e+10","3":"3949631.842","4":"1.070445e+08","5":"1.079203e+10","6":"7039442.129","_rn_":"Precision for S"},{"1":"2.810000e-01","2":"2.490000e-01","3":"0.009","4":"2.010000e-01","5":"8.680000e-01","6":"0.016","_rn_":"Phi for S"},{"1":"3.449500e+01","2":"1.289800e+01","3":"14.941","4":"3.268800e+01","5":"6.495800e+01","6":"29.041","_rn_":"Precision for baseline.hazard"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.hyperpar$`Precision for season`)</code></pre>
<pre><code>##                 low     high
## level:0.95 2.044801 10.35979</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.hyperpar$`Precision for S`)</code></pre>
<pre><code>##                low        high
## level:0.95 7638.59 38560381792</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.hyperpar$`Phi for S`)</code></pre>
<pre><code>##                     low      high
## level:0.95 1.031507e-07 0.7987937</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.hyperpar$`Precision for baseline.hazard`)</code></pre>
<pre><code>##                 low     high
## level:0.95 12.42816 59.80766</code></pre>
</div>
<div id="mjj" class="section level5">
<h5>MJJ</h5>
<pre class="r"><code>form_surv_ONI2 = inla.surv(days, count) ~ 1 + MJJ +
  f(season, model = &quot;iid&quot;, hyper = list(prec = list(param = c(0.001,0.001))))+
  f(S, model = &quot;bym2&quot;, graph = W.pr_dist200,
    hyper = list(prec = list(param = c(0.001, 0.001)), 
                 phi = list(prior = &quot;pc&quot;, 
                            param = c(phi.u, phi.alpha),
                            initial = -3)))


surv_fit_ONI2 = inla(form_surv_ONI2,
                        data = inla_data_enso,
                        family = &quot;coxph&quot;,
                     control.hazard = list(hyper = list(prec = list(param = c(0.001, 0.001)))),
                        control.compute=list(dic=TRUE,
                                             cpo=TRUE,
                                             waic=TRUE,
                                             openmp.strategy=&quot;huge&quot;))
# summary(surv_fit_pr.inla)
# surv_fit_pr.inla &lt;- inla.rerun(surv_fit_pr.inla)
saveRDS(surv_fit_ONI2, &quot;./models/model_oni2.RDS&quot;)</code></pre>
<pre class="r"><code>surv_fit_ONI2 = readRDS(&quot;./models/model_oni2.RDS&quot;)
summary(surv_fit_ONI2)</code></pre>
<pre><code>## 
## Call:
##    c(&quot;inla(formula = cph$formula, family = cph$family, contrasts = 
##    contrasts, &quot;, &quot; data = c(as.list(cph$data), cph$data.list), quantiles = 
##    quantiles, &quot;, &quot; E = cph$E, offset = offset, scale = scale, weights = 
##    weights, &quot;, &quot; Ntrials = NULL, strata = NULL, verbose = verbose, lincomb 
##    = lincomb, &quot;, &quot; control.compute = control.compute, control.predictor = 
##    control.predictor, &quot;, &quot; control.family = control.family, control.inla = 
##    control.inla, &quot;, &quot; control.results = control.results, control.fixed = 
##    control.fixed, &quot;, &quot; control.mode = control.mode, control.expert = 
##    control.expert, &quot;, &quot; control.hazard = control.hazard, control.lincomb = 
##    control.lincomb, &quot;, &quot; control.update = control.update, only.hyperparam 
##    = only.hyperparam, &quot;, &quot; inla.call = inla.call, inla.arg = inla.arg, 
##    num.threads = num.threads, &quot;, &quot; blas.num.threads = blas.num.threads, 
##    keep = keep, working.directory = working.directory, &quot;, &quot; silent = 
##    silent, debug = debug)&quot;) 
## Time used:
##     Pre = 29.8, Running = 290, Post = 0.766, Total = 321 
## Fixed effects:
##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld
## (Intercept) -3.864 0.142     -4.147   -3.863     -3.584 -3.862   0
## MJJ          0.695 0.257      0.184    0.695      1.206  0.696   0
## 
## Random effects:
##   Name     Model
##     season IID model
##    S BYM2 model
##    baseline.hazard RW1 model
## 
## Model hyperparameters:
##                                   mean       sd 0.025quant 0.5quant 0.975quant
## Precision for season          4.97e+00 1.94e+00   2.13e+00 4.66e+00   9.62e+00
## Precision for S               2.06e+09 5.66e+10   4.10e+06 1.10e+08   1.17e+10
## Phi for S                     2.84e-01 2.50e-01   9.00e-03 2.05e-01   8.71e-01
## Precision for baseline.hazard 3.44e+01 1.29e+01   1.49e+01 3.25e+01   6.48e+01
##                                   mode
## Precision for season          4.08e+00
## Precision for S               7.60e+06
## Phi for S                     1.50e-02
## Precision for baseline.hazard 2.89e+01
## 
## Expected number of effective parameters(stdev): 28.43(0.493)
## Number of equivalent replicates : 656.49 
## 
## Deviance Information Criterion (DIC) ...............: 14791.82
## Deviance Information Criterion (DIC, saturated) ....: 9909.81
## Effective number of parameters .....................: 28.44
## 
## Watanabe-Akaike information criterion (WAIC) ...: 14790.78
## Effective number of parameters .................: 27.18
## 
## Marginal log-Likelihood:  -6862.79 
## CPO and PIT are computed
## 
## Posterior marginals for the linear predictor and
##  the fitted values are computed</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.fixed$`(Intercept)`)</code></pre>
<pre><code>##                 low      high
## level:0.95 -4.14574 -3.584559</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.fixed$MJJ)</code></pre>
<pre><code>##                  low     high
## level:0.95 0.1838507 1.203958</code></pre>
<pre class="r"><code>round(surv_fit_ONI2$summary.hyperpar, 3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["mean"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["0.025quant"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["0.5quant"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["0.975quant"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["mode"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"4.967000e+00","2":"1.938000e+00","3":"2.127","4":"4.6600e+00","5":"9.622000e+00","6":"4.075","_rn_":"Precision for season"},{"1":"2.058361e+09","2":"5.664557e+10","3":"4103480.902","4":"1.1044e+08","5":"1.171751e+10","6":"7601042.123","_rn_":"Precision for S"},{"1":"2.840000e-01","2":"2.500000e-01","3":"0.009","4":"2.0500e-01","5":"8.710000e-01","6":"0.015","_rn_":"Phi for S"},{"1":"3.436400e+01","2":"1.287600e+01","3":"14.898","4":"3.2535e+01","5":"6.484600e+01","6":"28.874","_rn_":"Precision for baseline.hazard"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.hyperpar$`Precision for season`)</code></pre>
<pre><code>##                 low     high
## level:0.95 1.732621 8.785205</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.hyperpar$`Precision for S`)</code></pre>
<pre><code>##                 low        high
## level:0.95 12187.15 56875839900</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.hyperpar$`Phi for S`)</code></pre>
<pre><code>##                    low      high
## level:0.95 6.40098e-08 0.8042425</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.hyperpar$`Precision for baseline.hazard`)</code></pre>
<pre><code>##                 low     high
## level:0.95 12.38649 59.65257</code></pre>
</div>
<div id="jfm" class="section level5">
<h5>JFM</h5>
<pre class="r"><code>form_surv_ONI3 = inla.surv(days, count) ~ 1 + JFM + 
  f(season, model = &quot;iid&quot;, hyper = list(prec = list(param = c(0.001,0.001))))+
  f(S, model = &quot;bym2&quot;, graph = W.pr_dist200,
    hyper = list(prec = list(param = c(0.001, 0.001)), 
                 phi = list(prior = &quot;pc&quot;, 
                            param = c(phi.u, phi.alpha),
                            initial = -3)))


surv_fit_ONI3 = inla(form_surv_ONI3,
                        data = inla_data_enso,
                        family = &quot;coxph&quot;,
                     control.hazard = list(hyper = list(prec = list(param = c(0.001, 0.001)))),
                        control.compute=list(dic=TRUE,
                                             cpo=TRUE,
                                             waic=TRUE,
                                             openmp.strategy=&quot;huge&quot;))
# summary(surv_fit_pr.inla)
# surv_fit_pr.inla &lt;- inla.rerun(surv_fit_pr.inla)
saveRDS(surv_fit_ONI3, &quot;./models/model_oni3.RDS&quot;)</code></pre>
<pre class="r"><code>surv_fit_ONI3 = readRDS(&quot;./models/model_oni3.RDS&quot;)
summary(surv_fit_ONI3)</code></pre>
<pre><code>## 
## Call:
##    c(&quot;inla(formula = cph$formula, family = cph$family, contrasts = 
##    contrasts, &quot;, &quot; data = c(as.list(cph$data), cph$data.list), quantiles = 
##    quantiles, &quot;, &quot; E = cph$E, offset = offset, scale = scale, weights = 
##    weights, &quot;, &quot; Ntrials = NULL, strata = NULL, verbose = verbose, lincomb 
##    = lincomb, &quot;, &quot; control.compute = control.compute, control.predictor = 
##    control.predictor, &quot;, &quot; control.family = control.family, control.inla = 
##    control.inla, &quot;, &quot; control.results = control.results, control.fixed = 
##    control.fixed, &quot;, &quot; control.mode = control.mode, control.expert = 
##    control.expert, &quot;, &quot; control.hazard = control.hazard, control.lincomb = 
##    control.lincomb, &quot;, &quot; control.update = control.update, only.hyperparam 
##    = only.hyperparam, &quot;, &quot; inla.call = inla.call, inla.arg = inla.arg, 
##    num.threads = num.threads, &quot;, &quot; blas.num.threads = blas.num.threads, 
##    keep = keep, working.directory = working.directory, &quot;, &quot; silent = 
##    silent, debug = debug)&quot;) 
## Time used:
##     Pre = 31.5, Running = 296, Post = 0.728, Total = 328 
## Fixed effects:
##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld
## (Intercept) -3.863 0.165     -4.191   -3.862     -3.537 -3.861   0
## JFM          0.076 0.159     -0.239    0.076      0.392  0.076   0
## 
## Random effects:
##   Name     Model
##     season IID model
##    S BYM2 model
##    baseline.hazard RW1 model
## 
## Model hyperparameters:
##                                   mean       sd 0.025quant 0.5quant 0.975quant
## Precision for season          3.27e+00 1.24e+00   1.42e+00 3.09e+00   6.23e+00
## Precision for S               2.05e+09 5.96e+10   4.03e+06 1.06e+08   1.14e+10
## Phi for S                     2.80e-01 2.49e-01   9.00e-03 2.00e-01   8.69e-01
## Precision for baseline.hazard 3.46e+01 1.30e+01   1.51e+01 3.27e+01   6.55e+01
##                                   mode
## Precision for season          2.73e+00
## Precision for S               7.55e+06
## Phi for S                     1.60e-02
## Precision for baseline.hazard 2.89e+01
## 
## Expected number of effective parameters(stdev): 28.64(0.466)
## Number of equivalent replicates : 651.72 
## 
## Deviance Information Criterion (DIC) ...............: 14791.96
## Deviance Information Criterion (DIC, saturated) ....: 9909.95
## Effective number of parameters .....................: 28.64
## 
## Watanabe-Akaike information criterion (WAIC) ...: 14790.91
## Effective number of parameters .................: 27.36
## 
## Marginal log-Likelihood:  -6866.65 
## CPO and PIT are computed
## 
## Posterior marginals for the linear predictor and
##  the fitted values are computed</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.fixed$`(Intercept)`)</code></pre>
<pre><code>##                  low      high
## level:0.95 -4.190021 -3.537689</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.fixed$JFM)</code></pre>
<pre><code>##                   low      high
## level:0.95 -0.2389754 0.3903637</code></pre>
<pre class="r"><code>round(surv_fit_ONI3$summary.hyperpar, 3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["mean"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["0.025quant"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["0.5quant"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["0.975quant"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["mode"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"3.272000e+00","2":"1.240000e+00","3":"1.421","4":"3.086000e+00","5":"6.228000e+00","6":"2.725","_rn_":"Precision for season"},{"1":"2.050301e+09","2":"5.964157e+10","3":"4028896.879","4":"1.057961e+08","5":"1.144542e+10","6":"7553887.754","_rn_":"Precision for S"},{"1":"2.800000e-01","2":"2.490000e-01","3":"0.009","4":"2.000000e-01","5":"8.690000e-01","6":"0.016","_rn_":"Phi for S"},{"1":"3.457000e+01","2":"1.299000e+01","3":"15.087","4":"3.266300e+01","5":"6.547200e+01","6":"28.922","_rn_":"Precision for baseline.hazard"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.hyperpar$`Precision for season`)</code></pre>
<pre><code>##                 low     high
## level:0.95 1.175277 5.711847</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.hyperpar$`Precision for S`)</code></pre>
<pre><code>##                low        high
## level:0.95 10536.6 44998159149</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.hyperpar$`Phi for S`)</code></pre>
<pre><code>##                    low      high
## level:0.95 8.79047e-08 0.8000774</code></pre>
<pre class="r"><code>inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.hyperpar$`Precision for baseline.hazard`)</code></pre>
<pre><code>##                 low     high
## level:0.95 12.52881 60.13014</code></pre>
</div>
</div>
<div id="meteorological-variables" class="section level3">
<h3>Meteorological variables</h3>
<pre class="r"><code>library(nasapower)</code></pre>
<pre class="r"><code>nasa_imput = sbr_rep %&gt;% 
  dplyr::select(season, date_report, lat, lon) %&gt;% 
  mutate(three_month_before = date_report-90)</code></pre>
<pre class="r"><code>box_nasa = data.frame()
seasons = unique(sbr_rep$season)
total = 2441
k = 1
pb &lt;- txtProgressBar(min = 0, max = total, style = 3)
for(i in 1:length(seasons)){
s_nasa = nasa_imput %&gt;%
    filter(season == seasons[i])

for(j in 1:length(s_nasa$date_report)){

setTxtProgressBar(pb, k)
  
final_data = as.character(s_nasa$date_report[j])
init_data = as.character(s_nasa$three_month_before[j])
lat_nasa = s_nasa$lat[j]
lon_nasa = s_nasa$lon[j]

lil_box_nasa = get_power(
  community = &quot;ag&quot;,
  temporal_api = &quot;daily&quot;,
  dates = c(init_data, final_data),
  lonlat = c(lon_nasa, lat_nasa),
  pars = c(&quot;T2M&quot;, &quot;RH2M&quot;,&quot;PRECTOTCORR&quot;)
) %&gt;%
  mutate(season = seasons[i],
         date_report = s_nasa$date_report[j])

box_nasa = box_nasa %&gt;%
  bind_rows(lil_box_nasa)
k=k+1
}
# print(seasons[i])
}
print(&quot;Data for all coordinates and dates were downloaded&quot;)
write.csv(box_nasa, &quot;data/rainfall.csv&quot;)</code></pre>
<pre class="r"><code>box_nasa =  read.csv(&quot;data/rainfall.csv&quot;) 
nasa_full = box_nasa %&gt;% 
  rename(lat = LAT,
         lon = LON,
         rain = PRECTOTCORR,
         temp = T2M,
         rh = RH2M) %&gt;%
  mutate(season = as.character(season),
         date_report = as.Date(date_report),
         YYYYMMDD = as.Date(YYYYMMDD)) %&gt;% 
  full_join(inla_data_enso) %&gt;% 
  group_by(season,lat, lon,  date_report, enso) %&gt;% 
  mutate(days_to_report = as.numeric(-(max(YYYYMMDD) - YYYYMMDD))) </code></pre>
<pre><code>## Joining, by = c(&quot;lon&quot;, &quot;lat&quot;, &quot;season&quot;, &quot;date_report&quot;)</code></pre>
<pre class="r"><code>nasa_full %&gt;% 
  group_by(season,lat, lon,  date_report, enso) %&gt;%
  summarise(mean_rain = mean(rain),
            cum_rain = sum(rain)) %&gt;% 
  ggplot(aes(enso,mean_rain, fill =  enso))+
  stat_slab(alpha = 0.5)+
  stat_pointinterval()+
  scale_fill_colorblind()+
  labs(x =  &quot;ENSO phases&quot;,
       y = &quot;Cummulative rainfall&quot;)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;date_report&#39; (override with `.groups` argument)</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
<div id="rainfall" class="section level5">
<h5>Rainfall</h5>
<pre class="r"><code>rain_graph = nasa_full %&gt;% 
  ggplot(aes(days_to_report, rain, color = enso))+
  geom_smooth(method = &#39;gam&#39;,forumula = y ~ s(x, bs = &quot;tp&quot;))+
  scale_color_colorblind()+
  labs(x = &quot;Days before report&quot;,
       y = &quot;Rainfall (mm)&quot;,
       color = &quot;ENSO phases&quot;,
       title = &quot;Rainfall&quot;)+
  scale_x_continuous(limits = c(-90,0), breaks = seq(-90,0,by=15))+
  theme_half_open(font_size = 12)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: forumula</code></pre>
<pre class="r"><code>rain_graph</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
</div>
<div id="relative-humidity" class="section level5">
<h5>Relative humidity</h5>
<pre class="r"><code>rh_graph = nasa_full %&gt;% 
  ggplot(aes(days_to_report, rh, color = enso))+
  geom_smooth(method = &#39;gam&#39;,forumula = y ~ s(x, bs = &quot;tp&quot;))+
  scale_color_colorblind()+
  labs(x = &quot;Days before report&quot;,
       y = &quot;Relative humidity (%)&quot;,
       color = &quot;ENSO phases&quot;,
       title = &quot;Average ralative humidity&quot;)+
  scale_x_continuous(limits = c(-90,0), breaks = seq(-90,0,by=15))+
  theme_half_open(font_size = 12)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: forumula</code></pre>
<pre class="r"><code>rh_graph</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
</div>
<div id="temperature" class="section level5">
<h5>Temperature</h5>
<pre class="r"><code>temp_graph = nasa_full %&gt;% 
  ggplot(aes(days_to_report, temp, color = enso))+
  geom_smooth(method = &#39;gam&#39;,forumula = y ~ s(x, bs = &quot;tp&quot;))+
  scale_color_colorblind()+
  labs(x = &quot;Days before report&quot;,
       y = &quot;Temperature (°C)&quot;,
       color = &quot;ENSO phases&quot;,
       title = &quot;Average temperature&quot;)+
  scale_x_continuous(limits = c(-90,0), breaks = seq(-90,0,by=15))+
  theme_half_open(font_size = 12)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: forumula</code></pre>
<pre class="r"><code>temp_graph</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
<pre class="r"><code>rain_graph + rh_graph +temp_graph+
  plot_annotation(tag_levels = &quot;A&quot;)+
  plot_layout(guides = &quot;collect&quot;, ncol = 1)&amp;
  geom_vline(xintercept = 0, color = &quot;gray&quot;, linetype = 2)&amp;
  theme(plot.title = element_text(size = 10),
        # legend.position = &quot;bottom&quot;
        )</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;
## `geom_smooth()` using formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;
## `geom_smooth()` using formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-143-1.png" width="672" /></p>
<pre class="r"><code>ggsave(&quot;figs/met_data.png&quot;, dpi = 600, height = 8, width = 5.5)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;
## `geom_smooth()` using formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;
## `geom_smooth()` using formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre class="r"><code>inla_data_rain = nasa_full %&gt;% 
  group_by(season,lat, lon,S, days,count, date_report, enso) %&gt;% 
  summarise(mean_rain =mean(rain),
            cum_rain = sum(rain))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;season&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;S&#39;, &#39;days&#39;, &#39;count&#39;, &#39;date_report&#39; (override with `.groups` argument)</code></pre>
</div>
</div>
<div id="modeling" class="section level3">
<h3>Modeling</h3>
<pre class="r"><code>form_surv_rain = inla.surv(days, count) ~ 1 + mean_rain + 
  f(season, model = &quot;iid&quot;, hyper = list(prec = list(param = c(0.001,0.001))))+
  f(S, model = &quot;bym2&quot;, graph = W.pr_dist200,
    hyper = list(prec = list(param = c(0.001, 0.001)), 
                 phi = list(prior = &quot;pc&quot;, 
                            param = c(phi.u, phi.alpha),
                            initial = -3)))


surv_fit_rain = inla(form_surv_rain ,
                        data = inla_data_rain,
                        family = &quot;coxph&quot;,
                     control.hazard = list(hyper = list(prec = list(param = c(0.001, 0.001)))),
                        control.compute=list(dic=TRUE,
                                             cpo=TRUE,
                                             waic=TRUE,
                                             openmp.strategy=&quot;huge&quot;))

saveRDS(surv_fit_rain, &quot;./models/model_rain.RDS&quot;)</code></pre>
<pre class="r"><code>surv_fit_rain = readRDS(&quot;./models/model_rain.RDS&quot;)
summary(surv_fit_rain )</code></pre>
</div>
</div>
</div>
<div id="maps" class="section level1">
<h1>MAPS</h1>
<pre class="r"><code>map_data = sbr_rep_count_new %&gt;% 
  group_by(lat, lon,MUNIC_PIO) %&gt;% 
  summarise(count = sum(count))</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;lat&#39;, &#39;lon&#39; (override with `.groups` argument)</code></pre>
<pre class="r"><code>sul_df %&gt;% 
  full_join(map_data, by =&quot;MUNIC_PIO&quot;) %&gt;% 
  ggplot()+
  geom_sf(data =SUL %&gt;% filter(name != &quot;Brazil&quot;),
          size = 3,
          fill = &quot;white&quot;,
          color = &quot;white&quot;)+
  geom_sf(data = BRA,
          size = 0.2,
          fill = &quot;white&quot;,
          color = &quot;black&quot;)+
  # geom_sf(data = sul_sf,  color = &quot;black&quot;, size = 0.2,  fill = &quot;steelblue&quot;)+
  geom_polygon(aes(long, lat.x, group =id, fill = count), 
               color = NA)+
  geom_sf(data = sul_sf,  color = &quot;black&quot;, size = 0.2,  fill = NA)+
  # geom_point(data = map_data, aes(lon, lat), size = 0.1, color = &quot;black&quot;)+
  geom_text(data = sul_sf, #%&gt;% 
              #filter(!postal %in% c(&quot;SE&quot;, &quot;AL&quot;,&quot;PE&quot;,&quot;PB&quot;,&quot;RN&quot;,&quot;ES&quot;,&quot;RJ&quot;)),
            aes(x = longitude,
                y = latitude,
                label = postal),size = 5,
            fontface = &quot;bold&quot;, color = &quot;black&quot;)+
  coord_equal()+
  scale_fill_gradient(low= &quot;white&quot;, high = &quot;red&quot;, na.value = &quot;white&quot;, limits = c(0,17))+
  xlim(-57.7,-48)+
  ylim(-33.5,-22.5)+
  coord_sf()+
  labs(x = &quot;Longitude&quot;,
       y = &quot;Latitude&quot;,
       fill = &quot;N&quot;)+
  theme(axis.text.x = element_text(angle = 90, hjust = 1),
        legend.position = &quot;bottom&quot;,
        panel.grid = element_blank(),
        panel.background = element_rect(fill = &quot;steelblue&quot;))+
  north( location = &quot;bottomright&quot;, scale = 0.08, symbol = 10, x.min=-58, x.max=-48.9, y.min=-32.9, y.max=-22.3)+
  ggsn::scalebar(location = &quot;bottomright&quot;, dist = 100,
           dist_unit = &quot;km&quot;, transform = TRUE, 
           x.min=-58, x.max=-48.2, y.min=-33.5, y.max=-22.3,
           st.bottom = FALSE, height = 0.01,
           st.dist = 0.03, st.size = 2)</code></pre>
<pre><code>## Coordinate system already present. Adding new coordinate system, which will replace the existing one.</code></pre>
<p><img src="main_spatial_files/figure-html/unnamed-chunk-147-1.png" width="672" /></p>
<pre class="r"><code>ggsave(&quot;figs/fig1_map.png&quot;, dpi = 900, height = 6.5, width = 5)</code></pre>
<div id="cumulative-reports-1" class="section level3">
<h3>cumulative reports</h3>
<pre class="r"><code>months = c(&quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;, &quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;,&quot;Apr&quot;,&quot;May&quot;)
months = unique(sbr_rep$month)
sbr_rep_cummm = data.frame()
for(i in 1:(length(months))){

cumulative = sbr_rep %&gt;%
  ungroup() %&gt;%
    filter(month &lt;= months[i]) %&gt;%
    dplyr::select(season, state, Phen_state, lat_utm, lon_utm, lat, lon, days) %&gt;%
    mutate(month = months[i])

sbr_rep_cummm = sbr_rep_cummm %&gt;%
  bind_rows(cumulative)
}
sbr_rep_cummm$month = factor(sbr_rep_cummm$month, levels = c(&quot;Set&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;, &quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;,&quot;Apr&quot;,&quot;May&quot;))</code></pre>
</div>
</div>

<div id="rmd-source-code">JSBSaXNrIGFuZCBtYXBzDQoNCiMgUGFja2FnZXMgDQpgYGB7ciBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KbGlicmFyeShjb3dwbG90KQ0KbGlicmFyeShhZ3JpY29sYWUpDQpsaWJyYXJ5KHRpZHl2ZXJzZSkNCmxpYnJhcnkoZXBpZml0dGVyKQ0KbGlicmFyeShnZ3RoZW1lcykNCmxpYnJhcnkoZ2dmb3J0aWZ5KQ0KbGlicmFyeShzdXJ2aXZhbCkNCmxpYnJhcnkoc3Vydm1pbmVyKQ0KbGlicmFyeShwYXRjaHdvcmspDQpsaWJyYXJ5KHNwbGFuY3MpDQpsaWJyYXJ5KHN0cmluZ3IpDQpsaWJyYXJ5KG1hcHRvb2xzKQ0KbGlicmFyeShtYXBzKQ0KbGlicmFyeShncmlkKQ0KbGlicmFyeShnZ3NuKQ0KbGlicmFyeShyYXN0ZXIpDQpsaWJyYXJ5KHZpcmlkaXMpDQpsaWJyYXJ5KHJnZGFsKQ0KbGlicmFyeShsdWJyaWRhdGUpDQpsaWJyYXJ5KHNmKQ0KbGlicmFyeShzcCkNCmxpYnJhcnkoc3BhdHN0YXQpDQpsaWJyYXJ5KHNwYXRpYWxFY28pDQpsaWJyYXJ5KGdnYW5pbWF0ZSkNCmxpYnJhcnkoZ2lmc2tpKQ0KbGlicmFyeSh0cmFuc2Zvcm1yKQ0KbGlicmFyeShybmF0dXJhbGVhcnRoKQ0KbGlicmFyeShybmF0dXJhbGVhcnRoaGlyZXMpDQpsaWJyYXJ5KCJHR2FsbHkiKQ0KbGlicmFyeShJTkxBKQ0KbGlicmFyeShzcGRlcCkNCmxpYnJhcnkoY294bWUpDQpsaWJyYXJ5KGdzaGVldCkNCmxpYnJhcnkoZGlyZWN0bGFiZWxzKQ0KbGlicmFyeShnZ3JlcGVsKQ0KbGlicmFyeShmYWN0b2V4dHJhKQ0KbGlicmFyeShGYWN0b01pbmVSKQ0KbGlicmFyeShtZ2N2KQ0KbGlicmFyeSh0aWR5bXYpDQpsaWJyYXJ5KGdnZGlzdCkNCmBgYA0KDQpTdGFuZGFyZCB0aGVtZQ0KYGBge3J9DQp0aGVtZV9zZXQodGhlbWVfbGlnaHQoKSkNCmBgYA0KDQojIExvYWQgU0JSIGRhdGENCg0KYGBge3J9DQpzYnJfcmVwID0gcmVhZC5jc3YoImRhdGEvc2JyX3JlcC5jc3YiKSAlPiUgDQogICNyZW1vdmluZyB0aGVyIFggY29sdW1uIA0KICBkcGx5cjo6c2VsZWN0KC1YKSAlPiUgDQogIA0KICAjIHRyYW5mb3JtaW5nIHRoZSBkYXRlIGNvbHVtbnMgdG8gdHlwZSBkYXRlDQogIG11dGF0ZShzdGFydF9zZWFzb24gPSBhcy5EYXRlKHN0YXJ0X3NlYXNvbiksDQogICAgICAgICBzdGFydF9kYXRlID0gYXMuRGF0ZShzdGFydF9kYXRlKSwNCiAgICAgICAgIGRhdGVfcmVwb3J0ID0gYXMuRGF0ZShkYXRlX3JlcG9ydCkpICU+JSANCiAgIyB0cmFuZm9ybWluZyB0aGUgc2Vhc29ucyBjb2x1bW4gdG8gdHlwZSBjaGFyYWN0ZXINCiAgbXV0YXRlKHNlYXNvbiA9IGFzLmNoYXJhY3RlcihzZWFzb24pKQ0KDQoNCg0KYGBgDQoNCiMgTG9hZCBFTlNPIGRhdGENCmBgYHtyfQ0KZW5zb2RhdGEyID1yZWFkLmNzdiggImRhdGEvZW5zb190aWR5LmNzdiIpICU+JSANCiAgI3JlbW92aW5nIHRoZXIgWCBjb2x1bW4gDQogIGRwbHlyOjpzZWxlY3QoLVgpICU+JSANCiAgIyByZW9kZXJpbmcgdGhlIGVuc28gY29sdW1uIGFzICJOZXV0cmFsIiA+ICJFbCBOacOxbyIgPiAiTGEgTmnDsWEiDQogIG11dGF0ZShlbnNvID0gZmFjdG9yKGVuc28sIGMoIk5ldXRyYWwiLCJFbCBOacOxbyIsICJMYSBOacOxYSIpKSkgJT4lIA0KICAjIHRyYW5mb3JtaW5nIHRoZSBzZWFzb25zIGNvbHVtbiB0byB0eXBlIGNoYXJhY3Rlcg0KICBtdXRhdGUoc2Vhc29uID0gYXMuY2hhcmFjdGVyKHNlYXNvbikpDQpgYGANCg0KDQoNCmBgYHtyfQ0KZW5zb2RhdGEyICU+JSANCiAgcGl2b3RfbG9uZ2VyKDE6MTIsDQogICAgICAgICAgICAgICBuYW1lc190byA9ICJ0cmltZXN0ZXIiLA0KICAgICAgICAgICAgICAgdmFsdWVzX3RvID0gIk9OSSIpICU+JSANCiAgbXV0YXRlKHRyaW1lc3RlciA9IGZhY3Rvcih0cmltZXN0ZXIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWxzID1jKCJESkYiLCJKRk0iLCJGTUEiLCJNQU0iLCJBTUoiLCJNSkoiLCJKSkEiLCJKQVMiLCJBU08iLCJTT04iLCJPTkQiLCJOREoiICkgKSkgJT4lIA0KICBnZ3Bsb3QoYWVzKHRyaW1lc3RlciwgT05JLCBjb2xvciA9IGVuc28sIGdyb3VwID0gc2Vhc29uKSkrDQogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDAsIGNvbG9yID0gImdyYXkiKSsNCiAgc2NhbGVfY29sb3JfY29sb3JibGluZCgpKw0KICBnZW9tX3ZsaW5lKHhpbnRlcmNlcHQgPSAiT05EIiwgY29sb3IgPSAiZ3JheSIpKw0Kc3RhdF9zdW1tYXJ5KGZ1bi55PXN1bSwgZ2VvbT0ibGluZSIpKw0KICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAwLjgsIGxpbmV0eXBlID0gMiwgY29sb3IgPSAiZ3JheSIpKw0KICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAtMC44MiwgbGluZXR5cGUgPSAyLCBjb2xvciA9ICJncmF5IikrDQogIHRoZW1lX2hhbGZfb3BlbigpDQogIA0KYGBgDQoNCmBgYHtyfQ0KZW5zb2RhdGEyICU+JSANCiAgcGl2b3RfbG9uZ2VyKDE6MTIsDQogICAgICAgICAgICAgICBuYW1lc190byA9ICJ0cmltZXN0ZXIiLA0KICAgICAgICAgICAgICAgdmFsdWVzX3RvID0gIk9OSSIpICU+JSANCiAgbXV0YXRlKHRyaW1lc3RlciA9IGZhY3Rvcih0cmltZXN0ZXIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWxzID1jKCJESkYiLCJKRk0iLCJGTUEiLCJNQU0iLCJBTUoiLCJNSkoiLCJKSkEiLCJKQVMiLCJBU08iLCJTT04iLCJPTkQiLCJOREoiICkgKSkgJT4lIA0KICBmaWx0ZXIodHJpbWVzdGVyICVpbiUgYygiSkZNIiwgIk1KSiIsICJPTkQiKSkgJT4lIA0KICBnZ3Bsb3QoYWVzKCBzZWFzb24sT05JLCBncm91cCA9IHRyaW1lc3RlciwgY29sb3IgPSBlbnNvKSkrDQogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDApKw0KICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSBjKC0wLjgyLDAuOCksIGxpbmV0eXBlID0gMiwgY29sb3IgPSAiZ3JheSIpKw0KICBnZW9tX2Vycm9yYmFyKGFlcyh5bWluPTAsIHltYXggID0gT05JKSwgd2lkdGggPSAwLCBjb2xvciA9ICJibGFjayIpKw0KICBnZW9tX3BvaW50KHNpemUgPSAzKSsNCiAgDQogIHNjYWxlX2NvbG9yX2NvbG9yYmxpbmQoKSsNCiAgdGhlbWVfaGFsZl9vcGVuKGZvbnRfc2l6ZSA9IDEyKSsNCiAgbGVtb246OmZhY2V0X3JlcF93cmFwKH50cmltZXN0ZXIsIG5jb2wgPSAxKSsNCiAgc2NhbGVfeV9jb250aW51b3VzKGJyZWFrcyA9IGMoLTAuODIsMCwwLjgpLCBsaW1pdHMgPSBjKC0yLDIuNikpKw0KICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCBoanVzdCA9IDEpLA0KICAgICAgICAjIGxlZ2VuZC5wb3NpdGlvbiA9ICJ0b3AiLA0KICAgICAgICBzdHJpcC5iYWNrZ3JvdW5kID0gZWxlbWVudF9ibGFuaygpKSsNCiAgbGFicyh4ID0gIkNyb3AgU2Vhc29uIiwNCiAgICAgICB5ID0gIk9jZWFuaWMgTmnDsW8gSW5kZXgiLA0KICAgICAgIGNvbG9yID0gIkVOU08gcGhhc2UgKE9ORCkiKQ0KICANCg0KZ2dzYXZlKCJmaWdzL09OSXRyaW1ldGVyLnBuZyIsIGRwaSA9IDYwMCwgaGVpZ2h0ID0gNiwgd2lkdGggPSA2KQ0KYGBgDQoNCg0KIyBPdmVyYWwgTWFwDQojIyAgTG9hZGluZyBtYXAgZmlsZXMNCmBgYHtyfQ0KU1VMID0gbmVfY291bnRyaWVzKA0KICBjb250aW5lbnQgPSAiU291dGggQW1lcmljYSIsDQogIHJldHVybmNsYXNzID0gInNmIikNCkJSQSA8LSBuZV9zdGF0ZXMoDQogIGNvdW50cnkgICA9ICJicmF6aWwiLA0KICByZXR1cm5jbGFzcyA9ICJzZiINCikNCg0Kc3VsX3NmID0gQlJBW0JSQSRuYW1lICVpbiUgYygiUmlvIEdyYW5kZSBkbyBTdWwiLCJTYW50YSBDYXRhcmluYSIsIlBhcmFuw6EiICksXQ0KYGBgDQoNCg0KIyBTdW1tYXJpZXMgDQoNCiMjIyMgTnVtYmVyIG9mIHJlcG9ydHMNCmBgYHtyfQ0Kc2JyX3JlcCAlPiUgDQogIHN1bW1hcmlzZShuX3JlcG9ydHMgPSBsZW5ndGgoZGF0ZV9yZXBvcnQpKQ0KICANCmBgYA0KDQpgYGB7cn0NCnNicl9yZXAgJT4lIA0KICAjIGdyb3VwX2J5KHJlZ2lvbikgJT4lIA0KICBzdW1tYXJpc2Uobl9yZXBvcnRzID0gbGVuZ3RoKGRhdGVfcmVwb3J0KSkgIyU+JSANCiAgIyB1bmdyb3VwKCkgJT4lIA0KICAjIG11dGF0ZSh0b3RhbCA9IHN1bShuX3JlcG9ydHMpLA0KICAgICAgICAgIyBwZXJjZW50ID0gcm91bmQoKG5fcmVwb3J0cy90b3RhbCkqMTAwLDIpKQ0KYGBgDQoNCg0KIyMjIyBOdW1iZXIgb2YgcmVwb3J0cyBieSBzdGF0ZQ0KYGBge3J9DQpzYnJfcmVwICU+JSANCiAgZ3JvdXBfYnkoc3RhdGUpICU+JQ0KICBzdW1tYXJpc2Uobl9yZXBvcnRzID0gbGVuZ3RoKGRhdGVfcmVwb3J0KSkjICU+JQ0KICAjIGdyb3VwX2J5KHJlZ2lvbikgJT4lIA0KICAjIG11dGF0ZSh0b3RhYWxfcmVnaW9uID0gc3VtKG5fcmVwb3J0cykpICU+JSANCiAgIyBhcnJhbmdlKHJlZ2lvbikNCiAgDQpgYGANCg0KYGBge3J9DQpzYnJfcmVwICU+JSANCiAgZ3JvdXBfYnkoc3RhdGUsIHJlZ2lvbikgJT4lDQogIHN1bW1hcmlzZShuX3JlcG9ydHMgPSBsZW5ndGgodW5pcXVlKGxvY2F0aW9uKSkpJT4lIA0KICBhcnJhbmdlKC1uX3JlcG9ydHMpICU+JSANCiAgZ2dwbG90KGFlcyhzdGF0ZSwgbl9yZXBvcnRzLCBmaWxsID0gcmVnaW9uKSkrDQogIGdlb21fY29sKGNvbG9yID0gTkEpKw0KICBsYWJzKHggPSAiU3RhdGUiLA0KICAgICAgIHkgPSAiTnVtYmVyIG9mIHJlcG9ydHMiKSsNCiAgc2NhbGVfZmlsbF9tYW51YWwodmFsdWVzID0gYygiIzY2YzJhNSIsIiNmYzhkNjIiLCIjOGRhMGNiIikpKw0KICBzY2FsZV95X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDAsNDAwLGJ5ID0yNSkpKw0KICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIsDQogICAgICAgIHBhbmVsLmJhY2tncm91bmQgPSBlbGVtZW50X2JsYW5rKCksDQogICAgICAgIHBhbmVsLmdyaWQgPSBlbGVtZW50X2JsYW5rKCksDQogICAgICAgIHBhbmVsLmJvcmRlciA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgYXhpcy5saW5lLnggPSBlbGVtZW50X2xpbmUoY29sb3IgPSAiYmxhY2siKSwNCiAgICAgICAgYXhpcy5saW5lLnkgPSBlbGVtZW50X2xpbmUoY29sb3IgPSAiYmxhY2siKSwNCiAgICAgICAgYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSAwKSkNCmBgYA0KDQoNCg0KIyMjIyBOdW1iZXIgb2YgcmVwb3J0cyBieSBzZWFzb24NCmBgYHtyfQ0Kc2JyX3JlcCAlPiUgDQogIGdyb3VwX2J5KHNlYXNvbikgJT4lDQogIHN1bW1hcmlzZShuX3JlcG9ydHMgPSBsZW5ndGgoZGF0ZV9yZXBvcnQpKQ0KICANCmBgYA0KDQoNCmBgYHtyfQ0Kc2JyX3JlcCAlPiUgDQogIGdyb3VwX2J5KHNlYXNvbixzdGF0ZSkgJT4lDQogIHN1bW1hcmlzZShuX3JlcG9ydHMgPSBsZW5ndGgodW5pcXVlKGxvY2F0aW9uKSkpJT4lIA0KICBhcnJhbmdlKC1uX3JlcG9ydHMpICU+JSANCiAgZ2dwbG90KGFlcyhzZWFzb24sIG5fcmVwb3J0cywgZmlsbCA9IHN0YXRlKSkrDQogIGdlb21fY29sKGNvbG9yID1OQSkrDQogIGxhYnMoeCA9ICJDcm9wIHNlYXNvbiIsDQogICAgICAgeSA9ICJOdW1iZXIgb2YgcmVwb3J0cyIsDQogICAgICAgZmlsbCA9ICIiKSsNCiBzY2FsZV9maWxsX21hbnVhbCh2YWx1ZXMgPSBjKCIjNjZjMmE1IiwiI2ZjOGQ2MiIsIiM4ZGEwY2IiKSkrDQogIHNjYWxlX3lfY29udGludW91cyhicmVha3MgPSBzZXEoMCw0MDAsYnkgPTI1KSkrDQogIHRoZW1lKCNsZWdlbmQucG9zaXRpb24gPSAibm9uZSIsDQogICAgICAgIHBhbmVsLmJhY2tncm91bmQgPSBlbGVtZW50X2JsYW5rKCksDQogICAgICAgIHBhbmVsLmdyaWQgPSBlbGVtZW50X2JsYW5rKCksDQogICAgICAgIHBhbmVsLmJvcmRlciA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgYXhpcy5saW5lLnggPSBlbGVtZW50X2xpbmUoY29sb3IgPSAiYmxhY2siKSwNCiAgICAgICAgYXhpcy5saW5lLnkgPSBlbGVtZW50X2xpbmUoY29sb3IgPSAiYmxhY2siKSwNCiAgICAgICAgYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSAyMCkpDQpgYGANCg0KDQoNCiMjIyMgRWFybHkgcmVwb3J0cyANCmBgYHtyfQ0Kc2JyX3JlcCAlPiUgDQogIGdyb3VwX2J5KHNlYXNvbiwgc3RhdGUpICU+JQ0KICBzdW1tYXJpc2UobWluX3JlcG9ydCA9IG1pbihkYXRlX3JlcG9ydCkpICU+JSANCiAgbXV0YXRlKG1vbnRoX21pbiA9IG1vbnRoKG1pbl9yZXBvcnQsIGxhYmVsID0gVCksIA0KICAgICAgICAgZGF5X21pbiA9IGRheShtaW5fcmVwb3J0KSkgJT4lIA0KICBncm91cF9ieShtb250aF9taW4pICU+JSANCiAgYXJyYW5nZShkYXlfbWluKSAlPiUgDQogIGFycmFuZ2UobW9udGhfbWluKQ0KYGBgDQoNCiMjIyMgTGF0ZXIgcmVwb3J0cyANCg0KYGBge3J9DQpzYnJfcmVwICU+JSANCiAgZ3JvdXBfYnkoc2Vhc29uLCBzdGF0ZSkgJT4lDQogIHN1bW1hcmlzZShtYXhfcmVwb3J0ID0gbWF4KGRhdGVfcmVwb3J0KSwNCiAgICAgICAgICAgIGRhcCA9IG1heChkYXlzKSkgJT4lIA0KICBtdXRhdGUobW9udGhfbWF4ID0gbW9udGgobWF4X3JlcG9ydCwgbGFiZWwgPSBUKSwgDQogICAgICAgICBkYXlfbWF4ID0gZGF5KG1heF9yZXBvcnQpKSAlPiUgDQogIGdyb3VwX2J5KG1vbnRoX21heCkgJT4lDQogIGFycmFuZ2UoZGF5X21heCkgJT4lDQogIGFycmFuZ2UobW9udGhfbWF4KSAlPiUNCiAgdW5ncm91cCgpDQpgYGANCg0KDQpgYGB7cn0NCmVwaV90aW1lX2JyID0gc2JyX3JlcCAlPiUgDQogIGRwbHlyOjpncm91cF9ieShzZWFzb24pICU+JQ0KICBkcGx5cjo6c3VtbWFyaXNlKG1pbl9yZXBvcnQgPSBtaW4oZGF0ZV9yZXBvcnQpLCANCiAgICAgICAgICAgIG1heF9yZXBvcnQgPSBtYXgoZGF0ZV9yZXBvcnQpLA0KICAgICAgICAgICAgZXBpZGVtaWNfdGltZSA9YXMubnVtZXJpYyggbWF4X3JlcG9ydC0gbWluX3JlcG9ydCkpICU+JSANCiAgYXJyYW5nZShlcGlkZW1pY190aW1lKQ0KYGBgDQoNCg0KDQojIyMjIEVwaWRlbWljIHRpbWU6IERpZmZlcmVuY2UgYmV0d2VlbiBlYXJseSBhbmQgbGF0ZXIgcmVwb3J0cw0KYGBge3J9DQplcGlfdGltZSA9IHNicl9yZXAgJT4lIA0KICBkcGx5cjo6Z3JvdXBfYnkoc2Vhc29uKSAlPiUNCiAgZHBseXI6OnN1bW1hcmlzZShtaW5fcmVwb3J0ID0gbWluKGRhdGVfcmVwb3J0KSwgDQogICAgICAgICAgICBtYXhfcmVwb3J0ID0gbWF4KGRhdGVfcmVwb3J0KSwNCiAgICAgICAgICAgIGVwaWRlbWljX3RpbWUgPWFzLm51bWVyaWMoIG1heF9yZXBvcnQtIG1pbl9yZXBvcnQpKSAlPiUgDQogIGFycmFuZ2UoZXBpZGVtaWNfdGltZSkgJT4lIA0KICBkcGx5cjo6c2VsZWN0KC1tYXhfcmVwb3J0LC1taW5fcmVwb3J0KQ0KZXBpX3RpbWUgIA0KYGBgDQoNCmBgYHtyfQ0Kc2JyX3JlcCAlPiUgDQogIGRwbHlyOjpncm91cF9ieShzZWFzb24scmVnaW9uKSAlPiUNCiAgZHBseXI6OnN1bW1hcmlzZShtaW5fcmVwb3J0ID0gbWluKGRheXNfc2VwMTUpLCANCiAgICAgICAgICAgIG1heF9yZXBvcnQgPSBtYXgoZGF5c19zZXAxNSksDQogICAgICAgICAgICB0aW1lID0gYXMubnVtZXJpYyhtYXhfcmVwb3J0LW1pbl9yZXBvcnQpKSAlPiUNCiAgZ2dwbG90KGFlcyh5ID0gc2Vhc29uLCBjb2xvcj0gcmVnaW9uKSkrDQogIGdlb21fZXJyb3JiYXIoYWVzKHhtaW49IG1pbl9yZXBvcnQsIHhtYXggPSBtYXhfcmVwb3J0KSwNCiAgICAgICAgICAgICAgICBzaXplID0gLjgsIHdpZHRoID0gLjUsDQogICAgICAgICAgICAgICAgcG9zaXRpb24gPSBwb3NpdGlvbl9kb2RnZSgpKSsNCiAgbGFicyh4ID0gIkRheXMgYWZ0ZXIgU2VwdGVtYmVyIDE1dGgiLA0KICAgICAgIHkgPSAiQ3JvcCBzZWFzb24iLA0KICAgICAgIGNvbG9yID0iIikrDQogIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSBjKCIjNjZjMmE1IiwiI2ZjOGQ2MiIsIiM4ZGEwY2IiKSkrDQogIHNjYWxlX3hfY29udGludW91cyhsaW1pdHMgPSBjKDAsMjc1KSwgYnJlYWtzID0gc2VxKDAsMjc1LGJ5ID0gMjUpKSsNCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uID0gInRvcCIsDQogICAgICAgIHBhbmVsLmJhY2tncm91bmQgPSBlbGVtZW50X2JsYW5rKCksDQogICAgICAgIHBhbmVsLmdyaWQgPSBlbGVtZW50X2JsYW5rKCksDQogICAgICAgIHBhbmVsLmJvcmRlciA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgYXhpcy5saW5lLnggPSBlbGVtZW50X2xpbmUoY29sb3IgPSAiYmxhY2siKSwNCiAgICAgICAgYXhpcy5saW5lLnkgPSBlbGVtZW50X2xpbmUoY29sb3IgPSAiYmxhY2siKSwNCiAgICAgICAgYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSAwKSkNCg0KIyBnZ3NhdmUoImZpZ3MvZXBpZGVtaWNfcmFnZS5wbmciLCBkcGk9NjAwLCBoZWlnaHQgPSA2LCB3aWR0aCA9IDQpDQpgYGANCg0KYGBge3J9DQpzYnJfcmVwICU+JSANCiAgZHBseXI6Omdyb3VwX2J5KHNlYXNvbixzdGF0ZSkgJT4lDQogIGRwbHlyOjpzdW1tYXJpc2UobWluX3JlcG9ydCA9IG1pbihkYXlzX3NlcDE1KSwgDQogICAgICAgICAgICBtYXhfcmVwb3J0ID0gbWF4KGRheXNfc2VwMTUpDQogICAgICAgICAgICAjIHRpbWUgPSBhcy5udW1lcmljKG1heF9yZXBvcnQtbWluX3JlcG9ydCkNCiAgICAgICAgICAgICkgJT4lDQogIHBpdm90X2xvbmdlcigzOjQsDQogICAgICAgICAgICAgICBuYW1lc190byA9ICJtaW5fbWF4IiwNCiAgICAgICAgICAgICAgIHZhbHVlc190byA9ICJ0aW1lIikgJT4lIA0KICBnZ3Bsb3QoYWVzKHRpbWUsIGZpbGwgPSBtaW5fbWF4KSkrIA0KICBnZW9tX2RlbnNpdHkoYWxwaGEgPSAwLjMpDQpgYGANCg0KDQoNCiMjIyMgTnVtYmVyIG9mIHJlcG9ydHMgcGVyIGRheQ0KDQpgYGB7cn0NCnNicl9yZXAgJT4lDQogIGRwbHlyOjpncm91cF9ieShzZWFzb24sIGRhdGVfcmVwb3J0KSAlPiUgDQogIGRwbHlyOjpzdW1tYXJpc2UoY291bnQgPSBuKCkpICU+JSANCiAgYXJyYW5nZSgtY291bnQpDQpgYGANCg0KDQoNCiMjIyMgTWF4IE51bWJlciBvZiByZXBvcnRzIHBlciB3ZWVrDQpgYGB7cn0NCnNicl9yZXAgJT4lDQogIGRwbHlyOjpncm91cF9ieShzZWFzb24sIHdlZWssIHN0YXRlKSAlPiUgDQogIGRwbHlyOjpzdW1tYXJpc2UoY291bnQgPSBuKCkpICU+JQ0KICB1bmdyb3VwKCkgJT4lIA0KICBkcGx5cjo6ZmlsdGVyKGNvdW50ID09IG1heChjb3VudCkpDQoNCmBgYA0KDQojIyMjIE1lYW4gTnVtYmVyIG9mIHJlcG9ydHMgcGVyIGRheQ0KYGBge3J9DQpzYnJfcmVwICU+JQ0KICBncm91cF9ieShzZWFzb24sIGRhdGVfcmVwb3J0KSAlPiUgDQogIHN1bW1hcmlzZShjb3VudCA9IG4oKSkgJT4lDQogIHVuZ3JvdXAoKSAlPiUgDQogICMgZ3JvdXBfYnkocmVnaW9uKSAlPiUgDQogIHN1bW1hcmlzZShtZWFuID0gbWVhbihjb3VudCkpDQpgYGANCg0KDQojIyMjIE1lYW4gbnVtYmVyIG9mIHJlcG9ydHMgcGVyIGRheSBwZXIgc3RhdGUNCmBgYHtyfQ0Kc2JyX3JlcCAlPiUNCiAgZ3JvdXBfYnkoc2Vhc29uLCBkYXRlX3JlcG9ydCwgc3RhdGUpICU+JSANCiAgc3VtbWFyaXNlKGNvdW50ID0gbigpKSAlPiUNCiAgZ3JvdXBfYnkoc3RhdGUpICU+JSANCiAgc3VtbWFyaXNlKG1lYW4gPSBtZWFuKGNvdW50KSkNCmBgYA0KDQojIyMjIE1heGltdW0gbnVtYmVyIG9mIHJlcG9ydHMgaW4gYSBzYW1lIGRheQ0KYGBge3J9DQpzYnJfcmVwICU+JQ0KICBncm91cF9ieShzZWFzb24sIGRhdGVfcmVwb3J0LCByZWdpb24pICU+JSANCiAgc3VtbWFyaXNlKGNvdW50ID0gbigpKSAlPiUNCiAgdW5ncm91cCgpICU+JSANCiAgZmlsdGVyKGNvdW50ID09IG1heChjb3VudCkpDQpgYGANCg0KIyMjIyBQbGFudGluZyB3ZWVrIGFmdGVyIFNlcCAxNXRoIChNZWRpYW4pDQpgYGB7cn0NCnBkID0gc2JyX3JlcCAlPiUgDQogIG11dGF0ZShwbGFudF93ZWVrID0gd2VlayhzdGFydF9kYXRlKS0zNykgJT4lIA0KICBncm91cF9ieShzdGF0ZSkgJT4lIA0KICBzdW1tYXJpc2UocGQgPSBtZWRpYW4ocGxhbnRfd2VlaykpDQogICMgZ2dwbG90KGFlcyhwbGFudF93ZWVrKSkrDQogICMgZ2VvbV9oaXN0b2dyYW0oKSsNCiAgIyBmYWNldF93cmFwKH5zdGF0ZSkNCnBkIA0KYGBgDQoNCiMjIyMgUGxhbnRpbmcgZGF0ZSBieSB5ZWFyDQpgYGB7cn0NCnNicl9yZXAgJT4lDQogIG11dGF0ZShwbGFudGluZ19kYXltb250aCA9IGZvcm1hdChhcy5EYXRlKHN0YXJ0X2RhdGUpLCAiJWQtJW0iKSkgJT4lIA0KICBtdXRhdGUocGxhbnRpbmdfbW9udGggPSBtb250aChzdGFydF9kYXRlKSkgJT4lDQogIGZpbHRlcihwbGFudGluZ19tb250aCAhPSA4KSAlPiUgDQogIGdyb3VwX2J5KHNlYXNvbikgJT4lIA0KICBtdXRhdGUodG90YWwgPSBuKCkpICU+JSANCiAgZ3JvdXBfYnkoc2Vhc29uLCBwbGFudGluZ19tb250aCkgJT4lIA0KICBzdW1tYXJpc2UoY291bnQgPSAobigpL3RvdGFsKSoxMDApICU+JSANCiAgIyBtdXRhdGUocGxhbnRpbmdfZGF5bW9udGggPSBmYWN0b3IocGxhbnRpbmdfZGF5bW9udGgsIGxldmVscyA9IGMoIjA3LTA4IiwgIjA3LTA5IiwgIjIxLTA5IiwiMDEtMTAiLCAiMDctMTAiLCAiMjEtMTAiLCIwNy0xMSIsIjIxLTExIiwiMDctMTIiLCIyMS0xMiIpICkpICU+JSANCiAgZ2dwbG90KGFlcyhwbGFudGluZ19tb250aCxzZWFzb24sIGZpbGwgPSBjb3VudCkpKw0KICBnZW9tX3RpbGUoY29sb3IgPSAid2hpdGUiLHNpemUgPTEpKw0KICBzY2FsZV9maWxsX3ZpcmlkaXNfYygpKw0KICBsYWJzKHggPSAiTcOqcyBkZSBwbGFudGlvIiwNCiAgICAgICB5ID0gIlNhZnJhIiwNCiAgICAgICBmaWxsID0gIlBvcmNlbnRhZ2VtXG5kb3MgcGxhbnRpb3MiKSsNCiAgdGhlbWVfbWluaW1hbF9oZ3JpZCgpKw0KICBjb29yZF9mbGlwKCkNCiAgDQojIGdnc2F2ZSgiZmlncy9wbGFudGluZ19kYXRlcy5wbmciLCBkcGkgPSA2MDAsIGhlaWdodCA9IDMsIHdpZHRoID0xMCkNCmBgYA0KDQoNCg0KIyMgQ29udmVydCBjb29yZGluYXRlcyB0byBVVE0NCg0KYGBge3J9DQpzb3VyY2UoImNvb3JkX3RyYW5zZm9ybS5SIikNCmxhdCA9IHNicl9yZXAkbGF0DQpsb24gPSBzYnJfcmVwJGxvbg0KDQojIG5ld19jb29yZCA9IGxvbmdsYXRfdG9fVVRNKGxvbmcgPSBzYnJfcmVwJGxvbiwgbGF0ID1zYnJfcmVwJGxhdAksIHVuaXRzID0gJ20nKQ0KIyAgc2JyX3JlcCRsYXRfdXRtID0gIG5ld19jb29yZCR5DQojICBzYnJfcmVwJGxvbl91dG0gPSBuZXdfY29vcmQkeA0KeHkgPC0gZGF0YS5mcmFtZShJRCA9IDE6KGxlbmd0aChsYXQpKSwgbG9uLCBsYXQpDQpjb29yZGluYXRlcyh4eSkgPC0gYygibG9uIiwgImxhdCIpDQpwcm9qNHN0cmluZyh4eSkgPC0gQ1JTKCIrcHJvaj1sb25nbGF0ICtkYXR1bT1XR1M4NCIpDQpyZXMgPC0gc3BUcmFuc2Zvcm0oeHksIENSUygiK3Byb2o9dXRtICt6b25lPTIyIGVsbHBzPVdHUzg0IikpDQpjb29yZHNfdXRtID0gYXMuZGF0YS5mcmFtZShyZXMpDQpzYnJfcmVwJGxhdF91dG0gPSAgMWUrMDcgKyBjb29yZHNfdXRtJGxhdA0Kc2JyX3JlcCRsb25fdXRtID0gY29vcmRzX3V0bSRsb24NCmBgYA0KDQoNCg0KDQojIFRlbXBvcmFsIGFzcGVjdHMgDQoNCg0KDQoNCk51bWJlciBvZiBjYXNlcyBieSBtb250aCANCmBgYHtyfQ0Kc2JyX3JlcCAlPiUNCiAgZ3JvdXBfYnkoc2Vhc29uLCBtb250aCkgJT4lIA0KICBzdW1tYXJpc2UoY291bnQgPSBuKCkNCiAgICAgICAgICAgICkgJT4lIA0KICBnZ3Bsb3QoYWVzKG1vbnRoLGNvdW50KQ0KICAgICAgICAgKSsNCiAgZ2VvbV9iYXIoc3RhdCA9ICJpZGVudGl0eSIsDQogICAgICAgICAgIHBvc2l0aW9uID0gImRvZGdlIiwNCiAgICAgICAgICAgY29sb3IgPSAid2hpdGUiLA0KICAgICAgICAgICBzaXplID0gLjUpKw0KICBzY2FsZV9maWxsX21hbnVhbCh2YWx1ZXMgPSBjKCJibGFjayIsICJncmF5NDAiKSkrDQogIGZhY2V0X3dyYXAofnNlYXNvbikrDQogIGxhYnMoeCA9ICJNb250aCIsDQogICAgICAgeSA9ICJSZXBvcnRzIGNvdW50IiwNCiAgICAgICBmaWxsID0gIlNlYXNvbiINCiAgICAgICApKw0KICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCBoanVzdCA9IDEpLA0KICAgICAgICBsZWdlbmQucG9zaXRpb24gPSAibm9uZSINCiAgICAgICAgKQ0KICMgZ2dzYXZlKCJmaWdzL2ZpZzEucG5nIiwgZHBpID0gNjAwLCBoZWlnaHQgPSA4LCB3aWR0aCA9IDYpICANCiAgDQpgYGANCg0KIyMgUGhlbm9sb2dpY2FsIHN0YXRlDQpgYGB7cn0NCnNicl9yZXAgJT4lDQogIG11dGF0ZShQaGVuX3N0YXRlID0gYXMuY2hhcmFjdGVyKFBoZW5fc3RhdGUpKSAlPiUgDQogIG11dGF0ZShQaGVuX3N0YXRlMiA9IGNhc2Vfd2hlbihQaGVuX3N0YXRlICVpbiUgYygiVkMiLCJWMSIsICJWMiIsICJWMyIsICJWbiIpIH4gIlZlZ2V0YXRpdmUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQaGVuX3N0YXRlICVpbiUgYygiUjYiLCJSNyIsICJSOCIsICJSOSIpIH4gIkxhdGUgcmVwcm9kdWN0aXZlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIVBoZW5fc3RhdGUgJWluJSBjKCJWQyIsIlYxIiwgIlYyIiwgIlYzIiwgIlZuIiwiUjYiLCJSNyIsICJSOCIsICJSOSIsICJWbiIpIH4gUGhlbl9zdGF0ZSksDQogICAgICAgICBQaGVuX3N0YXRlMiA9IGZhY3RvcihQaGVuX3N0YXRlMiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscyA9IGMoIlZlZ2V0YXRpdmUiLCJSMSIsIlIyIiwiUjMiLCJSNCIsIlI1IiwiTGF0ZSByZXByb2R1Y3RpdmUiKSkpICU+JSANCiAgZ3JvdXBfYnkoUGhlbl9zdGF0ZTIsIHNlYXNvbikgJT4lIA0KICBzdW1tYXJpc2UobigpKQ0KYGBgDQoNCg0KYGBge3J9DQpsaWJyYXJ5KGdnbW9zYWljKQ0Kc2JyX3JlcCAlPiUNCiAgbXV0YXRlKFBoZW5fc3RhdGUgPSBhcy5jaGFyYWN0ZXIoUGhlbl9zdGF0ZSkpICU+JSANCiAgbXV0YXRlKFBoZW5fc3RhdGUyID0gY2FzZV93aGVuKFBoZW5fc3RhdGUgJWluJSBjKCJWQyIsIlYxIiwgIlYyIiwgIlYzIiwgIlZuIikgfiAiVmVnZXRhdGl2ZSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBoZW5fc3RhdGUgJWluJSBjKCJSNiIsIlI3IiwgIlI4IiwgIlI5IikgfiAiTGF0ZSByZXByb2R1Y3RpdmUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhUGhlbl9zdGF0ZSAlaW4lIGMoIlZDIiwiVjEiLCAiVjIiLCAiVjMiLCAiVm4iLCJSNiIsIlI3IiwgIlI4IiwgIlI5IiwgIlZuIikgfiBQaGVuX3N0YXRlKSwNCiAgICAgICAgIFBoZW5fc3RhdGUyID0gZmFjdG9yKFBoZW5fc3RhdGUyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWxzID0gYygiVmVnZXRhdGl2ZSIsIlIxIiwiUjIiLCJSMyIsIlI0IiwiUjUiLCJMYXRlIHJlcHJvZHVjdGl2ZSIpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBsZXZlbHMgPSBjKCJMYXRlIHJlcHJvZHVjdGl2ZSIsIlI1IiwiUjQiLCJSMyIsIlIyIiwiUjEiLCJWZWdldGF0aXZlIikpDQogICAgICAgICANCiAgICAgICAgICkgJT4lIA0KDQogIGdncGxvdCgpKw0KICBnZW9tX21vc2FpYyhhZXMoeCA9IHByb2R1Y3QoUGhlbl9zdGF0ZTIsIHNlYXNvbiksIGZpbGw9UGhlbl9zdGF0ZTIpLA0KICAgICAgICAgICAgICBhbHBoYSA9MSwgc2l6ZSA9MS4yKSsNCiAgc2NhbGVfZmlsbF9icmV3ZXIoZGlyZWN0aW9uID0gLTEsIHBhbGV0dGUgPSAiU3BlY3RyYWwiLA0KICAgICAgICAgICAgICAgICAgICBicmVha3MgPSBjKCJMYXRlIHJlcHJvZHVjdGl2ZSIsIlI1IiwiUjQiLCJSMyIsIlIyIiwiUjEiLCJWZWdldGF0aXZlIikpKw0KICBsYWJzKHkgPSJQaGVub2xvZ2ljYWwgc3RhZ2VzIiwNCiAgICAgICB4ID0gICJDcm9wIHNlYXNvbiIsDQogICAgICAgZmlsbCA9IiIsDQogICAgICAgY29sb3IgPSIiKSsNCiAgIyBzY2FsZV95X2Rpc2NyZXRlKCkrDQogIHRoZW1lX2hhbGZfb3BlbigpKw0KICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCBoanVzdCA9IDEpKQ0KDQogZ2dzYXZlKCJmaWdzL3BoZW5fY291dC5wbmciLCBkcGkgPSA2MDAsIGhlaWdodCA9IDYsIHdpZHRoID0gMTApDQpgYGANCg0KDQpOdW1iZXIgb2YgY2FzZXMgYnkgZGF5IA0KDQpgYGB7cn0NCnNicl9yZXAgJT4lDQogIGdyb3VwX2J5KHNlYXNvbiwgd2VlayxyZWdpb24pICU+JSANCiAgc3VtbWFyaXNlKGNvdW50ID0gbigpDQogICAgICAgICAgICApICU+JSANCiAgZ2dwbG90KGFlcyh3ZWVrLCBjb3VudCwNCiAgICAgICAgICAgICBncm91cCA9IHNlYXNvbiwgIGNvbG9yID0gIHNlYXNvbiApDQogICAgICAgICApKw0KICBnZW9tX2xpbmUoc2l6ZSA9MC41KSsNCiAgZ2VvbV9wb2ludCgpKw0KICBmYWNldF93cmFwKH5yZWdpb24pKw0KICBzY2FsZV9maWxsX2NvbG9yYmxpbmQoKSsNCiAgc2NhbGVfY29sb3JfdmlyaWRpcyhkaXNjcmV0ZSA9IFQpKw0KICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDAsMjQwLCAzMCkpKw0KICAjIGZhY2V0X3dyYXAofnNlYXNvbiwgbmNvbCA9IDEpKw0KICBsYWJzKHggPSAiRGF5cyBhZnRlciBTZXAgMTV0aCIsDQogICAgICAgeSA9ICJEYWlseSByZXBvcnRzIGNvdW50IikrDQogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJub25lIiwgdGV4dCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTQpDQogICAgICAgICkNCmBgYA0KDQpgYGB7cn0NCnRlbXBfbGluZXNfZGYgPSBzYnJfcmVwICU+JSANCiAgZ3JvdXBfYnkoc2Vhc29uLCBkYXlzX3NlcDE1KSAlPiUgDQogIGRwbHlyOjpzdW1tYXJpc2UoY291bnQgPSBuKCkpICU+JQ0KICBncm91cF9ieShzZWFzb24pICU+JSANCiAgZHBseXI6Om11dGF0ZShjb211bGF0aWNlX3ByZXZhbGVuY2UgPSBjdW1zdW0oY291bnQpLA0KICAgICAgICAgICAgICAgIHRvdGFsID0gbWF4KGN1bXN1bShjb3VudCkpLA0KICAgICAgICAgICAgICAgIGRheXNfc2VwMTUgPSBhcy5udW1lcmljKGRheXNfc2VwMTUpKSAlPiUgDQogIGZ1bGxfam9pbihlbnNvZGF0YTIpDQoNCg0KZ2dwbG90KGRhdGEgID0gdGVtcF9saW5lc19kZiwNCiAgICAgICBhZXMoZGF5c19zZXAxNSwgY29tdWxhdGljZV9wcmV2YWxlbmNlLCBncm91cCA9IHNlYXNvbiwgY29sb3IgPSBlbnNvKSkrDQogICMgZ2VvbV92bGluZSh4aW50ZXJjZXB0ID0gYygxMDAsMTMwKSwgbGluZXR5cGUgPSAyLCBjb2xvciA9ICJncmF5NDAiKSsNCiAgZ2VvbV9saW5lKHNpemUgPSAwLjMpKw0KICBnZW9tX3RleHRfcmVwZWwoZGF0YSAgPSB0ZW1wX2xpbmVzX2RmICU+JSANCiAgICAgICAgICAgICAgZmlsdGVyKGRheXNfc2VwMTUgPT0gbGFzdChkYXlzX3NlcDE1KSksDQogICAgICAgICAgICBhZXMoeCA9IGRheXNfc2VwMTUsIHkgPSBjb211bGF0aWNlX3ByZXZhbGVuY2UsDQogICAgICAgICAgICAgICAgbGFiZWwgPSBzZWFzb24sIGdyb3VwID0gc2Vhc29uICksDQogICAgICAgICAgICBzZWdtZW50LnNpemUgID0gMC4yLA0KICAgICAgICAgICAgZm9yY2UgICAgICAgID0gMSwNCiAgICAgICAgICAgIGhqdXN0ICAgICAgICA9ICJyaWdodCIsDQogICAgICAgICAgICBkaXJlY3Rpb24gICAgID0gInkiLA0KICAgICAgICAgICAgc2l6ZSA9IDIuNSwNCiAgICAgICAgICAgIHBvaW50LnBhZGRpbmcgPSAwLjIsDQogICAgICAgICAgICBzZWVkID0gMSwNCiAgICAgICAgICAgIGZvbnRmYWNlID0gImJvbGQiLA0KICAgICAgICAgICAgc2hvdy5sZWdlbmQgPSBGLA0KICAgICAgICAgICAgIyBjb2xvciA9ICJkYXJrcmVkIg0KICAgICAgICAgICAgKSsNCiAgIyBnZW9tX2RsKGFlcyhsYWJlbCA9IHNlYXNvbiksIG1ldGhvZCA9IGxpc3QoZGwuY29tYmluZSggImxhc3QucG9pbnRzIikpLCBjZXggPSAyKSsNCiAgc2NhbGVfeF9jb250aW51b3VzKGJyZWFrcyA9IHNlcSgxMCwyNDAsIDMwKSwgbGltaXRzID1jKDAsMjQwKSkrDQogIGxhYnMoeCA9ICJEYXlzIGFmdGVyIFNlcCAxNXRoIiwNCiAgICAgICB5ID0gIlByZXZhbGVuY2UiLA0KICAgICAgIGNvbG9yID0gIiIsDQogICAgICAgYWxwaGE9IiIpKw0KICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAicmlnaHQiLCB0ZXh0ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNCkNCiAgICAgICAgKSsNCiAgIyBmYWNldF93cmFwKH5lbnNvLCBuY29sID0xKSsNCiAgc2NhbGVfY29sb3JfY29sb3JibGluZCgpKw0KICB0aGVtZV9oYWxmX29wZW4oKQ0KDQoNCmdnc2F2ZSgiZmlncy9kYWlseV9wcmV2YWxlY2UucG5nIiwgZHBpID0gNjAwLCBoZWlnaHQgPSA1LCB3aWR0aCA9IDgpDQoNCmBgYA0KDQoNCiMjIyBUaW1lIHRvIGZpcnNyIHJlcG9ydA0KDQpgYGB7cn0NCm1pbl9zZXAxNSA9IHNicl9yZXAgJT4lIA0KICBncm91cF9ieShzZWFzb24pICU+JSANCiAgc3VtbWFyaXNlKGBUaW1lIHRvIDFzdCByZXBvcnRgID0gYXMubnVtZXJpYyhtaW4oZGF5c19zZXAxNSkpKSAlPiUgDQogIGFycmFuZ2UoYFRpbWUgdG8gMXN0IHJlcG9ydGApDQptaW5fc2VwMTUNCm1lZGlhbihtaW5fc2VwMTUkYFRpbWUgdG8gMXN0IHJlcG9ydGApDQpgYGANCg0KDQpgYGB7cn0NCm1heF9wcmV2YWxhbmNlID0gc2JyX3JlcCAlPiUgDQogIGdyb3VwX2J5KHNlYXNvbiwgZGF5c19zZXAxNSwgcmVnaW9uKSAlPiUgDQogIHN1bW1hcmlzZShjb3VudCA9IG4oKSkgJT4lDQogIGdyb3VwX2J5KHNlYXNvbiwgcmVnaW9uKSAlPiUgDQogIG11dGF0ZShtYXhfcHJldiA9IGN1bXN1bShjb3VudCkpICU+JSANCiAgZmlsdGVyKG1heF9wcmV2ID09IG1heChtYXhfcHJldikpICU+JSANCiAgZHBseXI6OnNlbGVjdCgtZGF5c19zZXAxNSwgLWNvdW50KQ0KDQoNCm1heF9wcmV2ID0gbWF4X3ByZXZhbGFuY2UgJT4lIA0KICBnZ3Bsb3QoYWVzKGFzLm51bWVyaWMoc2Vhc29uKSwgbWF4X3ByZXYsIGNvbG9yID0gcmVnaW9uKSkrDQogIGdlb21fc21vb3RoKG1ldGhvZCA9ICJnYW0iLCBhbHBoYSA9ICAwLjEsIHNpemUgPTIsIGZvcm11bGEgPSB5fnMoeCkpKw0KICBnZW9tX3BvaW50KHNpemUgPTMpKw0KICBsYWJzKHkgPSAiTWF4X3ByZXZhbGVuY2UiLCB4ID0gInNlYXNvbiIpKw0KICBzY2FsZV9jb2xvcl9jb2xvcmJsaW5kKCkNCm1heF9wcmV2DQpgYGANCg0KDQoNCiMjIERhaWx5DQpOdW1iZXIgb3IgbXVuaWNpcGFsaXR5IGJ5IHN0YXRlcw0KYGBge3J9DQpuX211biA9IHNicl9yZXAgJT4lIA0KICBncm91cF9ieShzdGF0ZSkgJT4lDQogIHN1bW1hcmlzZShuX211biA9IGxlbmd0aCh1bmlxdWUobG9jYXRpb24pKSkjICU+JQ0KICAgIyBncm91cF9ieShzdGF0ZSkgJT4lIA0KICAjIHN1bW1hcmlzZShuX211biA9IG1heChuX211bikpDQpgYGANCg0KDQpgYGB7cn0NCnNicl9yZXAgJT4lIA0KICBncm91cF9ieShzZWFzb24sIGRheXNfc2VwMTUpICU+JSANCiAgZHBseXI6OnN1bW1hcmlzZShjb3VudCA9IG4oKSkgJT4lDQogIGdyb3VwX2J5KHNlYXNvbikgJT4lIA0KICBkcGx5cjo6bXV0YXRlKGNvbXVsYXRpY2VfcHJldmFsZW5jZSA9IGN1bXN1bShjb3VudCksDQogICAgICAgICAgICAgICAgZGF5c19zZXAxNSA9IGRheXNfc2VwMTUgLSBtaW4oZGF5c19zZXAxNSkNCiAgICAgICAgICAgICAgICApICU+JSANCiAgZ2dwbG90KGFlcyhkYXlzX3NlcDE1LCBjb211bGF0aWNlX3ByZXZhbGVuY2UpKSsNCiAgZ2VvbV92bGluZSh4aW50ZXJjZXB0ID0gYyg5MCwxMjApLCBsaW5ldHlwZSA9IDIsIGNvbG9yID0gImdyYXk0MCIpKw0KICBnZW9tX2xpbmUoc2l6ZSA9IDEpKw0KICBzY2FsZV9jb2xvcl92aXJpZGlzKGRpc2NyZXRlID0gVCkrDQogIHNjYWxlX3hfY29udGludW91cyhicmVha3MgPSBzZXEoMCwyNDAsIDMwKSkrDQogIGZhY2V0X3dyYXAofnNlYXNvbikrDQogIGxhYnMoeCA9ICJEYXlzIGFmdGVyIFNlcCAxNXRoIiwNCiAgICAgICB5ID0gIkN1bXVsYXRpdmUgcmVwb3J0cyBjb3VudCIsDQogICAgICAgY29sb3IgPSAiIikrDQogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJyaWdodCIsIHRleHQgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE0KQ0KICAgICAgICApDQpgYGANCg0KIyMgSW5mZWN0aW9uIHJhdGUNCg0KYGBge3J9DQpkYXRhX2Zvcl9pbmZfYnIgPSBzYnJfcmVwICU+JSANCiAgZ3JvdXBfYnkoc2Vhc29uLCBkYXlzX3NlcDE1KSAlPiUgDQogIHN1bW1hcmlzZShjb3VudCA9IG4oKSkgJT4lDQogICMgbGVmdF9qb2luKG5fbXVuKSAlPiUgDQogIGdyb3VwX2J5KHNlYXNvbikgJT4lDQogIG11dGF0ZShjdW1fcHJldmFsZW5jZSA9IGN1bXN1bShjb3VudCkvNjM0LCAjKG1heChjdW1zdW0oY291bnQpKSksDQogICAgICAgICBkYXlzX3NlcDE1ID0gZGF5c19zZXAxNSAtIG1pbihkYXlzX3NlcDE1KQ0KICAgICAgICAgKSAlPiUNCiAgbXV0YXRlKHdlZWsgPSBhcy5udW1lcmljKGRheXNfc2VwMTUpKQ0KYGBgDQoNCg0KYGBge3J9DQoNCmZpdHRlZF9jdXJ2ZXNfYnIgPSAgZml0X211bHRpKHRpbWVfY29sID0gIndlZWsiLA0KICAgICAgICAgICAgIGludGVuc2l0eV9jb2wgPSAiY3VtX3ByZXZhbGVuY2UiLA0KICAgICAgICAgICAgIGRhdGEgPSBkYXRhX2Zvcl9pbmZfYnIsDQogICAgICAgICAgICAgc3RyYXRhX2NvbHMgPSBjKCJzZWFzb24iKSwNCiAgICAgICAgICAgICBzdGFydGluZ19wYXIgPSBsaXN0KHkwID0gMC4wMDEsIHIgPSAwLjA1LCBLID0gMC40KSwNCiAgICAgICAgICAgICAgbmxpbiA9IFQsDQogICAgICAgICAgICAgZXN0aW1hdGVfSyA9IFQpDQoNCmBgYA0KDQpgYGB7cn0NCmZpdHRlZF9jdXJ2ZXNfYnIkRGF0YSAlPiUNCiAgbGVmdF9qb2luKGZpdHRlZF9jdXJ2ZXNfYnIkUGFyYW1ldGVycykgJT4lIA0KICAjIGdyb3VwX2J5KHNlYXNvbikgJT4lIA0KICAjIGZpbHRlcihiZXN0X21vZGVsPT0xKSAlPiUNCiAgIyBmaWx0ZXIoUlNFPT1taW4oUlNFKSkgJT4lDQogIGZpbHRlcihtb2RlbCA9PSAiTG9naXN0aWMiKSAlPiUNCiAgZ2dwbG90KGFlcyh0aW1lLHByZWRpY3RlZCkpKw0KICBnZW9tX3BvaW50KGFlcyh0aW1lLHkpLCBjb2xvciA9ImdyYXk3MCIpKw0KICBnZW9tX2xpbmUoc2l6ZSA9IDEpKw0KICBzY2FsZV9jb2xvcl9jb2xvcmJsaW5kKCkrDQogIGZhY2V0X3dyYXAofnNlYXNvbikrDQogIGxhYnMoeCA9ICJEYXlzIGFmdGVyIGZpcnN0IHJlcG9ydCIsIHkgPSAiUHJldmFsZW5jZSIsIGNvbG9yID0iTW9kZWwiLCBsaW5ldHlwZSA9ICJTdGF0ZSIpKw0KICB5bGltKDAsMSkrDQogIHRoZW1lKA0KICAgIGxlZ2VuZC5wb3NpdGlvbiA9ICJyaWdodCIsIHRleHQgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDEyKSwNCiAgICBzdHJpcC50ZXh0ID0gZWxlbWVudF90ZXh0KGNvbG9yID0gImJsYWNrIiksDQogICAgc3RyaXAuYmFja2dyb3VuZCA9IGVsZW1lbnRfcmVjdChmaWxsID0gIndoaXRlIikNCiAgKQ0KIyBnZ3NhdmUoImZpZ3MvZml0dGVkX21vZGVscy5wbmciLCBoZWlnaHQgPSA2LCB3aWR0aCA9IDgpDQpgYGANCg0KYGBge3J9DQpyID0gZml0dGVkX2N1cnZlc19iciRQYXJhbWV0ZXJzICU+JSANCiAgZmlsdGVyKG1vZGVsID09ICJMb2dpc3RpYyIpICU+JSANCiAgZHBseXI6OnNlbGVjdChzZWFzb24sIHkwLHIsIEspICU+JSANCiAgZnVsbF9qb2luKA0KICAgIHNicl9yZXAgJT4lIA0KICBncm91cF9ieShzZWFzb24pICU+JQ0KICBzdW1tYXJpc2Uobl9yZXBvcnRzID0gbGVuZ3RoKHVuaXF1ZShsb2NhdGlvbikpKQ0KICApICU+JQ0KICBmdWxsX2pvaW4oZXBpX3RpbWVfYnIpICU+JSANCiAgbXV0YXRlKFJhdGUgPSAocipLKSkgJT4lIA0KICAjIG11dGF0ZShSYXRlID0gKHIvbl9yZXBvcnRzKSoxMDApICU+JSANCiAgZHBseXI6OnNlbGVjdChzZWFzb24sIFJhdGUpICU+JSANCiAgYXJyYW5nZShSYXRlKQ0Kcg0KYGBgDQoNCg0KYGBge3J9DQpmaXR0ZWRfY3VydmVzX2JyJFBhcmFtZXRlcnMgJT4lIA0KICBmaWx0ZXIobW9kZWwgPT0gIkxvZ2lzdGljIikgJT4lIA0KICBkcGx5cjo6c2VsZWN0KHNlYXNvbiwgciwgSykgJT4lIA0KICBmdWxsX2pvaW4oDQogICAgc2JyX3JlcCAlPiUgDQogIGdyb3VwX2J5KHNlYXNvbikgJT4lDQogIHN1bW1hcmlzZShuX3JlcG9ydHMgPSBsZW5ndGgodW5pcXVlKGxvY2F0aW9uKSkpDQogICkgJT4lDQogIGZ1bGxfam9pbihlcGlfdGltZV9icikgJT4lDQogIG11dGF0ZShSYXRlID0gKHIqSykpICU+JQ0KICBmdWxsX2pvaW4obWluX3NlcDE1KSAlPiUgDQogIGRwbHlyOjpzZWxlY3QoIHNlYXNvbixgVGltZSB0byAxc3QgcmVwb3J0YCwgbl9yZXBvcnRzLCBlcGlkZW1pY190aW1lLCBSYXRlKSAlPiUgDQogIGFycmFuZ2UoUmF0ZSkNCiAgDQpgYGANCg0KYGBge3J9DQpzYnJfcmVwICU+JSANCiAgZ3JvdXBfYnkoc2Vhc29uKSAlPiUNCiAgc3VtbWFyaXNlKG5fcmVwb3J0cyA9IGxlbmd0aCh1bmlxdWUobG9jYXRpb24pKSkgJT4lIA0KICB1bmdyb3VwKCkgJT4lIA0KICBzdW1tYXJpc2UobWVkaWFuKG5fcmVwb3J0cykpDQpgYGANCg0KYGBge3J9DQpmaXR0ZWRfY3VydmVzX2JyJFBhcmFtZXRlcnMgJT4lIA0KICBmaWx0ZXIobW9kZWwgPT0gIkxvZ2lzdGljIikgJT4lIA0KICBkcGx5cjo6c2VsZWN0KHNlYXNvbiwgciwgSykgJT4lIA0KICBmdWxsX2pvaW4oDQogICAgc2JyX3JlcCAlPiUgDQogIGdyb3VwX2J5KHNlYXNvbikgJT4lDQogIHN1bW1hcmlzZShuX3JlcG9ydHMgPSBsZW5ndGgodW5pcXVlKGxvY2F0aW9uKSkpDQogICkgJT4lDQogIGZ1bGxfam9pbihlcGlfdGltZV9icikgJT4lDQogIG11dGF0ZShSYXRlID0gKHIqSykpICU+JQ0KICBmdWxsX2pvaW4obWluX3NlcDE1KSAlPiUgDQogIGRwbHlyOjpzZWxlY3QoIHNlYXNvbixgVGltZSB0byAxc3QgcmVwb3J0YCwgbl9yZXBvcnRzLCBlcGlkZW1pY190aW1lLCBSYXRlKSAlPiUgDQogIGZ1bGxfam9pbihlbnNvZGF0YTIpICU+JSANCiAgZ3JvdXBfYnkoZW5zbykgJT4lIA0KICBzdW1tYXJpc2UobWVkaWFuKGBUaW1lIHRvIDFzdCByZXBvcnRgKSwNCiAgICAgICAgICAgIG1lZGlhbihuX3JlcG9ydHMpLA0KICAgICAgICAgICAgbWVkaWFuKGVwaWRlbWljX3RpbWUpLA0KICAgICAgICAgICAgbWVhbihSYXRlKSkNCmBgYA0KDQoNCg0KDQojIyBBVURQQw0KYGBge3J9DQphdWRwYyA9IHNicl9yZXAgJT4lIA0KICBncm91cF9ieShzZWFzb24sIGRheXNfc2VwMTUpICU+JSANCiAgc3VtbWFyaXNlKGNvdW50ID0gbigpKSAlPiUNCiAgZ3JvdXBfYnkoc2Vhc29uKSAlPiUNCiAgbXV0YXRlKGN1bV9wcmV2YWxlbmNlID0gY3Vtc3VtKGNvdW50KS82MzQpICU+JQ0KICBncm91cF9ieShzZWFzb24pICU+JSANCiAgbXV0YXRlKGRheXNfc2VwMTUgPSBhcy5udW1lcmljKGRheXNfc2VwMTUpKSAlPiUgDQogIHN1bW1hcmlzZShhdWRwYyA9IEFVRFBDKGN1bV9wcmV2YWxlbmNlLCBkYXlzX3NlcDE1KS8obWF4KGRheXNfc2VwMTUpLW1pbihkYXlzX3NlcDE1KSkpDQoNCg0KYXVkcGMlPiUgDQogIGdncGxvdChhZXMoYXMubnVtZXJpYyhzZWFzb24pLCBhdWRwYykpKw0KICAjIGdlb21fbGluZShzaXplID0gMSkrDQogICMgZ2VvbV9wb2ludChzaXplID0gMykrDQogIGdlb21fY29sKHdpZHRoID0gMC41KSsNCiAgIyBnZW9tX3Ntb290aChhbHBoYSA9ICAwLjEsIHNpemUgPTEuNSkrDQogIHNjYWxlX2NvbG9yX2NvbG9yYmxpbmQoKSsNCiAgc2NhbGVfZmlsbF9jb2xvcmJsaW5kKCkrDQogIHNjYWxlX3hfY29udGludW91cyhicmVha3MgPSBjKHNlcSgyMDA1LCAyMDIxLCBieSA9IDEpKSkrDQogIGxhYnMoeCA9ICJIYXJ2ZXN0IHNlYXNvbiIsIHkgPSAiQVVEUEMiKQ0KYGBgDQoNCg0KIyMgdGltZSB0byBwcmV2YWxlbmNlDQoNCmBgYHtyfQ0KdGltZV8yLjUgPSBzYnJfcmVwICU+JSANCiAgZ3JvdXBfYnkoc2Vhc29uLCBkYXlzX3NlcDE1KSAlPiUgDQogIHN1bW1hcmlzZShjb3VudCA9IG4oKSkgJT4lDQogICMgbGVmdF9qb2luKG5fbXVuKSAlPiUgDQogIGdyb3VwX2J5KHNlYXNvbikgJT4lDQogIG11dGF0ZShjdW1fcHJldmFsZW5jZSA9IGN1bXN1bShjb3VudCkvbWF4KGN1bXN1bShjb3VudCkpKSAlPiUNCiAgZ3JvdXBfYnkoc2Vhc29uKSAlPiUgDQogIGZpbHRlcihjdW1fcHJldmFsZW5jZSA8PSAgMC4wMjUpICU+JQ0KICBzdW1tYXJpc2UodGltZV8yLjUgPSBhcy5udW1lcmljKG1heChkYXlzX3NlcDE1KSkpDQoNCnRpbWVfNSA9IHNicl9yZXAgJT4lIA0KICBncm91cF9ieShzZWFzb24sIGRheXNfc2VwMTUsIHN0YXRlKSAlPiUgDQogIHN1bW1hcmlzZShjb3VudCA9IG4oKSkgJT4lDQogICMgbGVmdF9qb2luKG5fbXVuKSAlPiUgDQogIGdyb3VwX2J5KHNlYXNvbikgJT4lDQogIG11dGF0ZShjdW1fcHJldmFsZW5jZSA9IGN1bXN1bShjb3VudCkvbWF4KGN1bXN1bShjb3VudCkpKSAlPiUNCiAgZ3JvdXBfYnkoc2Vhc29uKSAlPiUgDQogIGZpbHRlcihjdW1fcHJldmFsZW5jZSA8PSAgMC4wNSkgJT4lDQogIHN1bW1hcmlzZSh0aW1lXzUgPSBhcy5udW1lcmljKG1heChkYXlzX3NlcDE1KSkpDQoNCnRpbWVfMTAgPSBzYnJfcmVwICU+JSANCiAgZ3JvdXBfYnkoc2Vhc29uLCBkYXlzX3NlcDE1KSAlPiUgDQogIHN1bW1hcmlzZShjb3VudCA9IG4oKSkgJT4lDQogICMgbGVmdF9qb2luKG5fbXVuKSAlPiUgDQogIGdyb3VwX2J5KHNlYXNvbikgJT4lDQogIG11dGF0ZShjdW1fcHJldmFsZW5jZSA9IGN1bXN1bShjb3VudCkvbWF4KGN1bXN1bShjb3VudCkpKSAlPiUNCiAgZ3JvdXBfYnkoc2Vhc29uKSAlPiUgDQogIGZpbHRlcihjdW1fcHJldmFsZW5jZSA8PSAgMC4xKSAlPiUNCiAgc3VtbWFyaXNlKHRpbWVfMTAgPSBhcy5udW1lcmljKG1heChkYXlzX3NlcDE1KSkpDQoNCmFsbF90aW1lcyA9IHRpbWVfMi41ICU+JQ0KICBmdWxsX2pvaW4odGltZV81KSAlPiUgDQogIGxlZnRfam9pbih0aW1lXzEwKQ0KYWxsX3RpbWVzDQogIA0KYGBgDQoNCiMjIFByZXZhbGVuY2UgdG8gdGltZQ0KYGBge3J9DQpwcmV2XzkwID1zYnJfcmVwICU+JQ0KICBncm91cF9ieShzZWFzb24sIGRheXNfc2VwMTUpICU+JSANCiAgc3VtbWFyaXNlKGNvdW50ID0gbigpKSAlPiUNCiAgIyBsZWZ0X2pvaW4obl9tdW4pICU+JSANCiAgZ3JvdXBfYnkoc2Vhc29uKSAlPiUNCiAgbXV0YXRlKGN1bV9wcmV2YWxlbmNlID0gY3Vtc3VtKGNvdW50KSkgJT4lDQogIGdyb3VwX2J5KHNlYXNvbikgJT4lIA0KICBmaWx0ZXIoZGF5c19zZXAxNSA8PSAgYXMubnVtZXJpYygxMDApKSAlPiUNCiAgc3VtbWFyaXNlKHByZXZfMTAwID0gYXMubnVtZXJpYyhtYXgoY3VtX3ByZXZhbGVuY2UpKSkgDQpwcmV2XzEyMCA9c2JyX3JlcCAlPiUNCiAgZ3JvdXBfYnkoc2Vhc29uLCBkYXlzX3NlcDE1KSAlPiUgDQogIHN1bW1hcmlzZShjb3VudCA9IG4oKSkgJT4lDQogICMgbGVmdF9qb2luKG5fbXVuKSAlPiUgDQogIGdyb3VwX2J5KHNlYXNvbikgJT4lDQogIG11dGF0ZShjdW1fcHJldmFsZW5jZSA9IGN1bXN1bShjb3VudCkpICU+JQ0KICBncm91cF9ieShzZWFzb24pICU+JSANCiAgZmlsdGVyKGRheXNfc2VwMTUgPD0gIGFzLm51bWVyaWMoMTMwKSkgJT4lDQogIHN1bW1hcmlzZShwcmV2XzEzMCA9IGFzLm51bWVyaWMobWF4KGN1bV9wcmV2YWxlbmNlKSkpDQoNCnByZXZfYWxsID0gcHJldl85MCAlPiUgDQogIGZ1bGxfam9pbihwcmV2XzEyMCkgJT4lIA0KICBtdXRhdGVfaWYoaXMubnVtZXJpYywgfnJlcGxhY2UoLiwgaXMubmEoLiksIDApKQ0KcHJldl9hbGwNCg0KYGBgDQoNCg0KDQojIyBDdW11bGF0aXZlIHJlcG9ydHMgDQoNCmBgYHtyfQ0Kd2Vla3MgPSBzb3J0KHVuaXF1ZShzYnJfcmVwJHdlZWspKQ0Kc2JyX3JlcF9jdW0gPSBkYXRhLmZyYW1lKCkNCmZvcihpIGluIDE6KGxlbmd0aCh3ZWVrcykpKXsNCiAgDQpjdW11bGF0aXZlID0gc2JyX3JlcCAlPiUNCiAgdW5ncm91cCgpICU+JSANCiAgICBmaWx0ZXIod2VlayA8PSB3ZWVrc1tpXSkgJT4lIA0KICAgIGRwbHlyOjpzZWxlY3Qoc2Vhc29uLHN0YXRlLFBoZW5fc3RhdGUsbGF0X3V0bSwgbG9uX3V0bSwgbGF0LCBsb24sIGRheXMsbW9udGgsIGRheXNfc2VwMTUpICU+JSANCiAgICBtdXRhdGUod2VlayA9IHdlZWtzW2ldKQ0KDQpzYnJfcmVwX2N1bSA9IHNicl9yZXBfY3VtICU+JSANCiAgYmluZF9yb3dzKGN1bXVsYXRpdmUpDQp9DQoNCiMgbWF4KHNicl9yZXAkZGF5cykNCiMgc2JyX3JlcF9jdW0kbW9udGggPSBmYWN0b3Ioc2JyX3JlcF9jdW0kbW9udGgsIGxldmVscyA9IGMoIlNldCIsICJPY3QiLCAiTm92IiwgIkRlYyIsICJKYW4iLCAiRmViIiwgIk1hciIsIkFwciIpKQ0KYGBgDQoNCg0KDQoNCg0KIFZpc3VhbGl6YXRpb24NCmBgYHtyfQ0Kc2JyX3JlcF9jdW0gJT4lDQogIGdyb3VwX2J5KHNlYXNvbiwgd2VlaykgJT4lIA0KICBzdW1tYXJpc2UoY291bnQgPSBuKCkNCiAgICAgICAgICAgICkgJT4lIA0KICBnZ3Bsb3QoYWVzKHdlZWssY291bnQpDQogICAgICAgICApKw0KICBnZW9tX2JhcihzdGF0ID0gImlkZW50aXR5IiwNCiAgICAgICAgICAgcG9zaXRpb24gPSAiZG9kZ2UiLA0KICAgICAgICAgICBjb2xvciA9ICJibGFjayIsDQogICAgICAgICAgIHNpemUgPSAuNSkrDQogIHNjYWxlX2ZpbGxfbWFudWFsKHZhbHVlcyA9IGMoImJsYWNrIiwgImdyYXk0MCIpKSsNCiAgZmFjZXRfd3JhcCh+c2Vhc29uKSsNCiAgbGFicyh4ID0gIk1vbnRoIiwNCiAgICAgICB5ID0gIlJlcG9ydHMgY291bnQiLA0KICAgICAgIGZpbGwgPSAiU2Vhc29uIg0KICAgICAgICkrDQogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gNDUsIGhqdXN0ID0gMSksDQogICAgICAgIGxlZ2VuZC5wb3NpdGlvbiA9ICJub25lIg0KICAgICAgICApDQojIGdnc2F2ZSgiZmlncy9maWczLnBuZyIsIGRwaSA9IDYwMCwgaGVpZ2h0ID0gMTIsIHdpZHRoID0gNikNCmBgYA0KDQoNClNoYXBlIEJSDQpgYGB7cn0NCnNoYXBlX0JSID0gcmVhZE9HUigic2hhcGVmaWxlcy9zaGFwZS1maWxlcy1CUkEiLCJCUkFfYWRtMSIgKQ0KDQpzaGFwZV9CUkBkYXRhJGlkID0gcm93bmFtZXMoc2hhcGVfQlJAZGF0YSkNCkJSX3BvaW50cyA9IGZvcnRpZnkoc2hhcGVfQlIpDQpCUl9kZiA9cGx5cjo6am9pbihCUl9wb2ludHMsIHNoYXBlX0JSQGRhdGEsIGJ5PSJpZCIpDQpgYGANCg0KDQojIFNwYXRpYWwgDQoNCiMjIE5ORA0KDQpgYGB7cn0NCmxhc3Rfbm5kID0gc2JyX3JlcF9jdW0gJT4lDQogIGdyb3VwX2J5KHNlYXNvbiwgd2VlaykgJT4lIA0KICBmaWx0ZXIobigpID4gMSklPiUNCiAgc3VtbWFyaXNlKG1lYW5fbm5kID0gbWVkaWFuKG5uZGlzdChsb25fdXRtLzEwMDAsIGxhdF91dG0vMTAwMCkpKSAlPiUgDQogIGdyb3VwX2J5KHNlYXNvbikgJT4lIA0KICBmaWx0ZXIod2VlayA9PSBsYXN0KHdlZWspKSAlPiUNCiAgbXV0YXRlKGxhc3Rfbm5kID0gbWVhbl9ubmQpICU+JSANCiAgZHBseXI6OnNlbGVjdCgtd2VlaywgLW1lYW5fbm5kKQ0KbGFzdF9ubmQNCmBgYA0KDQpgYGB7cn0NCnNicl9yZXBfY3VtICU+JQ0KICBncm91cF9ieShzZWFzb24sIHdlZWspICU+JSANCiAgZmlsdGVyKG4oKSA+IDEpJT4lDQogIHN1bW1hcmlzZShtZWFuX25uZCA9IG1lZGlhbihubmRpc3QobG9uX3V0bS8xMDAwLCBsYXRfdXRtLzEwMDApKSkgJT4lIA0KICBhcnJhbmdlKG1lYW5fbm5kKSAlPiUgDQogIGZpbHRlcihtZWFuX25uZCA9PSBtYXgobWVhbl9ubmQpKQ0KYGBgDQoNCg0KYGBge3J9DQpmaXJzdF9ubmQgPSBzYnJfcmVwX2N1bSAlPiUNCiAgZ3JvdXBfYnkoc2Vhc29uLCB3ZWVrKSAlPiUgDQogIGZpbHRlcihuKCkgPiAxKSU+JQ0KICBzdW1tYXJpc2UobWVhbl9ubmQgPSBtZWRpYW4obm5kaXN0KGxvbl91dG0vMTAwMCwgbGF0X3V0bS8xMDAwKSkpICU+JSANCiAgZ3JvdXBfYnkoc2Vhc29uKSAlPiUNCiAgZmlsdGVyKHdlZWsgPT0gZmlyc3Qod2VlaykpICU+JQ0KICBtdXRhdGUoZmlyc3Rfbm5kID0gbWVhbl9ubmQpICU+JQ0KICBkcGx5cjo6c2VsZWN0KC13ZWVrLCAtbWVhbl9ubmQpDQpmaXJzdF9ubmQNCmBgYA0KDQoNCmBgYHtyfQ0Kc2JyX3JlcF9jdW0gJT4lDQogIGdyb3VwX2J5KHNlYXNvbiwgd2VlaykgJT4lIA0KICBmaWx0ZXIobigpPjEpJT4lDQogIHN1bW1hcmlzZShtZWFuX25uZCA9IG1lZGlhbihubmRpc3QobG9uX3V0bS8xMDAwLCBsYXRfdXRtLzEwMDApKSkgJT4lIA0KICBnZ3Bsb3QoYWVzKHdlZWssbWVhbl9ubmQpDQogICAgICAgICApKw0KICBnZW9tX2JhcihzdGF0ID0gImlkZW50aXR5IiwNCiAgICAgICAgICAgcG9zaXRpb24gPSAiZG9kZ2UiLA0KICAgICAgICAgICBjb2xvciA9ICJ3aGl0ZSIsDQogICAgICAgICAgIHNpemUgPSAuNSkrDQogICMgc2NhbGVfZmlsbF9jb2xvcmJsaW5kKCkgKyANCiAgc2NhbGVfZmlsbF9tYW51YWwodmFsdWVzID0gYygiYmxhY2siLCAiZ3JheTQwIikpKw0KICBmYWNldF93cmFwKH5zZWFzb24pKw0KICBsYWJzKHggPSAiV2VlayIsDQogICAgICAgeSA9ICJNRWRpYW4gTk5EIiwNCiAgICAgICBmaWxsID0gIlNlYXNvbiINCiAgICAgICApKw0KICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDAsIHZqdXN0ID0gMCksDQogICAgICAgIGxlZ2VuZC5wb3NpdGlvbiA9ICJub25lIg0KICAgICAgICApDQojIGdnc2F2ZSgiZmlncy9ubmQucG5nIiwgZHBpID0gMzAwLCBoZWlnaHQgPSAxMCwgd2lkdGggPSA2KQ0KYGBgDQoNCmBgYHtyfQ0Kbm5kID0gc2JyX3JlcF9jdW0gJT4lDQogIGdyb3VwX2J5KHNlYXNvbiwgd2VlaykgJT4lIA0KICBmaWx0ZXIobigpPjEpJT4lDQogIHN1bW1hcmlzZShtZWFuX25uZCA9IG1lZGlhbihubmRpc3QobG9uX3V0bS8xMDAwLCBsYXRfdXRtLzEwMDApKSkgJT4lIA0KICBmdWxsX2pvaW4oZW5zb2RhdGEyKSAlPiUNCiAgZ2dwbG90KGFlcyh3ZWVrLCBtZWFuX25uZCwgIGdyb3VwID1zZWFzb24sIGNvbG9yID0gZW5zbykpKw0KICBnZW9tX2xpbmUoYWxwaGEgPSAwLjIpKw0KICBnZW9tX3Ntb290aChhZXMoZ3JvdXAgPSBlbnNvKSwgYWxwaGE9MC4yKSsNCiAgc2NhbGVfY29sb3JfY29sb3JibGluZCgpKw0KICBsYWJzKHggPSAiV2VlayIsDQogICAgICAgeSA9ICJNZWRpYW4gTk5EIiwNCiAgICAgICBjb2xvciA9ICIiKSsNCiAgdGhlbWUodGV4dCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTQpKSsNCiAgc2NhbGVfeF9jb250aW51b3VzKGxpbWl0cyA9ICBjKDUsMzUpLCBicmVha3MgPSBzZXEoMCwzNSwgYnkgPSA1KSkrDQogIHRoZW1lX2hhbGZfb3BlbigpKw0KICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAiYm90dG9tIikNCm5uZA0KYGBgDQoNCmBgYHtyfQ0Kbm5kX2Zvcl9nYW0gPSBzYnJfcmVwX2N1bSAlPiUNCiAgZ3JvdXBfYnkoc2Vhc29uLCB3ZWVrKSAlPiUgDQogIGZpbHRlcihuKCk+MSklPiUNCiAgc3VtbWFyaXNlKG1lYW5fbm5kID0gbWVkaWFuKG5uZGlzdChsb25fdXRtLzEwMDAsIGxhdF91dG0vMTAwMCkpKSAlPiUgDQogIGZ1bGxfam9pbihlbnNvZGF0YTIpDQpgYGANCg0KIyMjIyBnYW0gTk5EDQoNCmBgYHtyfQ0KbG1fbm5kID0gbWdjdjo6Z2FtbShtZWFuX25uZCB+IGVuc28rcyh3ZWVrLCBieT0gZW5zbyksDQogICAgICAgICAgICAgICAgICAgIHJhbmRvbSA9IGxpc3Qoc2Vhc29uPX4xKSwNCiAgICAgICAgICAgICAgICAgICAgZmFtaWx5ID1HYW1tYShsaW5rID0gImxvZyIpLA0KICAgICAgICAgICAgICAgICAgICBkYXRhID0gbm5kX2Zvcl9nYW0pDQpzdW1tYXJ5KGxtX25uZCRnYW0pDQpgYGANCg0KYGBge3J9DQpubmQgPSBwbG90X3Ntb290aHMoDQogIG1vZGVsID0gbG1fbm5kJGdhbSwNCiAgc2VyaWVzID0gd2VlaywNCiAgY29tcGFyaXNvbiA9IGVuc28sDQogIHRyYW5zZm9ybSA9IGV4cA0KKSsNCiAgZ3VpZGVzKGZpbGwgPSBGLCBsaW5ldHlwZSA9RikrDQogIHNjYWxlX2NvbG9yX2NvbG9yYmxpbmQoKSsNCiAgc2NhbGVfZmlsbF9tYW51YWwodmFsdWVzID0gYygiZ3JheTUwIiwiZ3JheTUwIiwiZ3JheTUwIikpKw0KICBzY2FsZV9saW5ldHlwZV9tYW51YWwodmFsdWVzID0gYygxLDEsMSkpKw0KICB0aGVtZV9oYWxmX29wZW4oKSsNCiAgZ2VvbV9saW5lKGRhdGEgPSBubmRfZm9yX2dhbSwNCiAgICAgICAgICAgIGFlcyh3ZWVrLG1lYW5fbm5kLCBncm91cCA9IHNlYXNvbiwgY29sb3IgPSBlbnNvKSwNCiAgICAgICAgICAgIGFscGhhID0gMC4yKSsNCiAgZ2VvbV9saW5lKHNpemUgPTEsIGFlcyhjb2xvciA9IGVuc28pKSsNCiAgbGFicyh4ID0gIldlZWsiLA0KICAgICAgIHkgPSAiTk5EIChrbSkiLA0KICAgICAgIGNvbG9yID0gIiIsIA0KICAgICAgIHRpdGxlID0gIk5lYXJlc3QtbmVpZ2hib3IgZGlzdGFuY2VzIikrDQogIHNjYWxlX3hfY29udGludW91cyhsaW1pdHMgPSBjKDgsMzApLCBicmVha3MgPSBzZXEoNSwzMCxieSA9NSkpKw0KICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIpDQpubmQNCmBgYA0KDQoNCiMjIEFyZWENCkV4YW1wbGUNCmBgYHtyfQ0KZGF0IDwtIG1hdHJpeChzdGF0czo6cm5vcm0oNiksIG5jb2wgPSAyKQ0KY2ggPC0gY2h1bGwoZGF0KQ0KY29vcmRzIDwtIGRhdFtjKGNoLCBjaFsxXSksIF0gICMgY2xvc2VkIHBvbHlnb24NCg0KIyBwbG90KGRhdCwgcGNoPTE5KQ0KIyBsaW5lcyhjb29yZHMsIGNvbD0gInJlZCIpDQpwb2wxIDwtIHNwUG9seWdvbnMoY29vcmRzLCBjcnM9Iitwcm9qPXV0bSArem9uZT0yMiArZGF0dW09V0dTODQiKQ0KIyByYXN0ZXI6OmFyZWEocG9sMSkNCg0KYGBgDQoNCmBgYHtyfQ0KYXJlYV9jYWxjID0gZnVuY3Rpb24obG9uLCBsYXQpew0KbGF0ID0gYXMubWF0cml4KGxhdCkNCmxvbiA9IGFzLm1hdHJpeChsb24pDQpkYXQgPSBjYmluZChsb24sbGF0KQ0KY2ggPC0gY2h1bGwoZGF0KQ0KY29vcmRzIDwtIGRhdFtjKGNoLCBjaFsxXSksIF0gICMgY2xvc2VkIHBvbHlnb24NCg0KcG9sMSA8LSBzcFBvbHlnb25zKGNvb3JkcywgY3JzPSIrcHJvaj11dG0gK3pvbmU9MjIgK2RhdHVtPVdHUzg0IikNCmFyZWExID0gcmFzdGVyOjphcmVhKHBvbDEpDQpyZXR1cm4oYXMubnVtZXJpYyhhcmVhMSkpDQp9DQpgYGANCg0KIyMjIE1heCBhcmVhDQpgYGB7cn0NCmFyZWFzX3N0YXRzID0gc2JyX3JlcF9jdW0gJT4lDQogIGdyb3VwX2J5KHNlYXNvbiwgd2VlaykgJT4lIA0KICBmaWx0ZXIobigpPj0zKSU+JQ0KICBzdW1tYXJpc2UoYXJlYSA9IGFyZWFfY2FsYyhsb24gPSBsb25fdXRtLCBsYXQgPSBsYXRfdXRtKS8xMDAwMDAwKSAlPiUNCiAgIyBtdXRhdGUoYXJlYV9zdGF0ZSA9IGNhc2Vfd2hlbihzdGF0ZSA9PSAiUFIiIH4gMTk5MzA3LjkyMiAsDQogICMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUgPT0gIlJTIiB+MjgxNzMwLjIyMyApKSAlPiUgDQogIGdyb3VwX2J5KHNlYXNvbikgJT4lIA0KICBzdW1tYXJpc2UobWF4X2FyZWEgPSBtYXgoYXJlYSksIG1pbl9hcmVhID0gbWluKGFyZWEpKQ0KYXJlYXNfc3RhdHMgJT4lIA0KICBhcnJhbmdlKG1heF9hcmVhKQ0KYGBgDQoNCiMjIFZpc3VhbGl6YXRpb24NCmBgYHtyfQ0KYXJlYV9kZiA9IHNicl9yZXBfY3VtICU+JQ0KICBncm91cF9ieShzZWFzb24sIHdlZWspICU+JSANCiAgZmlsdGVyKG4oKT49MyklPiUNCiAgc3VtbWFyaXNlKGFyZWEgPSBhcmVhX2NhbGMobG9uID0gbG9uX3V0bSwgbGF0ID0gbGF0X3V0bSkvMTAwMDAwMCkNCg0KYXJlYV9kZjIgPSBhcmVhX2RmICU+JSANCiAgZnVsbF9qb2luKGVuc29kYXRhMikgJT4lIA0KICBncm91cF9ieShzZWFzb24pICU+JSANCiAgbXV0YXRlKGRpZiA9IChgYXJlYWApLWxhZyhhcmVhKSkgJT4lIA0KICB1bmdyb3VwKCkgJT4lIA0KICBmaWx0ZXIoZGlmICE9IDApDQpgYGANCg0KIyMjIyMgcmF0ZSBvZiBpbmNyZWFzZSBpbiB0aGUgZXBpZGVtaWMgYXJlYQ0KYGBge3J9DQphcmVhX3JhdGUgPSBhcmVhX2RmMiAlPiUgDQogIGdyb3VwX2J5KHNlYXNvbikgJT4lIA0KICBzdW1tYXJpc2UocmF0ZV9hcmVhID0gbWVhbihkaWYpKQ0KYGBgDQoNCg0KDQoNCmBgYHtyfQ0KYXJlYSA9IGFyZWFfZGYyICAlPiUNCiAgIyBmdWxsX2pvaW4oZW5zb2RhdGEyKSAlPiUgDQogIGdncGxvdChhZXMod2VlaywgYXJlYS8xMDAwMCwgZ3JvdXAgPSBzZWFzb24sIGNvbG9yID1lbnNvKSkrDQogIGdlb21fbGluZShhbHBoYSA9IDAuMikrDQogIGdlb21fc21vb3RoKGFlcyhncm91cCA9IGVuc28pLCBhbHBoYT0wLjIpKw0KICBzY2FsZV9jb2xvcl9jb2xvcmJsaW5kKCkgKyANCiAgbGFicyh4ID0gIldlZWsiLA0KICAgICAgIHkgPSBleHByZXNzaW9uKHBhc3RlKCJBcmVhIDEwIl40LCAiIGttwrIiKSksDQogICAgICAgY29sb3IgPSAiIikrDQogIHRoZW1lKHRleHQgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE0KSkrDQogIHNjYWxlX3hfY29udGludW91cyhsaW1pdHMgPSAgYyg1LDM1KSwgYnJlYWtzID0gc2VxKDAsMzUsIGJ5ID0gNSkpKw0KICB0aGVtZV9oYWxmX29wZW4oKSsNCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uID0gImJvdHRvbSIpDQoNCmFyZWEgDQogICMgZ2dzYXZlKCJmaWdzL2FyZWEucG5nIiwgZHBpID0gNjAwLCBoZWlnaHQgPSA0LCB3aWR0aCA9IDgpDQogIA0KYGBgDQoNCg0KIyMjIyBnYW0gYXJlYQ0KYGBge3J9DQpsbV9hcmVhID0gbWdjdjo6Z2FtbShhcmVhLzEwMDAwIH4gZW5zbytzKHdlZWssIGJ5PSBlbnNvKSwNCiAgICAgICAgICAgICAgICAgICAgIHJhbmRvbSA9IGxpc3Qoc2Vhc29uPX4xKSwNCiAgICAgICAgICAgICAgICAgICAgIGZhbWlseSA9R2FtbWEobGluayA9ICJsb2ciKSwNCiAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBhcmVhX2RmJT4lIA0KICAgICAgICAgICAgICAgICAgICAgICBmdWxsX2pvaW4oZW5zb2RhdGEyKSkNCnN1bW1hcnkobG1fYXJlYSRnYW0pDQojIHBsb3QobG1fYXJlYSRnYW0pDQpgYGANCg0KYGBge3J9DQphcmVhID1wbG90X3Ntb290aHMoDQogIG1vZGVsID0gbG1fYXJlYSRnYW0sDQogIHNlcmllcyA9IHdlZWssDQogIGNvbXBhcmlzb24gPSBlbnNvLA0KICB0cmFuc2Zvcm0gPSBleHANCikrDQogIGd1aWRlcyhmaWxsID0gRiwgbGluZXR5cGUgPUYpKw0KICBzY2FsZV9jb2xvcl9jb2xvcmJsaW5kKCkrDQogIHNjYWxlX2ZpbGxfbWFudWFsKHZhbHVlcyA9IGMoImdyYXk1MCIsImdyYXk1MCIsImdyYXk1MCIpKSsNCiAgc2NhbGVfbGluZXR5cGVfbWFudWFsKHZhbHVlcyA9IGMoMSwxLDEpKSsNCiAgdGhlbWVfaGFsZl9vcGVuKCkrDQogIGdlb21fbGluZShkYXRhID0gYXJlYV9kZiAlPiUgZnVsbF9qb2luKGVuc29kYXRhMiksDQogICAgICAgICAgICBhZXMod2VlayxhcmVhLzEwMDAwLCBncm91cCA9IHNlYXNvbiwgY29sb3IgPSBlbnNvKSwNCiAgICAgICAgICAgIGFscGhhID0gMC4yKSsNCiAgZ2VvbV9saW5lKHNpemUgPTEsIGFlcyhjb2xvciA9IGVuc28pKSsNCiAgbGFicyh4ID0gIldlZWsiLA0KICAgICAgIHkgPSBleHByZXNzaW9uKHBhc3RlKCJBcmVhIDEwIl40LCAiIGttwrIiKSksDQogICAgICAgY29sb3IgPSAiIiwNCiAgICAgICB0aXRsZSA9ICJFcGlkZW1pYyBhcmVhIikrDQogIHNjYWxlX3hfY29udGludW91cyhsaW1pdHMgPSBjKDgsMzApLCBicmVha3MgPSBzZXEoNSwzMCxieSA9NSkpKw0KICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAiYm90dG9tIikNCmFyZWENCmBgYA0KDQoNCg0KIyMgRGVuc2l0eSBpbmRleCANCg0KYGBge3J9DQp3ZWVrX2NvdW50ID0gc2JyX3JlcF9jdW0gJT4lDQogIGdyb3VwX2J5KHNlYXNvbiwgd2VlaykgJT4lIA0KICBmaWx0ZXIobigpPj0zKSU+JQ0KICBzdW1tYXJpc2UoY291bnQgPSBuKCkpICU+JSANCiAgIyBncm91cF9ieShzZWFzb24pICU+JSANCiAgIyBkcGx5cjo6bXV0YXRlKHByZXZhbGVuY2UgPSBjdW1zdW0oY291bnQpKSAlPiUgDQogIGZ1bGxfam9pbihhcmVhX2RmKSAlPiUNCiAgbXV0YXRlKGRlbnNpdHkgPSAgY291bnQvYXJlYSwNCiAgICAgICAgIGRlbnNpdHkgPSBjYXNlX3doZW4oZGVuc2l0eT4wLjAwMiB+IDAuMDAyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZW5zaXR5PD0wLjAyIH4gZGVuc2l0eSkpICU+JSANCiAgbXV0YXRlKHBlcmlvZCA9ICBjYXNlX3doZW4oc2Vhc29uID4gMjAxMSB+ICJQT1N0IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vhc29uIDw9IDIwMTEgfiAiUFJFIikpICU+JQ0KICBmdWxsX2pvaW4oZW5zb2RhdGEyKQ0KDQoNCmRlbnNpdHkgPSB3ZWVrX2NvdW50ICAgJT4lIA0KICBnZ3Bsb3QoYWVzKHdlZWssIGRlbnNpdHksIGdyb3VwID0gc2Vhc29uLCBjb2xvcj1lbnNvKSkrDQogIGdlb21fbGluZShhbHBoYSA9IDAuMikrDQogIGdlb21fc21vb3RoKGFlcyhncm91cCA9IGVuc28pLCBhbHBoYT0wLjIsIG1ldGhvZD0gImdhbSIsIGZvcm11bGEgPSB5IH5zKHgpKSsNCiAgc2NhbGVfeV9sb2cxMCgpKw0KICBzY2FsZV9jb2xvcl9jb2xvcmJsaW5kKCkrDQogIGxhYnMoeSA9ICJEZW5zaXR5IiwgeCA9IldlZWsiLCBjb2xvciA9ICIiKSsNCiAgdGhlbWUodGV4dCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTQpKSsNCiAgc2NhbGVfeF9jb250aW51b3VzKGxpbWl0cyA9ICBjKDUsMzUpLCBicmVha3MgPSBzZXEoMCwzNSwgYnkgPSA1KSkrDQogIHRoZW1lX2hhbGZfb3BlbigpKw0KICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAiYm90dG9tIikNCiAgDQpkZW5zaXR5DQoNCmBgYA0KIyMjIyBnYW0gZGVuc2l0eQ0KDQpgYGB7cn0NCmxtX2RlbnMgPSBtZ2N2OjpnYW1tKGRlbnNpdHkqMTAwMCB+IGVuc28rcyh3ZWVrLCBieT0gZW5zbywgaz0xMCwgYnM9ICJjciIpLA0KICAgICAgICAgICAgICAgICAgICByYW5kb20gPSBsaXN0KHNlYXNvbj1+MSksDQogICAgICAgICAgICAgICAgICAgIGZhbWlseSA9R2FtbWEobGluayA9ICJsb2ciKSwNCiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHdlZWtfY291bnQpDQpzdW1tYXJ5KGxtX2RlbnMkZ2FtKQ0KYGBgDQoNCmBgYHtyfQ0KZGVuc2l0eSA9IHBsb3Rfc21vb3RocygNCiAgbW9kZWwgPSBsbV9kZW5zJGdhbSwNCiAgc2VyaWVzID0gd2VlaywNCiAgY29tcGFyaXNvbiA9IGVuc28sDQogIHRyYW5zZm9ybSA9IGV4cA0KKSsNCiAgZ3VpZGVzKGZpbGwgPSBGLCBsaW5ldHlwZSA9RikrDQogIHNjYWxlX2NvbG9yX2NvbG9yYmxpbmQoKSsNCiAgc2NhbGVfZmlsbF9tYW51YWwodmFsdWVzID0gYygiZ3JheTUwIiwiZ3JheTUwIiwiZ3JheTUwIikpKw0KICBzY2FsZV9saW5ldHlwZV9tYW51YWwodmFsdWVzID0gYygxLDEsMSkpKw0KICB0aGVtZV9oYWxmX29wZW4oKSsNCiAgZ2VvbV9saW5lKGRhdGEgPSB3ZWVrX2NvdW50LA0KICAgICAgICAgICAgYWVzKHdlZWssZGVuc2l0eSoxMDAwLCBncm91cCA9IHNlYXNvbiwgY29sb3IgPSBlbnNvKSwNCiAgICAgICAgICAgIGFscGhhID0gMC4yKSsNCiAgc2NhbGVfeF9jb250aW51b3VzKGxpbWl0cyA9IGMoOCwzMCksIGJyZWFrcyA9IHNlcSg1LDMwLGJ5ID01KSkrDQogIGdlb21fbGluZShzaXplID0xLCBhZXMoY29sb3IgPSBlbnNvKSkrDQogIGxhYnMoeCA9ICJXZWVrIiwNCiAgICAgICB5ID0gIkRlbnNpdHkiLA0KICAgICAgIGNvbG9yID0gIiIsDQogICAgICAgdGl0bGUgPSAiU3BhdGlhbCBkZW5zaXR5IikrDQogIGNvb3JkX2NhcnRlc2lhbih5bGltID0gYygwLDEuMikpKw0KICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIpDQpkZW5zaXR5DQpgYGANCg0KDQoNCg0KIyMgQ29ycmVsYXRpb24gd2Vla2x5IGFyZWENCg0KDQpgYGB7cn0NCmFyZWFfZGYgJT4lDQogIGdyb3VwX2J5KHNlYXNvbikgJT4lIA0KICBtdXRhdGUobGFzdF9hcmVhID0gbGFzdChhcmVhKSkgJT4lDQogIGdyb3VwX2J5KHdlZWspICU+JSANCiAgZmlsdGVyKG4oKT4yKSAlPiUNCiAgZ2dwbG90KGFlcyhhcmVhLCBsYXN0X2FyZWEpKSsNCiAgZ2VvbV9wb2ludCgpKw0KICBnZW9tX2FibGluZShpbnRlcmNlcHQgPSAwLCBzbG9wZSA9IDEsIGNvbG9yID0gICJyZWQiKSsNCiAgZ2VvbV9zbW9vdGgobWV0aG9kID0gImxtIiwgc2UgPUYpKw0KICBmYWNldF93cmFwKH53ZWVrKSsNCiAgdGhlbWUoI2xlZ2VuZC5wb3NpdGlvbiA9ICJub25lIiwNCiAgICAgICAgcGFuZWwuYmFja2dyb3VuZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgcGFuZWwuZ3JpZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgcGFuZWwuYm9yZGVyID0gZWxlbWVudF9ibGFuaygpLA0KICAgICAgICBheGlzLmxpbmUueCA9IGVsZW1lbnRfbGluZShjb2xvciA9ICJibGFjayIpLA0KICAgICAgICBheGlzLmxpbmUueSA9IGVsZW1lbnRfbGluZShjb2xvciA9ICJibGFjayIpLA0KICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDApKQ0KYGBgDQoNCg0KDQoNCmBgYHtyfQ0KYXJlYV9kZiAlPiUNCiAgZ3JvdXBfYnkoc2Vhc29uKSAlPiUgDQogIG11dGF0ZShsYXN0X2FyZWEgPSBsYXN0KGFyZWEpKSAlPiUNCiAgZ3JvdXBfYnkod2VlaykgJT4lIA0KICBmaWx0ZXIobigpPjIpICU+JSANCiAgc3VtbWFyaXNlKGNvciA9IGNvci50ZXN0KGFyZWEsIGxhc3RfYXJlYSkkZXN0aW1hdGUsDQogICAgICAgICAgICBwX3ZhbHVlID0gY29yLnRlc3QoYXJlYSwgbGFzdF9hcmVhKSRwLnZhbHVlKSAlPiUNCiAgZmlsdGVyKHBfdmFsdWUgPDAuMDUpICU+JQ0KICBnZ3Bsb3QoYWVzKHdlZWssIGNvcikpKw0KICAjIHlsaW0oMCwxKSsNCiAgZ2VvbV9saW5lKCkrDQogIGdlb21fcG9pbnQoYWVzKHNpemUgPSBwX3ZhbHVlKSkrDQogIHNjYWxlX3hfY29udGludW91cyhicmVha3MgPSBzZXEoMCwzMixieSA9IDIpKSsNCiAgdGhlbWUoI2xlZ2VuZC5wb3NpdGlvbiA9ICJub25lIiwNCiAgICAgICAgcGFuZWwuYmFja2dyb3VuZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgcGFuZWwuZ3JpZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgcGFuZWwuYm9yZGVyID0gZWxlbWVudF9ibGFuaygpLA0KICAgICAgICBheGlzLmxpbmUueCA9IGVsZW1lbnRfbGluZShjb2xvciA9ICJibGFjayIpLA0KICAgICAgICBheGlzLmxpbmUueSA9IGVsZW1lbnRfbGluZShjb2xvciA9ICJibGFjayIpLA0KICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDApKSAgDQoNCg0KYGBgDQoNCiMjIE1heCBkaXN0YW5jZQ0KYGBge3J9DQpib3gxID0gZGF0YS5mcmFtZSgpDQpzZWFzb25zID0gYXMubnVtZXJpYyh1bmlxdWUoc2JyX3JlcCRzZWFzb24pKQ0KZm9yKGkgaW4gMTpsZW5ndGgoc2Vhc29ucykpew0KDQoNCnNicl9kaXN0MSA9IHNicl9yZXAgJT4lIA0KICBtdXRhdGUoc2Vhc29uID0gYXMubnVtZXJpYyhzZWFzb24pKSAlPiUgDQogIGZpbHRlcihzZWFzb24gPT0gc2Vhc29uc1tpXSkgDQoNCndlZWtzMSA9IHVuaXF1ZShzYnJfZGlzdDEkd2VlaykNCg0KDQpmb3IoaiBpbiAxOmxlbmd0aCh3ZWVrczEpKXsNCnNicl9kaXN0MiA9IHNicl9kaXN0MSU+JSANCiAgZmlsdGVyKHdlZWsgPD0gd2Vla3MxW2pdKSAlPiUNCiAgZHBseXI6OnNlbGVjdChsb25fdXRtLCBsYXRfdXRtKSAlPiUgDQogIG11dGF0ZShJRCA9IDE6bGVuZ3RoKGxvbl91dG0pLA0KICAgICAgICAgWlpaID0gMSkgDQogIA0KDQoNCg0KZGlzdF9kZiA9IHNicl9kaXN0MiAlPiUgDQogIGZ1bGxfam9pbihzYnJfZGlzdDIsYygiWlpaIj0iWlpaIikpICU+JSANCiAgZmlsdGVyKElELnggIT0gSUQueSkgJT4lIA0KICAgICAgICBtdXRhdGUoZGlzdD1zcXJ0KChsb25fdXRtLngtbG9uX3V0bS55KV4yICsgKGxhdF91dG0ueC1sYXRfdXRtLnkpXjIpKSAlPiUgDQogIGFycmFuZ2UoZGlzdCkNCg0KZCA9IG1heChkaXN0X2RmJGRpc3QsIG5hLnJtID0gVCkvMTAwMA0KDQpsaWxfYm94ID0gZGF0YS5mcmFtZShzZWFzb24gPSBzZWFzb25zW2ldLCB3ZWVrICA9IHdlZWtzMVtqXSwgZGlzdCA9IGQpDQpib3gxID0gYm94MSAlPiUgDQogIGJpbmRfcm93cyhsaWxfYm94KQ0KfQ0KDQp9DQpgYGANCg0KDQpgYGB7cn0NCmJveDFfZGlzdCA9IGJveDEgJT4lDQogIG11dGF0ZShzZWFzb24gPSBhcy5jaGFyYWN0ZXIoc2Vhc29uKSkgJT4lIA0KICBmdWxsX2pvaW4oZW5zb2RhdGEyKSU+JSANCiAgZmlsdGVyKCFpcy5pbmZpbml0ZShkaXN0KSkNCmBgYA0KDQojIyMjIGdhbSBkaXN0DQpgYGB7cn0NCmxtX2Rpc3QgPSBtZ2N2OjpnYW1tKGRpc3QgfiBlbnNvK3Mod2VlaywgYnk9IGVuc28pLA0KICAgICAgICAgICAgICAgICAgICAgcmFuZG9tID0gbGlzdChzZWFzb249fjEpLA0KICAgICAgICAgICAgICAgICAgICAgZmFtaWx5ID1HYW1tYShsaW5rID0gImxvZyIpLA0KICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGJveDFfZGlzdCkNCnN1bW1hcnkobG1fZGlzdCRnYW0pDQojIHBsb3QobG1fYXJlYSRnYW0pDQpgYGANCg0KYGBge3J9DQpkaXN0X3Bsb3QgPXBsb3Rfc21vb3RocygNCiAgbW9kZWwgPSBsbV9kaXN0JGdhbSwNCiAgc2VyaWVzID0gd2VlaywNCiAgY29tcGFyaXNvbiA9IGVuc28sDQogIHRyYW5zZm9ybSA9IGV4cA0KKSsNCiAgZ3VpZGVzKGZpbGwgPSBGLCBsaW5ldHlwZSA9RikrDQogIHNjYWxlX2NvbG9yX2NvbG9yYmxpbmQoKSsNCiAgc2NhbGVfZmlsbF9tYW51YWwodmFsdWVzID0gYygiZ3JheTUwIiwiZ3JheTUwIiwiZ3JheTUwIikpKw0KICBzY2FsZV9saW5ldHlwZV9tYW51YWwodmFsdWVzID0gYygxLDEsMSkpKw0KICB0aGVtZV9oYWxmX29wZW4oKSsNCiAgZ2VvbV9saW5lKGRhdGEgPSBib3gxX2Rpc3QsDQogICAgICAgICAgICBhZXMod2VlayxkaXN0LCBncm91cCA9IHNlYXNvbiwgY29sb3IgPSBlbnNvKSwNCiAgICAgICAgICAgIGFscGhhID0gMC4yKSsNCiAgZ2VvbV9saW5lKHNpemUgPTEsIGFlcyhjb2xvciA9IGVuc28pKSsNCiAgbGFicyh4ID0gIldlZWsiLA0KICAgICAgIHkgPSAiRGlzdGFuY2UgKGttKSIsDQogICAgICAgY29sb3IgPSAiIiwNCiAgICAgICB0aXRsZSA9ICJFcGlkZW1pYyBmcm9udCIpKw0KICBzY2FsZV94X2NvbnRpbnVvdXMobGltaXRzID0gYyg4LDMwKSwgYnJlYWtzID0gc2VxKDUsMzAsYnkgPTUpKSsNCiAgY29vcmRfY2FydGVzaWFuKHlsaW0gPSBjKDAsMTMwMCkpKw0KICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIpDQpkaXN0X3Bsb3QNCmBgYA0KDQoNCg0KDQojIyMjIyBDb21ibw0KDQpgYGB7cn0NCm5uZCtkaXN0X3Bsb3QrYXJlYStkZW5zaXR5Kw0KICBwbG90X2xheW91dChucm93ID0gMikrDQogIHBsb3RfYW5ub3RhdGlvbih0YWdfbGV2ZWxzID0gIkEiKSYNCiAgdGhlbWUocGxvdC50aXRsZSA9IGVsZW1lbnRfdGV4dChzaXplID0gMTEpKQ0KZ2dzYXZlKCJmaWdzL25uZF9hcmVhLnBuZyIsIGRwaSA9IDYwMCwgaGVpZ2h0ID04LCB3aWR0aCA9MTApDQoNCmBgYA0KDQoNCiMjIyMgVGFibGUNCg0KYGBge3J9DQpsYXN0X25uZCAlPiUgDQogIGZ1bGxfam9pbihhcmVhc19zdGF0c1ssMToyXSAlPiUgDQogICAgICAgICAgICAgIG11dGF0ZShtYXhfYXJlYSA9IG1heF9hcmVhLzEwMDAwKSkgJT4lIA0KICBmdWxsX2pvaW4oYXJlYV9yYXRlICU+JSBtdXRhdGUocmF0ZV9hcmVhID0gcmF0ZV9hcmVhLzEwMDAwKSkgJT4lIA0KICBmdWxsX2pvaW4od2Vla19jb3VudCAlPiUgDQogICAgZ3JvdXBfYnkoc2Vhc29uKSAlPiUgDQogICAgZmlsdGVyKHdlZWsgPT0gbWF4KHdlZWspKSAlPiUgDQogICAgZHBseXI6OnNlbGVjdChzZWFzb24sIGRlbnNpdHkpICU+JSBtdXRhdGUoZGVuc2l0eSA9IGRlbnNpdHkqMTAwMDApKSAlPiUgDQogIGZ1bGxfam9pbihib3gxX2Rpc3QgJT4lIA0KICAgIGdyb3VwX2J5KHNlYXNvbikgJT4lIA0KICAgIGZpbHRlcih3ZWVrID09IG1heCh3ZWVrKSklPiUgDQogICAgZHBseXI6OnNlbGVjdChzZWFzb24sIGRpc3QpKSAlPiUgDQogIGZ1bGxfam9pbihlbnNvZGF0YTJbMTM6MTRdKSAlPiUgDQogIGFycmFuZ2UoZGlzdCkgJT4lDQogIHVuZ3JvdXAoKSAlPiUgDQogICMgZ3JvdXBfYnkoZW5zbykgJT4lIA0KICBzdW1tYXJpc2UobWVhbihkaXN0KSkNCmBgYA0KDQoNCiMgUHJpbmNpcGFsIGNvbXBvbmVudHMgYW5hbHlzaXMNCmxpYnJhcmllcw0KDQoNCg0KDQpnYXRoZXJpbmcgdGhlIHZhcmlhYmxlcw0KIA0KYGBge3J9DQpwY2FfZGF0YSA9IGVwaV90aW1lICU+JSANCiAgZnVsbF9qb2luKG1heF9wcmV2YWxhbmNlKSAlPiUgDQogIGZ1bGxfam9pbihyKSAlPiUNCiAgZnVsbF9qb2luKGF1ZHBjKSAlPiUNCiAgZnVsbF9qb2luKHRpbWVfMTApICU+JQ0KICBmdWxsX2pvaW4obWluX3NlcDE1KSAlPiUgDQogICMgZnVsbF9qb2luKHRpbWVfdG9fb3V0YnJlYWspICU+JQ0KICAjIGZ1bGxfam9pbihsYXN0X25uZCkgJT4lDQogIGZ1bGxfam9pbihmaXJzdF9ubmQpICU+JQ0KICBmdWxsX2pvaW4oYXJlYXNfc3RhdHMpICU+JQ0KICBmdWxsX2pvaW4ocHJldl9hbGwpICU+JSANCiAgZHBseXI6OnNlbGVjdCgtcmVnaW9uKQ0KcGNhX2RhdGENCmBgYA0KIA0KY29ycmVsb2dyYW0NCg0KDQoNCmBgYHtyIGZpZy5oZWlnaHQ9MTAsIGZpZy53aWR0aD0xMH0NCmdncGFpcnMocGNhX2RhdGFbLC0xXSwgcHJvZ3Jlc3MgPSBGQUxTRSkrDQogIHRoZW1lX2J3KCkNCmBgYA0KDQogDQogDQojIyBQQ0ENCiANCiANCmBgYHtyfQ0KDQoNCnBjYTEgPSBwcmNvbXAocGNhX2RhdGFbLC0xXSAsIGNlbnRlciA9IFRSVUUsIHNjYWxlLiA9IFRSVUUpDQpzdW1tYXJ5KHBjYTEpDQpgYGANCg0KYGBge3IgZmlnLmhlaWdodD0zLCBmaWcud2lkdGg9NX0NCmZtX3BjYTEgPSBQQ0EocGNhX2RhdGFbLC0xXSxncmFwaCA9IEZBTFNFKQ0KZnZpel9zY3JlZXBsb3QoZm1fcGNhMSkNCmBgYA0KDQpgYGB7ciBmaWcuaGVpZ2h0PTMsIGZpZy53aWR0aD0xMH0NCnBsb3RfZ3JpZChmdml6X2NvbnRyaWIoZm1fcGNhMSwgY2hvaWNlID0gInZhciIsIGF4ZXMgPSAxKSwNCiAgICAgICAgICBmdml6X2NvbnRyaWIoZm1fcGNhMSwgY2hvaWNlID0gInZhciIsIGF4ZXMgPSAyKSkNCmBgYA0KDQoNCmBgYHtyIGZpZy5oZWlnaHQ9MywgZmlnLndpZHRoPTV9DQpmdml6X2NvbnRyaWIoZm1fcGNhMSwgY2hvaWNlID0gInZhciIsIGF4ZXMgPSAxOjIpDQpgYGANCg0KDQojIyBiaXBsb3QNCmBgYHtyIGZpZy5oZWlnaHQ9NSwgZmlnLndpZHRoPTd9DQpmdml6X3BjYV9iaXBsb3QoZm1fcGNhMSwNCiAgICAgICAgICAgICAgICBjb2wudmFyPSJjb250cmliIiwNCiAgICAgICAgICAgICAgICByZXBlbCA9IFRSVUUsIA0KICAgICAgICAgICAgICAgIGNvbC5pbmQgPSBOQSkrDQogIGdlb21fdGV4dChhZXMobGFiZWwgPSBwY2FfZGF0YSRzZWFzb24pLA0KICAgICAgICAgICAgICAgICAgIGZvbnRmYWNlID0gImJvbGQiLA0KICAgICAgICAgICAgICAgICAgc2l6ZSA9IDQsDQogICAgICAgICAgICAgICAgICAgY29sb3IgPSAiYmxhY2siLA0KICAgICAgICAgICAgICAgICAgIGFscGhhPSAxKSsNCiAgc2NhbGVfY29sb3JfdmlyaWRpcyhvcHRpb24gPSAiQiIsIGRpcmVjdGlvbiA9IC0xLCBlbmQgPSAwLjgsIGJlZ2luID0gMC4yKSsNCiAgY29vcmRfZXF1YWwoKSsNCiAgbGFicyh0aXRsZSA9IiIpDQoNCiMgZ2dzYXZlKCJmaWdzL3BjYS5wbmciLCBkcGkgPSA2MDAsIGhlaWdodCA9IDYsIHdpZHRoID0gOCkNCmBgYA0KDQpgYGB7cn0NCnBjYV9kYXRhMiA9IHBjYV9kYXRhICU+JSBmdWxsX2pvaW4oZW5zb2RhdGEyWywxMzoxNF0pDQoNCmZ2aXpfcGNhX2luZChmbV9wY2ExLA0KICAgICAgICAgICAgICMgY29sLnZhcj0iY29udHJpYiIsDQogICAgICAgICAgICAgaGFiaWxsYWdlID0gcGNhX2RhdGEyJGVuc28sDQogICAgICAgICAgICAgcmVwZWwgPSBUUlVFLA0KICAgICAgICAgICAgIGxhYmVsID0gIm5vbmUiLA0KICAgICAgICAgICAgIGFkZEVsbGlwc2VzID0gVCwNCiAgICAgICAgICAgICBwb2ludHNoYXBlID0gNzUsDQogICAgICAgICAgICAgY29sLmluZCA9IE5BLA0KICAgICAgICAgICAgIGVsbGlwc2UubGV2ZWw9MC44KSsNCiAgZ2VvbV90ZXh0KGFlcyhsYWJlbCA9IHBjYV9kYXRhMiRzZWFzb24sIGNvbG9yID1wY2FfZGF0YTIkZW5zbyksDQogICAgICAgICAgICAjIGZvbnRmYWNlID0gImJvbGQiLA0KICAgICAgICAgICAgc2l6ZSA9IDQsDQogICAgICAgICAgICBzaG93LmxlZ2VuZCA9IEYsDQogICAgICAgICAgICAjIGNvbG9yID0gImJsYWNrIiwNCiAgICAgICAgICAgIGFscGhhPSAxKSsNCiAgc2NhbGVfZmlsbF9jb2xvcmJsaW5kKCkrDQogIHNjYWxlX2NvbG9yX2NvbG9yYmxpbmQoKSsNCiAgIyBzY2FsZV9maWxsX21hbnVhbCh2YWx1ZXMgPSBjKE5BLE5BLCBOQSkpKw0KICBjb29yZF9lcXVhbCgpKw0KICBsYWJzKHRpdGxlID0iIikNCmBgYA0KDQojIyBjbHVzdGVyaW5nDQpgYGB7cn0NCmxpYnJhcnkoImFwZSIpDQpsaWJyYXJ5KCJnZ2RlbmRybyIpDQpgYGANCg0KYGBge3J9DQpjbHVzc19kYXRhID0gYXMubWF0cml4KGRhdGEuZnJhbWUoc2NhbGUocGNhX2RhdGFbLTFdKSkpDQpyb3cubmFtZXMoY2x1c3NfZGF0YSkgPSBhcy5tYXRyaXgoKHBjYV9kYXRhMiRlbnNvKSkNCg0KTkhDQSA9IGttZWFucyhjbHVzc19kYXRhLDMpDQpOSENBDQoNCmRkID0gZGlzdChzY2FsZShjbHVzc19kYXRhKSwgbWV0aG9kID0gImV1Y2xpZGVhbiIpDQpoYyA8LSBoY2x1c3QoZGQsIG1ldGhvZCA9ICJhdmVyYWdlIikNCg0KDQpteXBhbCA9IGMoInJlZCIsICJncmVlbiIsICJibHVlIikNCmNsdXM1ID0gY3V0cmVlKGhjLCAzKQ0KZGVuZF9maWVsZDEgPC1wbG90KGFzLnBoeWxvKGhjKSwgdHlwZSA9ICJ1bnJvb3RlZCIsDQogICAgICAgICAgICAgICAgICAgY2V4ID0gMC42LA0KICAgICAgICAgICAgICAgICAgIG5vLm1hcmdpbiA9IFRSVUUpDQpgYGANCg0KYGBge3J9DQpkZW5kIDwtIGFzLmRlbmRyb2dyYW0oaGMpDQpkZW5kX2RhdGEgPC0gZGVuZHJvX2RhdGEoZGVuZCwgdHlwZSA9ICJyZWN0YW5nbGUiKQ0KDQoNCnJvdy5uYW1lcyhjbHVzc19kYXRhKSA9IGFzLm1hdHJpeCgNCiAgdW5pdGVfKHBjYV9kYXRhMiwgInNlYXNvbl9zdGF0ZSIsIGMoInNlYXNvbiIsImVuc28iKSwgc2VwID0gIjogIikkc2Vhc29uX3N0YXRlDQogICkNCmRkMiA9IGRpc3Qoc2NhbGUoY2x1c3NfZGF0YSksIG1ldGhvZCA9ICJldWNsaWRlYW4iKQ0KaGMyIDwtIGhjbHVzdChkZDIsIG1ldGhvZCA9ICJ3YXJkLkQyIikNCmRlbmQyIDwtIGFzLmRlbmRyb2dyYW0oaGMyKQ0KZGVuZF9kYXRhMiA8LSBkZW5kcm9fZGF0YShkZW5kMiwgdHlwZSA9ICJyZWN0YW5nbGUiKQ0KYGBgDQoNCmBgYHtyfQ0KZ2dwbG90KGRlbmRfZGF0YTIkc2VnbWVudHMpICsgDQogICMgZ2VvbV9yZWN0KGFlcyh4bWluPTAsIHhtYXg9NC41LCB5bWluPTQsIHltYXg9LTIpLCBmaWxsPSJncmF5IiwgYWxwaGE9MC4wMSwgc2l6ZSA9IDEpKw0KICBnZW9tX3NlZ21lbnQoYWVzKHggPSB4LCB5ID0geSwgeGVuZCA9IHhlbmQsIHllbmQgPSB5ZW5kKSkrDQogIA0KICBnZW9tX3RleHQoZGF0YSA9IGRlbmRfZGF0YTIkbGFiZWxzICU+JSANCiAgICAgICAgICAgICAgc2VwYXJhdGUobGFiZWwsIGludG89Yygic2Vhc29uIiwgImVuc28iKSxzZXAgPSAiOiIsIHJlbW92ZSA9IEYpLA0KICAgICAgICAgICAgYWVzKHgsIHkgPSAtMiAsDQogICAgICAgICAgICAgICAgbGFiZWwgPSBsYWJlbCwNCiAgICAgICAgICAgICAgICBjb2xvciA9IGVuc28sDQogICAgICAgICAgICAgICAgKSwNCiAgICAgICAgICAgIGhqdXN0ID0gMSwgYW5nbGUgPSAwLCBzaXplID0gMywgZm9udGZhY2UgPSAiYm9sZCIpKw0KICBjb29yZF9mbGlwKCkrDQogIHNjYWxlX3lfcmV2ZXJzZSgpKw0KICBzY2FsZV9jb2xvcl9jb2xvcmJsaW5kKCkrDQogIGxhYnMoeCA9ICIiLCB5PSIiLCBjb2xvciA9IiIpDQoNCmBgYA0KDQoNCiMgU3Vydml2YWwgYW5hbHlzaXMNCiMjIEZyZXF1ZW50aXN0IA0KDQojIyMjIGthcGxhbi1tZWllciBub24tcGFyYW1ldHJpYyBzdXJ2aXZhbA0KIyMjIyMjIERhdGENCmBgYHtyfQ0Kc2JyX3JlcF9jb3VudCA9IHNicl9yZXAgJT4lDQogIG11dGF0ZShjb3VudCA9ICAxKSAlPiUgDQogIG11dGF0ZShzZWFzb24gPSBhcy5jaGFyYWN0ZXIoc2Vhc29uKSkNCmBgYA0KDQoNCiMjIyMjIG51bGwgbW9kZWwNCmBgYHtyfQ0KS00wID0gc3VydmZpdChTdXJ2KGRheXMsIGNvdW50KSB+IDEsIGNvbmYudHlwZT0ibG9nIiwgdHlwZT0ia2FwbGFuLW1laWVyIiwgZGF0YT1zYnJfcmVwX2NvdW50KQ0KS00wDQoNCm92ZXJhbF90ID0gYXMubWF0cml4KHN1bW1hcnkoS00wKSR0YWJsZSlbIm1lZGlhbiIsMV0NCg0KDQpgYGANCmBgYHtyfQ0Kc3Vydl9jdXJ2ZV9nZXJhbCA9ICBkYXRhLmZyYW1lKHRpbWUgPSBLTTAkdGltZSwgc3VydiA9IEtNMCRzdXJ2LCBsb3dlciA9IEtNMCRsb3dlciAsIHVwcGVyID0gS00wJHVwcGVyKSANCnN1cnZfY3VydmVfZ2VyYWwlPiUgDQogIGdncGxvdChhZXModGltZSwgc3VydikpKw0KICBnZW9tX3N0ZXAoc2l6ZSA9MSkrDQogIFJjbWRyUGx1Z2luLktNZ2dwbG90Mjo6Z2VvbV9zdGVwcmliYm9uKGFlcyh5bWluID0gbG93ZXIsIHltYXggPSB1cHBlciksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhID0gMC4xLCBjb2xvciA9IE5BKSsNCiAgdGhlbWVfaGFsZl9vcGVuKCkNCmBgYA0KDQoNCiMjIyMjIFNlYXNvbiBjb3ZhcmlhdGUgDQpgYGB7cn0NCktNMF9zID0gc3VydmZpdChTdXJ2KGRheXMsIGNvdW50KSB+IHNlYXNvbiwgY29uZi50eXBlPSJsb2ciLCB0eXBlPSJrYXBsYW4tbWVpZXIiLCBkYXRhPXNicl9yZXBfY291bnQpDQpLTTBfcw0KDQpgYGANCg0KYGBge3J9DQpvdXRicmVhayA9IGFzLmRhdGEuZnJhbWUoc3VtbWFyeShLTTBfcykkdGFibGVbLCBjKCIqcm1lYW4iLCIwLjk1TENMIiwiMC45NVVDTCIsIipzZShybWVhbikiKV0pDQpvdXRicmVhayA9cm93bmFtZXNfdG9fY29sdW1uKG91dGJyZWFrLCB2YXIgPSAic2Vhc29uIikNCg0Kb3V0X2RheSA9IG91dGJyZWFrICU+JQ0KICBzZXBhcmF0ZShzZWFzb24sIHNlcCA9Ij0iLCByZW1vdmUgPSBULCBpbnRvID0gYygidHJhc2giLCAic2Vhc29uIikpICU+JSANCiAgZnVsbF9qb2luKGVuc29kYXRhMikgJT4lDQogIG11dGF0ZShzZWFzb24gPSBhcy5udW1lcmljKHNlYXNvbikpICU+JSANCiAgIyBhcnJhbmdlKGAqcm1lYW5gKQ0KICBnZ3Bsb3QoYWVzKHNlYXNvbiwgYCpybWVhbmAsIGNvbG9yID0gZW5zbykpICsNCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gb3ZlcmFsX3QsIGNvbG9yPSAiZ3JheSIsIGxpbmV0eXBlID0gMikrDQogIGdlb21fbGluZShjb2xvciA9ICJncmF5IixzaXplID0wLjMpKw0KICBnZW9tX2Vycm9yYmFyKGFlcyh5bWluID0gMCAsIHltYXggPSBgKnJtZWFuYCtgKnNlKHJtZWFuKWApLA0KICAgICAgICAgICAgICAgIHNpemUgPTAuMywgd2lkdGggPTAsIGNvbG9yID0gImdyYXk3MCIpKw0KICBnZW9tX2Vycm9yYmFyKGFlcyh5bWluID0gYCpybWVhbmAtYCpzZShybWVhbilgICwgeW1heCA9IGAqcm1lYW5gK2Aqc2Uocm1lYW4pYCksDQogICAgICAgICAgICAgICAgc2l6ZSA9MC43LCB3aWR0aCA9MCAjY29sb3IgPSAiYmxhY2siDQogICAgICAgICAgICAgICAgKSsNCiAgZ2VvbV9wb2ludChzaXplID0gMikrDQogIHNjYWxlX3hfY29udGludW91cyhicmVha3MgPSAyMDA1OjIwMjEpICsNCiAgc2NhbGVfY29sb3JfY29sb3JibGluZCgpICsgDQogIGxhYnMoeCA9ICJDcm9wIHNlYXNvbiIsDQogICAgICAgeSA9ICJUaW1lIHRvIGRpc2Vhc2Ugb3V0YnJlYWsiLA0KICAgICAgIGNvbG9yID0gIiIpKw0KICB0aGVtZV9oYWxmX29wZW4oKSsNCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGU9NDUsIGhqdXN0ID0xKSkgDQpvdXRfZGF5DQpgYGANCg0KYGBge3J9DQpzcyA9IHN1bW1hcnkoS00wX3MpDQpzdXJ2X2N1cnZlcyA9IGRhdGEuZnJhbWUodGltZSA9IEtNMF9zJHRpbWUsIHN1cnYgPSBLTTBfcyRzdXJ2LCBsb3dlciA9IEtNMF9zJGxvd2VyICwgdXBwZXIgPSBLTTBfcyR1cHBlciwgc3RyYXRhID1zcyRzdHJhdGEpICU+JSANCiAgc2VwYXJhdGUoc3RyYXRhLCBpbnRvID0gYygicyIsICJzZWFzb24iKSwgc2VwID0iPSIpICU+JQ0KICBmdWxsX2pvaW4oZW5zb2RhdGEyKSAlPiUgDQogIGdncGxvdCgpKw0KICBnZW9tX3N0ZXAoYWVzKHRpbWUsIHN1cnYsICBncm91cCA9IHNlYXNvbiwgY29sb3IgPSBlbnNvKSwNCiAgICAgICAgICAgIHNpemUgPS41LA0KICAgICAgICAgICAgIyBjb2xvciA9ICJncmF5IiwNCiAgICAgICAgICAgIGFscGhhID0gMC40KSsNCiAgUmNtZHJQbHVnaW4uS01nZ3Bsb3QyOjpnZW9tX3N0ZXByaWJib24oYWVzKHRpbWUsIHltaW4gPSBsb3dlciwgeW1heCA9IHVwcGVyLCBncm91cCA9IHNlYXNvbiksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhID0gMC4wNSwgY29sb3IgPSBOQSkrDQogIGdlb21fc3RlcChkYXRhID0gc3Vydl9jdXJ2ZV9nZXJhbCwNCiAgICAgICAgICAgIGFlcyh0aW1lLCBzdXJ2KSwNCiAgICAgICAgICAgIGNvbG9yID0gInJlZCIsIA0KICAgICAgICAgICAgc2l6ZSA9IDAuOCkrDQogIGdlb21fc2VnbWVudCh4ID0gOTEsIHkgPSAwLCB4ZW5kID0gOTEsIHllbmQgPSAwLjUsIGxpbmV0eXBlID0gMiwgc2l6ZSA9MC43KSsNCiAgZ2VvbV9zZWdtZW50KHggPSAwLCB5ID0gMC41LCB4ZW5kID0gOTEsIHllbmQgPSAwLjUsIGxpbmV0eXBlID0gMiwgc2l6ZSA9MC43KSsNCiAgc2NhbGVfY29sb3JfY29sb3JibGluZCgpKw0KICBndWlkZXMoY29sb3IgPSBndWlkZV9sZWdlbmQob3ZlcnJpZGUuYWVzID0gbGlzdChhbHBoYT0xLCBzaXplID0xKSkpKw0KICB0aGVtZV9oYWxmX29wZW4oKSsNCiAgbGFicyhjb2xvciA9ICIiLA0KICAgICAgIHkgPSAiU3Vydml2YWwgcHJvYmFiaWxpdHkiLA0KICAgICAgIHggPSAiRGF5cyIpDQpzdXJ2X2N1cnZlcw0KYGBgDQoNCg0KYGBge3J9DQpzdXJ2X2N1cnZlcytvdXRfZGF5Kw0KICAjIHBsb3RfbGF5b3V0KGd1aWRlcyA9ICJjb2xsZWN0IikrDQogIHBsb3RfYW5ub3RhdGlvbih0YWdfbGV2ZWxzID0gIkEiKSYNCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uID0gInRvcCIpDQpnZ3NhdmUoImZpZ3MvaHN1cnZpdmFsLnBuZyIsIGRwaSA9IDYwMCwgaGVpZ2h0ID0gNC41LCB3aWR0aCA9IDEwKQ0KYGBgDQoNCmBgYHtyfQ0KdGltZV90b19vdXRicmVhayA9b3V0YnJlYWsgJT4lDQogICMgc2VwYXJhdGUoc2Vhc29uLCBzZXAgPSIsIiwgcmVtb3ZlID0gVCwgaW50byA9IGMoInNlYXNvbiIsICJzdGF0ZSIpKSAlPiUNCiAgc2VwYXJhdGUoc2Vhc29uLCBzZXAgPSI9IiwgcmVtb3ZlID0gVCwgaW50byA9IGMoInRyYXNoIiwgInNlYXNvbiIpKSAlPiUgDQogICMgc2VwYXJhdGUoc3RhdGUsIHNlcCA9Ij0iLCByZW1vdmUgPSBULCBpbnRvID0gYygidHJhc2giLCAic3RhdGUiKSkgJT4lIA0KICBtdXRhdGUoYHRpbWVfb3V0YnJlYWtgID0gYCpybWVhbmApICU+JSANCiAgZHBseXI6OnNlbGVjdCgtdHJhc2gsIC1gMC45NUxDTGAsIC1gMC45NVVDTGAsIC0gYCpzZShybWVhbilgLCAtYCpybWVhbmApDQpgYGANCg0KDQpgYGB7cn0NCm91dGJyZWFrICU+JQ0KICAjIHNlcGFyYXRlKHNlYXNvbiwgc2VwID0iLCIsIHJlbW92ZSA9IFQsIGludG8gPSBjKCJzZWFzb24iLCAic3RhdGUiKSkgJT4lDQogIHNlcGFyYXRlKHNlYXNvbiwgc2VwID0iPSIsIHJlbW92ZSA9IFQsIGludG8gPSBjKCJ0cmFzaCIsICJzZWFzb24iKSkgJT4lIA0KICAjIHNlcGFyYXRlKHN0YXRlLCBzZXAgPSI9IiwgcmVtb3ZlID0gVCwgaW50byA9IGMoInRyYXNoIiwgInN0YXRlIikpICU+JSANCiAgIyBncm91cF9ieShzdGF0ZSkgJT4lDQogIHN1bW1hcmlzZShtZWFuX1QgPSBtZWFuKGAqcm1lYW5gKSwNCiAgICAgICAgICAgIG1lYW5fc2UgPSBtZWFuKGAqc2Uocm1lYW4pYCksDQogICAgICAgICAgICBtaW5fVCA9IG1pbihgKnJtZWFuYCksDQogICAgICAgICAgICBtYXhfVCA9IG1heCAoYCpybWVhbmApKQ0KYGBgDQoNCg0KDQoNCg0KIyMjIENveCBQcm9wb3J0aW9uYWwgSGF6YXJkcyBNb2RlbA0KDQpgYGB7cn0NCmNveCA9IGNveHBoKFN1cnYoZGF5cywgY291bnQpIH4gc2Vhc29uLCBkYXRhID0gc2JyX3JlcF9jb3VudCApDQpzdW1tYXJ5KGNveCkNCmBgYA0KDQoNCmBgYHtyfQ0KSFIgPSBhcy5kYXRhLmZyYW1lKHN1bW1hcnkoY294KSRjb25mLmludFsxOjE2LCBjKCJleHAoY29lZikiLCJsb3dlciAuOTUiLCJ1cHBlciAuOTUiKV0pDQpIUiA9IHJvd25hbWVzX3RvX2NvbHVtbihIUiwgdmFyID0gInNlYXNvbiIpDQoNCmhyX3Jpc2sgPSBIUiAlPiUgDQogIHNlcGFyYXRlKHNlYXNvbiwgc2VwID0ic2Vhc29uIiwgcmVtb3ZlID0gVCwgaW50byA9IGMoInRyYXNoIiwgInNlYXNvbiIpKSAlPiUgDQogIGZpbHRlcighaXMubmEoc2Vhc29uKSkgJT4lIA0KICBnZ3Bsb3QoYWVzKHNlYXNvbiwgbG9nKGBleHAoY29lZilgKSkpICsgDQogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDAsIHNpemUgPSAxLCBjb2xvciA9ICJncmF5NDAiLGxpbmV0eXBlID0yLCBsYWJlbCA9ICIyMDA1IikrDQogIGdlb21fcG9pbnQoc2l6ZSA9IDIsIHBvc2l0aW9uID0gcG9zaXRpb25fZG9kZ2Uod2lkdGggPSAuNSksDQogICAgICAgICAgICAgY29sb3IgPSAic3RlZWxibHVlIikrDQogIGdlb21fZXJyb3JiYXIoYWVzKHltaW4gPSBsb2coYGxvd2VyIC45NWApLCB5bWF4ID0gbG9nKGB1cHBlciAuOTVgKSksDQogICAgICAgICAgICAgICAgcG9zaXRpb24gPSBwb3NpdGlvbl9kb2RnZSh3aWR0aCA9IC41KSwgc2l6ZSA9MSwgd2lkdGggPTAsDQogICAgICAgICAgICAgICAgY29sb3IgPSAic3RlZWxibHVlIikrIA0KICANCiAgZ2VvbV90ZXh0KGFlcygxMiwwLGxhYmVsID0gIjIwMDUiLCB2anVzdCA9IC0wLjUsYW5nbGUgPSA5MCksIHNpemUgPTMuNSxjb2xvciA9ICJncmF5NDAiKSsNCiAgY29vcmRfZmxpcCgpKw0KICBsYWJzKHggPSAiQ3JvcCBzZWFzb24iLCB5ID0gIkhhemFyZCByaXNrIiwgY29sb3IgPSAiU3RhdGUiKQ0KIyBnZ3NhdmUoImZpZ3MvaGF6YXJkX3Jpc2sucG5nIiwgZHBpID0gNjAwLCBoZWlnaHQgPSA2LCB3aWR0aCA9IDQpDQpgYGANCg0KYGBge3J9DQpvdXRfZGF5K2hyX3Jpc2srDQogIHBsb3RfYW5ub3RhdGlvbih0YWdfbGV2ZWxzID0gIkEiKSYNCiAgdGhlbWVfaGFsZl9vcGVuKCkNCmBgYA0KDQoNCg0KIyMgQmF5ZXNpYW4NCg0KDQoNCg0KIyMjIExvYWRpbmcgc2hhcGVmaWxlcw0KYGBge3J9DQpzaGFwZV9zdWw9IHJlYWRPR1IoInNoYXBlZmlsZXMvQlJfTVVOMTk5N19TX3JlZ2lvbiIsIkJSX01VTjE5OTdfU19yZWdpb24iICkNCg0Kc2hhcGVfc3VsQGRhdGEkaWQgPSByb3duYW1lcyhzaGFwZV9zdWxAZGF0YSkNCnN1bF9wb2ludHMgPSBmb3J0aWZ5KHNoYXBlX3N1bCkNCnN1bF9kZiA9cGx5cjo6am9pbihzdWxfcG9pbnRzLCBzaGFwZV9zdWxAZGF0YSwgYnk9ImlkIikNCg0KYGBgDQoNCg0KDQoNCg0KYGBge3J9DQpJRHMgPSB1bmlxdWUoc3VsX2RmJGlkKQ0KbG9jYXRpb24yID0gbnVtZXJpYyhsZW5ndGgoc2JyX3JlcF9jb3VudCRsYXQpKQ0KZm9yKGkgaW4gMTpsZW5ndGgoSURzKSl7DQogcXFxID0gc3VsX2RmICU+JQ0KICBmaWx0ZXIoaWQgPT0gSURzW2ldKQ0KDQpjaXR5ID0gYXMuY2hhcmFjdGVyKHVuaXF1ZShxcXEkTVVOSUNfUElPKSkNCg0KIGZvcihqIGluIDE6bGVuZ3RoKHNicl9yZXBfY291bnQkbGF0KSl7DQogICAgcGlwID0gcG9pbnQuaW4ucG9seWdvbihwb2ludC54ID0gc2JyX3JlcF9jb3VudCRsb25bal0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludC55ID0gc2JyX3JlcF9jb3VudCRsYXRbal0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICBwb2wueCA9IHFxcSRsb25nLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9sLnkgPSBxcXEkbGF0KQ0KDQogICAgICBpZihwaXAgPiAwKXtsb2NhdGlvbjJbal0gPSBjaXR5fQ0KDQogfQ0KfQ0Kc2JyX3JlcF9jb3VudF9uZXcgPSBzYnJfcmVwX2NvdW50ICU+JQ0KICBtdXRhdGUoTVVOSUNfUElPID0gbG9jYXRpb24yKQ0KDQoNCmBgYA0KDQojIyMgRGF0YQ0KDQpgYGB7cn0NCm1vbnRocyA9IGMoIlNlcCIsICJPY3QiLCAiTm92IiwgIkRlYyIsICJKYW4iLCAiRmViIiwgIk1hciIsIkFwciIsIk1heSIpDQppbmxhX2RhdGFfZ2VyYWwgPSBzYnJfcmVwX2NvdW50ICU+JQ0KICBtdXRhdGUobW9udGggPSBmYWN0b3IobW9udGgsIGxldmVscyA9IG1vbnRocykpICU+JSANCiAgZnVsbF9qb2luKHNicl9yZXBfY291bnRfbmV3ICU+JSBtdXRhdGUobW9udGggPSBmYWN0b3IobW9udGgsIGxldmVscyA9IG1vbnRocykpKSAlPiUgDQogIGZ1bGxfam9pbihkYXRhLmZyYW1lKE1VTklDX1BJTyA9IHVuaXF1ZShzYnJfcmVwX2NvdW50X25ldyRNVU5JQ19QSU8pKSAlPiUgDQogIG11dGF0ZShTID0gMTpsZW5ndGgoTVVOSUNfUElPKSkpDQpgYGANCg0KDQoNCg0KIyMjIE1vZGVsIGlpZCB1bmVzdHJ1Y3R1cmVkDQoNCmBgYHtyIGV2YWw9RkFMU0UsIGluY2x1ZGU9VH0NCmZvcm1fc3Vydl9wciA9IGlubGEuc3VydihkYXlzLCBjb3VudCkgfiAxICsgc2Vhc29uICsNCiAgZihTLCBtb2RlbCA9ICJpaWQiKQ0KDQoNCnN1cnZfZml0X3ByLmlubGEgPSBpbmxhKGZvcm1fc3Vydl9wciwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBpbmxhX2RhdGFfZ2VyYWwsDQogICAgICAgICAgICAgICAgICAgICAgICBmYW1pbHkgPSAiY294cGgiLA0KICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbC5oYXphcmQgPSBsaXN0KGh5cGVyID0gbGlzdChwcmVjID0gbGlzdChwYXJhbSA9IGMoMC4wMDEsIDAuMDAxKSkpKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuY29tcHV0ZT1saXN0KGRpYz1UUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3BvPVRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWljPVRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVubXAuc3RyYXRlZ3k9Imh1Z2UiKSkNCiMgc3VtbWFyeShzdXJ2X2ZpdF9wci5pbmxhKQ0KIyBzdXJ2X2ZpdF9wci5pbmxhIDwtIGlubGEucmVydW4oc3Vydl9maXRfcHIuaW5sYSkNCnNhdmVSRFMoc3Vydl9maXRfcHIuaW5sYSwgIi4vbW9kZWxzL21vZGVsX3NlYXNvbnNfaWRkLlJEUyIpDQpgYGANCg0KDQpgYGB7cn0NCnN1cnZfZml0X3ByLmlubGEgPSByZWFkUkRTKCIuL21vZGVscy9tb2RlbF9zZWFzb25zX2lkZC5SRFMiKQ0Kc3VtbWFyeShzdXJ2X2ZpdF9wci5pbmxhKQ0KYGBgDQoNCiMjIyBQbG90IGVmZmVjdA0KDQpgYGB7cn0NCnN1cnZfZml0X3ByLmlubGEkc3VtbWFyeS5maXhlZCAlPiUgDQogIHJvd25hbWVzX3RvX2NvbHVtbigic2Vhc29uIikgJT4lDQogIGZpbHRlcihzZWFzb24gIT0gIihJbnRlcmNlcHQpIikgJT4lDQogIHNlcGFyYXRlKHNlYXNvbiwgaW50byA9IGMoInQiLCAic2Vhc29uIiksIHNlcCA9ICJvbiIpICU+JQ0KICBnZ3Bsb3QoYWVzKG1lYW4sc2Vhc29uKSkrDQogIGdlb21fdmxpbmUoeGludGVyY2VwdCA9IDAsIGxpbmV0eXBlID0gMiwgY29sb3IgPSAiZ3JheSIpKw0KICBnZW9tX3BvaW50KHNpemUgPTIgKSsNCiAgZ2VvbV9lcnJvcmJhcihhZXMoeG1pbiA9IGAwLjAyNXF1YW50YCwgeG1heCA9IGAwLjk3NXF1YW50YCksDQogICAgICAgICAgICAgICAgd2lkdGggPSAwKSsNCiAgdGhlbWUoI2xlZ2VuZC5wb3NpdGlvbiA9ICJub25lIiwNCiAgICAgICAgcGFuZWwuYmFja2dyb3VuZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgcGFuZWwuZ3JpZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgcGFuZWwuYm9yZGVyID0gZWxlbWVudF9ibGFuaygpLA0KICAgICAgICBheGlzLmxpbmUueCA9IGVsZW1lbnRfbGluZShjb2xvciA9ICJibGFjayIpLA0KICAgICAgICBheGlzLmxpbmUueSA9IGVsZW1lbnRfbGluZShjb2xvciA9ICJibGFjayIpLA0KICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDApKSANCg0KYGBgDQoNCg0KIyMgTmVpZ2hib3VyIGJ5IGRpc3RhbmNlDQpgYGB7cn0NCnN1bF9sb2NhdGlvbnMgPSB1bmlxdWUoc2JyX3JlcF9jb3VudF9uZXckTVVOSUNfUElPKQ0Kc2hhcGVfc3VsX3N1YiA9IHN1YnNldChzaGFwZV9zdWwsIHNoYXBlX3N1bCRNVU5JQ19QSU8laW4lc3VsX2xvY2F0aW9ucyApDQoNCmNvb3Jkc19wciA9IGNvb3JkcyA8LSBjb29yZGluYXRlcyhzaGFwZV9zdWxfc3ViKQ0KSURzX3ByIDwtIHJvdy5uYW1lcyhhcyhzaGFwZV9zdWxfc3ViLCAiZGF0YS5mcmFtZSIpKQ0KDQpsb25nID0gY29vcmRzX3ByWywxXQ0KbGF0ID0gY29vcmRzX3ByWywyXQ0KeHkgPC0gZGF0YS5mcmFtZShJRCA9IDE6KGxlbmd0aChsYXQpKSwgbG9uZywgbGF0KQ0KY29vcmRpbmF0ZXMoeHkpIDwtIGMoImxvbmciLCAibGF0IikNCnByb2o0c3RyaW5nKHh5KSA8LSBDUlMoIitpbml0PWVwc2c6NDMyNiIpDQpyZXMgPC0gc3BUcmFuc2Zvcm0oeHksIENSUygiK3Byb2o9dXRtICt6b25lPTIyICtzb3V0aCBlbGxwcz1XR1M4NCIpKQ0KY29vcmRzX2dyaWQgPSBhcy5kYXRhLmZyYW1lKHJlcykNCmNvb3JkczIgPSBhcy5tYXRyaXgoY29vcmRzX2dyaWRbLDI6M10pDQpjb2xuYW1lcyhjb29yZHMyKSA8LSBjKCJ4MSIsIngyIikNCg0KYGBgDQoNCg0KDQoNCg0KDQoNCg0KYGBge3J9DQp1IDwtIDAuMi8wLjMxDQphbHBoYSA8LSAwLjAxDQpwaGkudSA8LSAwLjUNCnBoaS5hbHBoYSA8LSAyLzMNCmBgYA0KDQoNCg0KDQoNCiMjIyMgMjAwIGttIA0KDQpgYGB7cn0NCmRuZWFyX2Rpc3RfMjAwID0gZG5lYXJuZWlnaChjb29yZHMyLCAwLDIwMDAwMCwgcm93Lm5hbWVzPUlEc19wcikNCg0KbmIySU5MQSgiLi9tb2RlbHMvZ3JpZDIwMC5ncmFwaCIsZG5lYXJfZGlzdF8yMDApDQpXLnByX2Rpc3QyMDAgPSBpbmxhLnJlYWQuZ3JhcGgoIi4vbW9kZWxzL2dyaWQyMDAuZ3JhcGgiKQ0KcGxvdChzaGFwZV9zdWxfc3ViKQ0KcGxvdChkbmVhcl9kaXN0XzIwMCxjb29yZGluYXRlcyhzaGFwZV9zdWxfc3ViKSwgYWRkID0gVCkNCg0KDQpgYGANCg0KYGBge3IgZXZhbD1GQUxTRSwgaW5jbHVkZT1UfQ0KZm9ybV9zdXJ2X3NwdC4yMDAgPSBpbmxhLnN1cnYoZGF5cywgY291bnQpIH4gMSArIHNlYXNvbiArIA0KICBmKFMsIG1vZGVsID0gImJ5bTIiLCBncmFwaCA9IFcucHJfZGlzdDIwMCwNCiAgICBoeXBlciA9IGxpc3QocHJlYyA9IGxpc3QocGFyYW0gPSBjKDAuMDAxLCAwLjAwMSkpLCANCiAgICAgICAgICAgICAgICAgcGhpID0gbGlzdChwcmlvciA9ICJwYyIsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtID0gYyhwaGkudSwgcGhpLmFscGhhKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0aWFsID0gLTMpKSkNCg0KDQpzdXJ2X2ZpdF8yMDAgPSBpbmxhKGZvcm1fc3Vydl9zcHQuMjAwLA0KICAgICAgICAgICAgICAgICAgIGRhdGEgPSBpbmxhX2RhdGFfZ2VyYWwsDQogICAgICAgICAgICAgICAgICAgZmFtaWx5ID0gImNveHBoIiwNCiAgICAgICAgICAgICAgICAgICBjb250cm9sLmhhemFyZCA9IGxpc3QoaHlwZXIgPSBsaXN0KHByZWMgPSBsaXN0KHBhcmFtID0gYygwLjAwMSwgMC4wMDEpKSkpLA0KICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuY29tcHV0ZT1saXN0KGRpYz1UUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNwbz1UUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaWM9VFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVubXAuc3RyYXRlZ3k9Imh1Z2UiKSwNCiAgICAgICAgICAgICAgICAgICB2ZXJib3NlPUYpDQoNCnNhdmVSRFMoc3Vydl9maXRfMjAwLCAiLi9tb2RlbHMvbW9kZWxfc2Vhc29uc18yMDAuUkRTIikNCmBgYA0KDQoNCmBgYHtyfQ0Kc3Vydl9maXRfMjAwID0gcmVhZFJEUygiLi9tb2RlbHMvbW9kZWxfc2Vhc29uc18yMDAuUkRTIikNCnN1bW1hcnkoc3Vydl9maXRfMjAwKQ0KIyBpbmxhLm1hcg0KYGBgDQoNCiMjIyBQbG90IGVmZmVjdA0KDQpgYGB7cn0NCnN1cnZfZml0XzIwMCRzdW1tYXJ5LmZpeGVkICU+JSANCiAgcm93bmFtZXNfdG9fY29sdW1uKCJzZWFzb24iKSAlPiUNCiAgZmlsdGVyKHNlYXNvbiAhPSAiKEludGVyY2VwdCkiKSAlPiUNCiAgc2VwYXJhdGUoc2Vhc29uLCBpbnRvID0gYygidCIsICJzZWFzb24iKSwgc2VwID0gIm9uIikgJT4lIA0KICBtdXRhdGUobW9kZWwgPSAiU3RydWN0dXJlZCIpICU+JSANCiAgZnVsbF9qb2luKA0KDQpzdXJ2X2ZpdF9wci5pbmxhJHN1bW1hcnkuZml4ZWQgJT4lIA0KICByb3duYW1lc190b19jb2x1bW4oInNlYXNvbiIpICU+JQ0KICBmaWx0ZXIoc2Vhc29uICE9ICIoSW50ZXJjZXB0KSIpICU+JQ0KICBzZXBhcmF0ZShzZWFzb24sIGludG8gPSBjKCJ0IiwgInNlYXNvbiIpLCBzZXAgPSAib24iKSAlPiUgDQogIG11dGF0ZShtb2RlbCA9ICJVbnN0cnVjdHVyZWQiKQ0KKSU+JQ0KICBmdWxsX2pvaW4oZW5zb2RhdGEyKSAlPiUgDQogIGZpbHRlcihzZWFzb24gIT0gIjIwMDUiKSAlPiUgDQogIGdncGxvdChhZXMobWVhbixzZWFzb24sIGNvbG9yID0gZW5zbywgbGluZXR5cGUgPSBtb2RlbCkpKw0KICBnZW9tX3ZsaW5lKHhpbnRlcmNlcHQgPSAwLCBsaW5ldHlwZSA9IDIsIGNvbG9yID0gImdyYXkiKSsNCiAgZ2VvbV9wb2ludChzaXplID0yLCBwb3NpdGlvbiA9IHBvc2l0aW9uX2RvZGdlKHdpZHRoID0gLTAuNCkpKw0KICBnZW9tX2Vycm9yYmFyKGFlcyh4bWluID0gYDAuMDI1cXVhbnRgLCB4bWF4ID0gYDAuOTc1cXVhbnRgKSwNCiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHBvc2l0aW9uX2RvZGdlKHdpZHRoID0gLTAuNCksDQogICAgICAgICAgICAgICAgd2lkdGggPSAwKSsNCiAgdGhlbWUoI2xlZ2VuZC5wb3NpdGlvbiA9ICJub25lIiwNCiAgICAgICAgcGFuZWwuYmFja2dyb3VuZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgcGFuZWwuZ3JpZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgcGFuZWwuYm9yZGVyID0gZWxlbWVudF9ibGFuaygpLA0KICAgICAgICBheGlzLmxpbmUueCA9IGVsZW1lbnRfbGluZShjb2xvciA9ICJibGFjayIpLA0KICAgICAgICBheGlzLmxpbmUueSA9IGVsZW1lbnRfbGluZShjb2xvciA9ICJibGFjayIpLA0KICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDApKSsNCiAgc2NhbGVfY29sb3JfY29sb3JibGluZCgpKw0KICBzY2FsZV9hbHBoYV9tYW51YWwodmFsdWVzID0gYygwLjUsMSkpKw0KICBsYWJzKHggPSAiRWZmZWN0IiwNCiAgICAgICB5ID0gIkNyb3Agc2Vhc29uIiwNCiAgICAgICBjb2xvciA9ICJFTlNPIHBoYXNlIiwNCiAgICAgICBsaW5ldHlwZSA9ICAiTW9kZWwiKQ0KDQpnZ3NhdmUoImZpZ3MvYmF5ZXNfaGF6YXJkX3NlYXNvbi5wbmciLCBkcGkgPSA2MDAsIGhlaWdodCA9IDUsIHdpZHRoID0gNCkNCmBgYA0KDQoNCg0KDQoNCiMjIEVmZmVjdCBvZiBFTlNPDQoNCg0KYGBge3J9DQppbmxhX2RhdGFfZW5zbyA9IGlubGFfZGF0YV9nZXJhbCAlPiUgDQogIGZ1bGxfam9pbihlbnNvZGF0YTIpICU+JSANCiAgbXV0YXRlKGVuc28gPSBmYWN0b3IoZW5zbywgYygiTmV1dHJhbCIsIkVsIE5pw7FvIiwgIkxhIE5pw7FhIikpKQ0KYGBgDQoNCg0KIyMjIyBTdXJ2aXZhbA0KIyMjIyMgaWlkIHNlYXNvbnMNCmBgYHtyIGV2YWw9RkFMU0UsIGluY2x1ZGU9VH0NCmZvcm1fc3Vydl9lbnNvMSA9IGlubGEuc3VydihkYXlzLCBjb3VudCkgfiAxICsgZW5zbyArIA0KICBmKHNlYXNvbiwgbW9kZWwgPSAiaWlkIiwgaHlwZXIgPSBsaXN0KHByZWMgPSBsaXN0KHBhcmFtID0gYygwLjAwMSwwLjAwMSkpKSkrDQogIGYoUywgbW9kZWwgPSAiYnltMiIsIGdyYXBoID0gVy5wcl9kaXN0MjAwLA0KICAgIGh5cGVyID0gbGlzdChwcmVjID0gbGlzdChwYXJhbSA9IGMoMC4wMDEsIDAuMDAxKSksIA0KICAgICAgICAgICAgICAgICBwaGkgPSBsaXN0KHByaW9yID0gInBjIiwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW0gPSBjKHBoaS51LCBwaGkuYWxwaGEpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaXRpYWwgPSAtMykpKQ0KDQoNCnN1cnZfZml0X2Vuc28xID0gaW5sYShmb3JtX3N1cnZfZW5zbzEsDQogICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gaW5sYV9kYXRhX2Vuc28sDQogICAgICAgICAgICAgICAgICAgICAgICBmYW1pbHkgPSAiY294cGgiLA0KICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuaGF6YXJkID0gbGlzdChoeXBlciA9IGxpc3QocHJlYyA9IGxpc3QocGFyYW0gPSBjKDAuMDAxLCAwLjAwMSkpKSksDQogICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sLmNvbXB1dGU9bGlzdChkaWM9VFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNwbz1UUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpYz1UUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3Blbm1wLnN0cmF0ZWd5PSJodWdlIikpDQojIHN1bW1hcnkoc3Vydl9maXRfcHIuaW5sYSkNCiMgc3Vydl9maXRfcHIuaW5sYSA8LSBpbmxhLnJlcnVuKHN1cnZfZml0X3ByLmlubGEpDQpzYXZlUkRTKHN1cnZfZml0X2Vuc28xLCAiLi9tb2RlbHMvbW9kZWxfZW5zbzEuUkRTIikNCmBgYA0KDQoNCmBgYHtyfQ0Kc3Vydl9maXRfZW5zbzEgPSByZWFkUkRTKCIuL21vZGVscy9tb2RlbF9lbnNvMS5SRFMiKQ0Kc3VtbWFyeShzdXJ2X2ZpdF9lbnNvMSkNCg0KYGBgDQoNCmBgYHtyfQ0KaW5sYS5ocGRtYXJnaW5hbCgwLjk1LCBzdXJ2X2ZpdF9lbnNvMSRtYXJnaW5hbHMuZml4ZWQkYChJbnRlcmNlcHQpYCkNCmlubGEuaHBkbWFyZ2luYWwoMC45NSwgc3Vydl9maXRfZW5zbzEkbWFyZ2luYWxzLmZpeGVkJGBlbnNvRWwgTmnDsW9gKQ0KaW5sYS5ocGRtYXJnaW5hbCgwLjk1LCBzdXJ2X2ZpdF9lbnNvMSRtYXJnaW5hbHMuZml4ZWQkYGVuc29MYSBOacOxYWApDQpgYGANCg0KYGBge3J9DQpyb3VuZChzdXJ2X2ZpdF9lbnNvMSRzdW1tYXJ5Lmh5cGVycGFyLCA0KQ0KYGBgDQoNCg0KYGBge3J9DQppbmxhLmhwZG1hcmdpbmFsKDAuOTUsIHN1cnZfZml0X2Vuc28xJG1hcmdpbmFscy5oeXBlcnBhciRgUHJlY2lzaW9uIGZvciBzZWFzb25gKQ0KaW5sYS5ocGRtYXJnaW5hbCgwLjk1LCBzdXJ2X2ZpdF9lbnNvMSRtYXJnaW5hbHMuaHlwZXJwYXIkYFByZWNpc2lvbiBmb3IgU2ApDQppbmxhLmhwZG1hcmdpbmFsKDAuOTUsIHN1cnZfZml0X2Vuc28xJG1hcmdpbmFscy5oeXBlcnBhciRgUGhpIGZvciBTYCkNCmlubGEuaHBkbWFyZ2luYWwoMC45NSwgc3Vydl9maXRfZW5zbzEkbWFyZ2luYWxzLmh5cGVycGFyJGBQcmVjaXNpb24gZm9yIGJhc2VsaW5lLmhhemFyZGApDQpgYGANCg0KDQojIyMjIyMgUGxvdCBlZmZlY3QNCmBgYHtyfQ0KYmluZF9yb3dzKA0KYXMuZGF0YS5mcmFtZShzdXJ2X2ZpdF9lbnNvMSRtYXJnaW5hbHMuZml4ZWQkYGVuc29FbCBOacOxb2ApICU+JSANCiAgbXV0YXRlKEVOU08gPSAiRWwgTmnDsW8iKSwNCmFzLmRhdGEuZnJhbWUoc3Vydl9maXRfZW5zbzEkbWFyZ2luYWxzLmZpeGVkJGBlbnNvTGEgTmnDsWFgKSU+JSANCiAgbXV0YXRlKEVOU08gPSAiTGEgTmnDsWEiKQ0KKSAlPiUgDQoNCmdncGxvdCgpICsNCiAgZ2VvbV92bGluZSh4aW50ZXJjZXB0ID0gMCwgbGluZXR5cGUgPSAyKSsNCiAgZ2VvbV9hcmVhKGFlcyh4LCB5LCBmaWxsID0gRU5TTyksIGFscGhhID0gMC41KSArIA0KICBmYWNldF93cmFwKH5FTlNPLA0KICAgICAgICAgICAgIG5yb3cgPSAyKSsNCiAgbGFicyh4ID0gIkhhemFyZCByaXNrIiwNCiAgICAgICB5ID0gIkRlbnNpdHkiKQ0KDQpgYGANCg0KDQoNCiMjIyMgRml0dGluZyBPTkkgDQojIyMjIyBPTkQNCmBgYHtyIGV2YWw9RkFMU0UsIGluY2x1ZGU9VH0NCmZvcm1fc3Vydl9PTkkxID0gaW5sYS5zdXJ2KGRheXMsIGNvdW50KSB+IDEgKyBPTkQgKyANCiAgZihzZWFzb24sIG1vZGVsID0gImlpZCIsIGh5cGVyID0gbGlzdChwcmVjID0gbGlzdChwYXJhbSA9IGMoMC4wMDEsMC4wMDEpKSkpKw0KICBmKFMsIG1vZGVsID0gImJ5bTIiLCBncmFwaCA9IFcucHJfZGlzdDIwMCwNCiAgICBoeXBlciA9IGxpc3QocHJlYyA9IGxpc3QocGFyYW0gPSBjKDAuMDAxLCAwLjAwMSkpLCANCiAgICAgICAgICAgICAgICAgcGhpID0gbGlzdChwcmlvciA9ICJwYyIsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtID0gYyhwaGkudSwgcGhpLmFscGhhKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0aWFsID0gLTMpKSkNCg0KDQpzdXJ2X2ZpdF9PTkkxID0gaW5sYShmb3JtX3N1cnZfT05JMSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBpbmxhX2RhdGFfZW5zbywNCiAgICAgICAgICAgICAgICAgICAgICAgIGZhbWlseSA9ICJjb3hwaCIsDQogICAgICAgICAgICAgICAgICAgICAgY29udHJvbC5oYXphcmQgPSBsaXN0KGh5cGVyID0gbGlzdChwcmVjID0gbGlzdChwYXJhbSA9IGMoMC4wMDEsIDAuMDAxKSkpKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuY29tcHV0ZT1saXN0KGRpYz1UUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3BvPVRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWljPVRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVubXAuc3RyYXRlZ3k9Imh1Z2UiKSkNCiMgc3VtbWFyeShzdXJ2X2ZpdF9wci5pbmxhKQ0Kc2F2ZVJEUyhzdXJ2X2ZpdF9PTkkxLCAiLi9tb2RlbHMvbW9kZWxfb25pMS5SRFMiKQ0KYGBgDQoNCg0KYGBge3J9DQpzdXJ2X2ZpdF9PTkkxID0gcmVhZFJEUygiLi9tb2RlbHMvbW9kZWxfb25pMS5SRFMiKQ0Kc3VtbWFyeShzdXJ2X2ZpdF9PTkkxKQ0KYGBgDQoNCmBgYHtyfQ0KaW5sYS5ocGRtYXJnaW5hbCgwLjk1LCBzdXJ2X2ZpdF9PTkkxJG1hcmdpbmFscy5maXhlZCRgKEludGVyY2VwdClgKQ0KaW5sYS5ocGRtYXJnaW5hbCgwLjk1LCBzdXJ2X2ZpdF9PTkkxJG1hcmdpbmFscy5maXhlZCRPTkQpDQpgYGANCg0KYGBge3J9DQpyb3VuZChzdXJ2X2ZpdF9PTkkxJHN1bW1hcnkuaHlwZXJwYXIsIDMpDQpgYGANCg0KDQpgYGB7cn0NCmlubGEuaHBkbWFyZ2luYWwoMC45NSwgc3Vydl9maXRfT05JMSRtYXJnaW5hbHMuaHlwZXJwYXIkYFByZWNpc2lvbiBmb3Igc2Vhc29uYCkNCmlubGEuaHBkbWFyZ2luYWwoMC45NSwgc3Vydl9maXRfT05JMSRtYXJnaW5hbHMuaHlwZXJwYXIkYFByZWNpc2lvbiBmb3IgU2ApDQppbmxhLmhwZG1hcmdpbmFsKDAuOTUsIHN1cnZfZml0X09OSTEkbWFyZ2luYWxzLmh5cGVycGFyJGBQaGkgZm9yIFNgKQ0KaW5sYS5ocGRtYXJnaW5hbCgwLjk1LCBzdXJ2X2ZpdF9PTkkxJG1hcmdpbmFscy5oeXBlcnBhciRgUHJlY2lzaW9uIGZvciBiYXNlbGluZS5oYXphcmRgKQ0KYGBgDQoNCg0KDQoNCiMjIyMjIE1KSg0KDQpgYGB7ciBldmFsPUZBTFNFLCBpbmNsdWRlPVR9DQpmb3JtX3N1cnZfT05JMiA9IGlubGEuc3VydihkYXlzLCBjb3VudCkgfiAxICsgTUpKICsNCiAgZihzZWFzb24sIG1vZGVsID0gImlpZCIsIGh5cGVyID0gbGlzdChwcmVjID0gbGlzdChwYXJhbSA9IGMoMC4wMDEsMC4wMDEpKSkpKw0KICBmKFMsIG1vZGVsID0gImJ5bTIiLCBncmFwaCA9IFcucHJfZGlzdDIwMCwNCiAgICBoeXBlciA9IGxpc3QocHJlYyA9IGxpc3QocGFyYW0gPSBjKDAuMDAxLCAwLjAwMSkpLCANCiAgICAgICAgICAgICAgICAgcGhpID0gbGlzdChwcmlvciA9ICJwYyIsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtID0gYyhwaGkudSwgcGhpLmFscGhhKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0aWFsID0gLTMpKSkNCg0KDQpzdXJ2X2ZpdF9PTkkyID0gaW5sYShmb3JtX3N1cnZfT05JMiwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBpbmxhX2RhdGFfZW5zbywNCiAgICAgICAgICAgICAgICAgICAgICAgIGZhbWlseSA9ICJjb3hwaCIsDQogICAgICAgICAgICAgICAgICAgICBjb250cm9sLmhhemFyZCA9IGxpc3QoaHlwZXIgPSBsaXN0KHByZWMgPSBsaXN0KHBhcmFtID0gYygwLjAwMSwgMC4wMDEpKSkpLA0KICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbC5jb21wdXRlPWxpc3QoZGljPVRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcG89VFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaWM9VFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5tcC5zdHJhdGVneT0iaHVnZSIpKQ0KIyBzdW1tYXJ5KHN1cnZfZml0X3ByLmlubGEpDQojIHN1cnZfZml0X3ByLmlubGEgPC0gaW5sYS5yZXJ1bihzdXJ2X2ZpdF9wci5pbmxhKQ0Kc2F2ZVJEUyhzdXJ2X2ZpdF9PTkkyLCAiLi9tb2RlbHMvbW9kZWxfb25pMi5SRFMiKQ0KYGBgDQoNCg0KYGBge3J9DQpzdXJ2X2ZpdF9PTkkyID0gcmVhZFJEUygiLi9tb2RlbHMvbW9kZWxfb25pMi5SRFMiKQ0Kc3VtbWFyeShzdXJ2X2ZpdF9PTkkyKQ0KDQpgYGANCg0KYGBge3J9DQppbmxhLmhwZG1hcmdpbmFsKDAuOTUsIHN1cnZfZml0X09OSTIkbWFyZ2luYWxzLmZpeGVkJGAoSW50ZXJjZXB0KWApDQppbmxhLmhwZG1hcmdpbmFsKDAuOTUsIHN1cnZfZml0X09OSTIkbWFyZ2luYWxzLmZpeGVkJE1KSikNCmBgYA0KDQpgYGB7cn0NCnJvdW5kKHN1cnZfZml0X09OSTIkc3VtbWFyeS5oeXBlcnBhciwgMykNCmBgYA0KDQoNCmBgYHtyfQ0KaW5sYS5ocGRtYXJnaW5hbCgwLjk1LCBzdXJ2X2ZpdF9PTkkyJG1hcmdpbmFscy5oeXBlcnBhciRgUHJlY2lzaW9uIGZvciBzZWFzb25gKQ0KaW5sYS5ocGRtYXJnaW5hbCgwLjk1LCBzdXJ2X2ZpdF9PTkkyJG1hcmdpbmFscy5oeXBlcnBhciRgUHJlY2lzaW9uIGZvciBTYCkNCmlubGEuaHBkbWFyZ2luYWwoMC45NSwgc3Vydl9maXRfT05JMiRtYXJnaW5hbHMuaHlwZXJwYXIkYFBoaSBmb3IgU2ApDQppbmxhLmhwZG1hcmdpbmFsKDAuOTUsIHN1cnZfZml0X09OSTIkbWFyZ2luYWxzLmh5cGVycGFyJGBQcmVjaXNpb24gZm9yIGJhc2VsaW5lLmhhemFyZGApDQpgYGANCg0KDQojIyMjIyBKRk0NCg0KYGBge3IgZXZhbD1GQUxTRSwgaW5jbHVkZT1UfQ0KZm9ybV9zdXJ2X09OSTMgPSBpbmxhLnN1cnYoZGF5cywgY291bnQpIH4gMSArIEpGTSArIA0KICBmKHNlYXNvbiwgbW9kZWwgPSAiaWlkIiwgaHlwZXIgPSBsaXN0KHByZWMgPSBsaXN0KHBhcmFtID0gYygwLjAwMSwwLjAwMSkpKSkrDQogIGYoUywgbW9kZWwgPSAiYnltMiIsIGdyYXBoID0gVy5wcl9kaXN0MjAwLA0KICAgIGh5cGVyID0gbGlzdChwcmVjID0gbGlzdChwYXJhbSA9IGMoMC4wMDEsIDAuMDAxKSksIA0KICAgICAgICAgICAgICAgICBwaGkgPSBsaXN0KHByaW9yID0gInBjIiwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW0gPSBjKHBoaS51LCBwaGkuYWxwaGEpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaXRpYWwgPSAtMykpKQ0KDQoNCnN1cnZfZml0X09OSTMgPSBpbmxhKGZvcm1fc3Vydl9PTkkzLA0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGlubGFfZGF0YV9lbnNvLA0KICAgICAgICAgICAgICAgICAgICAgICAgZmFtaWx5ID0gImNveHBoIiwNCiAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuaGF6YXJkID0gbGlzdChoeXBlciA9IGxpc3QocHJlYyA9IGxpc3QocGFyYW0gPSBjKDAuMDAxLCAwLjAwMSkpKSksDQogICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sLmNvbXB1dGU9bGlzdChkaWM9VFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNwbz1UUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpYz1UUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3Blbm1wLnN0cmF0ZWd5PSJodWdlIikpDQojIHN1bW1hcnkoc3Vydl9maXRfcHIuaW5sYSkNCiMgc3Vydl9maXRfcHIuaW5sYSA8LSBpbmxhLnJlcnVuKHN1cnZfZml0X3ByLmlubGEpDQpzYXZlUkRTKHN1cnZfZml0X09OSTMsICIuL21vZGVscy9tb2RlbF9vbmkzLlJEUyIpDQpgYGANCg0KDQpgYGB7cn0NCnN1cnZfZml0X09OSTMgPSByZWFkUkRTKCIuL21vZGVscy9tb2RlbF9vbmkzLlJEUyIpDQpzdW1tYXJ5KHN1cnZfZml0X09OSTMpDQoNCmBgYA0KDQpgYGB7cn0NCmlubGEuaHBkbWFyZ2luYWwoMC45NSwgc3Vydl9maXRfT05JMyRtYXJnaW5hbHMuZml4ZWQkYChJbnRlcmNlcHQpYCkNCmlubGEuaHBkbWFyZ2luYWwoMC45NSwgc3Vydl9maXRfT05JMyRtYXJnaW5hbHMuZml4ZWQkSkZNKQ0KYGBgDQoNCmBgYHtyfQ0Kcm91bmQoc3Vydl9maXRfT05JMyRzdW1tYXJ5Lmh5cGVycGFyLCAzKQ0KYGBgDQoNCg0KYGBge3J9DQppbmxhLmhwZG1hcmdpbmFsKDAuOTUsIHN1cnZfZml0X09OSTMkbWFyZ2luYWxzLmh5cGVycGFyJGBQcmVjaXNpb24gZm9yIHNlYXNvbmApDQppbmxhLmhwZG1hcmdpbmFsKDAuOTUsIHN1cnZfZml0X09OSTMkbWFyZ2luYWxzLmh5cGVycGFyJGBQcmVjaXNpb24gZm9yIFNgKQ0KaW5sYS5ocGRtYXJnaW5hbCgwLjk1LCBzdXJ2X2ZpdF9PTkkzJG1hcmdpbmFscy5oeXBlcnBhciRgUGhpIGZvciBTYCkNCmlubGEuaHBkbWFyZ2luYWwoMC45NSwgc3Vydl9maXRfT05JMyRtYXJnaW5hbHMuaHlwZXJwYXIkYFByZWNpc2lvbiBmb3IgYmFzZWxpbmUuaGF6YXJkYCkNCmBgYA0KDQoNCiMjIyBNZXRlb3JvbG9naWNhbCB2YXJpYWJsZXMNCmBgYHtyfQ0KbGlicmFyeShuYXNhcG93ZXIpDQpgYGANCg0KYGBge3J9DQpuYXNhX2ltcHV0ID0gc2JyX3JlcCAlPiUgDQogIGRwbHlyOjpzZWxlY3Qoc2Vhc29uLCBkYXRlX3JlcG9ydCwgbGF0LCBsb24pICU+JSANCiAgbXV0YXRlKHRocmVlX21vbnRoX2JlZm9yZSA9IGRhdGVfcmVwb3J0LTkwKQ0KYGBgDQoNCg0KDQpgYGB7ciBldmFsPUZBTFNFLCBpbmNsdWRlPVR9DQpib3hfbmFzYSA9IGRhdGEuZnJhbWUoKQ0Kc2Vhc29ucyA9IHVuaXF1ZShzYnJfcmVwJHNlYXNvbikNCnRvdGFsID0gMjQ0MQ0KayA9IDENCnBiIDwtIHR4dFByb2dyZXNzQmFyKG1pbiA9IDAsIG1heCA9IHRvdGFsLCBzdHlsZSA9IDMpDQpmb3IoaSBpbiAxOmxlbmd0aChzZWFzb25zKSl7DQpzX25hc2EgPSBuYXNhX2ltcHV0ICU+JQ0KICAgIGZpbHRlcihzZWFzb24gPT0gc2Vhc29uc1tpXSkNCg0KZm9yKGogaW4gMTpsZW5ndGgoc19uYXNhJGRhdGVfcmVwb3J0KSl7DQoNCnNldFR4dFByb2dyZXNzQmFyKHBiLCBrKQ0KICANCmZpbmFsX2RhdGEgPSBhcy5jaGFyYWN0ZXIoc19uYXNhJGRhdGVfcmVwb3J0W2pdKQ0KaW5pdF9kYXRhID0gYXMuY2hhcmFjdGVyKHNfbmFzYSR0aHJlZV9tb250aF9iZWZvcmVbal0pDQpsYXRfbmFzYSA9IHNfbmFzYSRsYXRbal0NCmxvbl9uYXNhID0gc19uYXNhJGxvbltqXQ0KDQpsaWxfYm94X25hc2EgPSBnZXRfcG93ZXIoDQogIGNvbW11bml0eSA9ICJhZyIsDQogIHRlbXBvcmFsX2FwaSA9ICJkYWlseSIsDQogIGRhdGVzID0gYyhpbml0X2RhdGEsIGZpbmFsX2RhdGEpLA0KICBsb25sYXQgPSBjKGxvbl9uYXNhLCBsYXRfbmFzYSksDQogIHBhcnMgPSBjKCJUMk0iLCAiUkgyTSIsIlBSRUNUT1RDT1JSIikNCikgJT4lDQogIG11dGF0ZShzZWFzb24gPSBzZWFzb25zW2ldLA0KICAgICAgICAgZGF0ZV9yZXBvcnQgPSBzX25hc2EkZGF0ZV9yZXBvcnRbal0pDQoNCmJveF9uYXNhID0gYm94X25hc2EgJT4lDQogIGJpbmRfcm93cyhsaWxfYm94X25hc2EpDQprPWsrMQ0KfQ0KIyBwcmludChzZWFzb25zW2ldKQ0KfQ0KcHJpbnQoIkRhdGEgZm9yIGFsbCBjb29yZGluYXRlcyBhbmQgZGF0ZXMgd2VyZSBkb3dubG9hZGVkIikNCndyaXRlLmNzdihib3hfbmFzYSwgImRhdGEvcmFpbmZhbGwuY3N2IikNCg0KYGBgDQoNCmBgYHtyfQ0KYm94X25hc2EgPSAgcmVhZC5jc3YoImRhdGEvcmFpbmZhbGwuY3N2IikgDQpuYXNhX2Z1bGwgPSBib3hfbmFzYSAlPiUgDQogIHJlbmFtZShsYXQgPSBMQVQsDQogICAgICAgICBsb24gPSBMT04sDQogICAgICAgICByYWluID0gUFJFQ1RPVENPUlIsDQogICAgICAgICB0ZW1wID0gVDJNLA0KICAgICAgICAgcmggPSBSSDJNKSAlPiUNCiAgbXV0YXRlKHNlYXNvbiA9IGFzLmNoYXJhY3RlcihzZWFzb24pLA0KICAgICAgICAgZGF0ZV9yZXBvcnQgPSBhcy5EYXRlKGRhdGVfcmVwb3J0KSwNCiAgICAgICAgIFlZWVlNTUREID0gYXMuRGF0ZShZWVlZTU1ERCkpICU+JSANCiAgZnVsbF9qb2luKGlubGFfZGF0YV9lbnNvKSAlPiUgDQogIGdyb3VwX2J5KHNlYXNvbixsYXQsIGxvbiwgIGRhdGVfcmVwb3J0LCBlbnNvKSAlPiUgDQogIG11dGF0ZShkYXlzX3RvX3JlcG9ydCA9IGFzLm51bWVyaWMoLShtYXgoWVlZWU1NREQpIC0gWVlZWU1NREQpKSkgDQpgYGANCg0KYGBge3J9DQpuYXNhX2Z1bGwgJT4lIA0KICBncm91cF9ieShzZWFzb24sbGF0LCBsb24sICBkYXRlX3JlcG9ydCwgZW5zbykgJT4lDQogIHN1bW1hcmlzZShtZWFuX3JhaW4gPSBtZWFuKHJhaW4pLA0KICAgICAgICAgICAgY3VtX3JhaW4gPSBzdW0ocmFpbikpICU+JSANCiAgZ2dwbG90KGFlcyhlbnNvLG1lYW5fcmFpbiwgZmlsbCA9ICBlbnNvKSkrDQogIHN0YXRfc2xhYihhbHBoYSA9IDAuNSkrDQogIHN0YXRfcG9pbnRpbnRlcnZhbCgpKw0KICBzY2FsZV9maWxsX2NvbG9yYmxpbmQoKSsNCiAgbGFicyh4ID0gICJFTlNPIHBoYXNlcyIsDQogICAgICAgeSA9ICJDdW1tdWxhdGl2ZSByYWluZmFsbCIpDQpgYGANCg0KDQojIyMjIyBSYWluZmFsbA0KYGBge3J9DQpyYWluX2dyYXBoID0gbmFzYV9mdWxsICU+JSANCiAgZ2dwbG90KGFlcyhkYXlzX3RvX3JlcG9ydCwgcmFpbiwgY29sb3IgPSBlbnNvKSkrDQogIGdlb21fc21vb3RoKG1ldGhvZCA9ICdnYW0nLGZvcnVtdWxhID0geSB+IHMoeCwgYnMgPSAidHAiKSkrDQogIHNjYWxlX2NvbG9yX2NvbG9yYmxpbmQoKSsNCiAgbGFicyh4ID0gIkRheXMgYmVmb3JlIHJlcG9ydCIsDQogICAgICAgeSA9ICJSYWluZmFsbCAobW0pIiwNCiAgICAgICBjb2xvciA9ICJFTlNPIHBoYXNlcyIsDQogICAgICAgdGl0bGUgPSAiUmFpbmZhbGwiKSsNCiAgc2NhbGVfeF9jb250aW51b3VzKGxpbWl0cyA9IGMoLTkwLDApLCBicmVha3MgPSBzZXEoLTkwLDAsYnk9MTUpKSsNCiAgdGhlbWVfaGFsZl9vcGVuKGZvbnRfc2l6ZSA9IDEyKQ0KcmFpbl9ncmFwaA0KYGBgDQoNCiMjIyMjIFJlbGF0aXZlIGh1bWlkaXR5DQoNCmBgYHtyfQ0KcmhfZ3JhcGggPSBuYXNhX2Z1bGwgJT4lIA0KICBnZ3Bsb3QoYWVzKGRheXNfdG9fcmVwb3J0LCByaCwgY29sb3IgPSBlbnNvKSkrDQogIGdlb21fc21vb3RoKG1ldGhvZCA9ICdnYW0nLGZvcnVtdWxhID0geSB+IHMoeCwgYnMgPSAidHAiKSkrDQogIHNjYWxlX2NvbG9yX2NvbG9yYmxpbmQoKSsNCiAgbGFicyh4ID0gIkRheXMgYmVmb3JlIHJlcG9ydCIsDQogICAgICAgeSA9ICJSZWxhdGl2ZSBodW1pZGl0eSAoJSkiLA0KICAgICAgIGNvbG9yID0gIkVOU08gcGhhc2VzIiwNCiAgICAgICB0aXRsZSA9ICJBdmVyYWdlIHJhbGF0aXZlIGh1bWlkaXR5IikrDQogIHNjYWxlX3hfY29udGludW91cyhsaW1pdHMgPSBjKC05MCwwKSwgYnJlYWtzID0gc2VxKC05MCwwLGJ5PTE1KSkrDQogIHRoZW1lX2hhbGZfb3Blbihmb250X3NpemUgPSAxMikNCnJoX2dyYXBoDQpgYGANCg0KDQojIyMjIyBUZW1wZXJhdHVyZQ0KDQpgYGB7cn0NCnRlbXBfZ3JhcGggPSBuYXNhX2Z1bGwgJT4lIA0KICBnZ3Bsb3QoYWVzKGRheXNfdG9fcmVwb3J0LCB0ZW1wLCBjb2xvciA9IGVuc28pKSsNCiAgZ2VvbV9zbW9vdGgobWV0aG9kID0gJ2dhbScsZm9ydW11bGEgPSB5IH4gcyh4LCBicyA9ICJ0cCIpKSsNCiAgc2NhbGVfY29sb3JfY29sb3JibGluZCgpKw0KICBsYWJzKHggPSAiRGF5cyBiZWZvcmUgcmVwb3J0IiwNCiAgICAgICB5ID0gIlRlbXBlcmF0dXJlICjCsEMpIiwNCiAgICAgICBjb2xvciA9ICJFTlNPIHBoYXNlcyIsDQogICAgICAgdGl0bGUgPSAiQXZlcmFnZSB0ZW1wZXJhdHVyZSIpKw0KICBzY2FsZV94X2NvbnRpbnVvdXMobGltaXRzID0gYygtOTAsMCksIGJyZWFrcyA9IHNlcSgtOTAsMCxieT0xNSkpKw0KICB0aGVtZV9oYWxmX29wZW4oZm9udF9zaXplID0gMTIpDQp0ZW1wX2dyYXBoDQpgYGANCg0KYGBge3J9DQpyYWluX2dyYXBoICsgcmhfZ3JhcGggK3RlbXBfZ3JhcGgrDQogIHBsb3RfYW5ub3RhdGlvbih0YWdfbGV2ZWxzID0gIkEiKSsNCiAgcGxvdF9sYXlvdXQoZ3VpZGVzID0gImNvbGxlY3QiLCBuY29sID0gMSkmDQogIGdlb21fdmxpbmUoeGludGVyY2VwdCA9IDAsIGNvbG9yID0gImdyYXkiLCBsaW5ldHlwZSA9IDIpJg0KICB0aGVtZShwbG90LnRpdGxlID0gZWxlbWVudF90ZXh0KHNpemUgPSAxMCksDQogICAgICAgICMgbGVnZW5kLnBvc2l0aW9uID0gImJvdHRvbSINCiAgICAgICAgKQ0KZ2dzYXZlKCJmaWdzL21ldF9kYXRhLnBuZyIsIGRwaSA9IDYwMCwgaGVpZ2h0ID0gOCwgd2lkdGggPSA1LjUpDQpgYGANCg0KDQoNCg0KDQpgYGB7cn0NCmlubGFfZGF0YV9yYWluID0gbmFzYV9mdWxsICU+JSANCiAgZ3JvdXBfYnkoc2Vhc29uLGxhdCwgbG9uLFMsIGRheXMsY291bnQsIGRhdGVfcmVwb3J0LCBlbnNvKSAlPiUgDQogIHN1bW1hcmlzZShtZWFuX3JhaW4gPW1lYW4ocmFpbiksDQogICAgICAgICAgICBjdW1fcmFpbiA9IHN1bShyYWluKSkNCg0KYGBgDQoNCiMjIyBNb2RlbGluZw0KDQpgYGB7ciBldmFsPUZBTFNFLCBpbmNsdWRlPVR9DQpmb3JtX3N1cnZfcmFpbiA9IGlubGEuc3VydihkYXlzLCBjb3VudCkgfiAxICsgbWVhbl9yYWluICsgDQogIGYoc2Vhc29uLCBtb2RlbCA9ICJpaWQiLCBoeXBlciA9IGxpc3QocHJlYyA9IGxpc3QocGFyYW0gPSBjKDAuMDAxLDAuMDAxKSkpKSsNCiAgZihTLCBtb2RlbCA9ICJieW0yIiwgZ3JhcGggPSBXLnByX2Rpc3QyMDAsDQogICAgaHlwZXIgPSBsaXN0KHByZWMgPSBsaXN0KHBhcmFtID0gYygwLjAwMSwgMC4wMDEpKSwgDQogICAgICAgICAgICAgICAgIHBoaSA9IGxpc3QocHJpb3IgPSAicGMiLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbSA9IGMocGhpLnUsIHBoaS5hbHBoYSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdGlhbCA9IC0zKSkpDQoNCg0Kc3Vydl9maXRfcmFpbiA9IGlubGEoZm9ybV9zdXJ2X3JhaW4gLA0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGlubGFfZGF0YV9yYWluLA0KICAgICAgICAgICAgICAgICAgICAgICAgZmFtaWx5ID0gImNveHBoIiwNCiAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuaGF6YXJkID0gbGlzdChoeXBlciA9IGxpc3QocHJlYyA9IGxpc3QocGFyYW0gPSBjKDAuMDAxLCAwLjAwMSkpKSksDQogICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sLmNvbXB1dGU9bGlzdChkaWM9VFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNwbz1UUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpYz1UUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3Blbm1wLnN0cmF0ZWd5PSJodWdlIikpDQoNCnNhdmVSRFMoc3Vydl9maXRfcmFpbiwgIi4vbW9kZWxzL21vZGVsX3JhaW4uUkRTIikNCmBgYA0KDQoNCmBgYHtyIGV2YWw9RkFMU0UsIGluY2x1ZGU9VH0NCnN1cnZfZml0X3JhaW4gPSByZWFkUkRTKCIuL21vZGVscy9tb2RlbF9yYWluLlJEUyIpDQpzdW1tYXJ5KHN1cnZfZml0X3JhaW4gKQ0KYGBgDQoNCg0KDQoNCg0KDQojIE1BUFMgDQpgYGB7cn0NCm1hcF9kYXRhID0gc2JyX3JlcF9jb3VudF9uZXcgJT4lIA0KICBncm91cF9ieShsYXQsIGxvbixNVU5JQ19QSU8pICU+JSANCiAgc3VtbWFyaXNlKGNvdW50ID0gc3VtKGNvdW50KSkNCg0Kc3VsX2RmICU+JSANCiAgZnVsbF9qb2luKG1hcF9kYXRhLCBieSA9Ik1VTklDX1BJTyIpICU+JSANCiAgZ2dwbG90KCkrDQogIGdlb21fc2YoZGF0YSA9U1VMICU+JSBmaWx0ZXIobmFtZSAhPSAiQnJhemlsIiksDQogICAgICAgICAgc2l6ZSA9IDMsDQogICAgICAgICAgZmlsbCA9ICJ3aGl0ZSIsDQogICAgICAgICAgY29sb3IgPSAid2hpdGUiKSsNCiAgZ2VvbV9zZihkYXRhID0gQlJBLA0KICAgICAgICAgIHNpemUgPSAwLjIsDQogICAgICAgICAgZmlsbCA9ICJ3aGl0ZSIsDQogICAgICAgICAgY29sb3IgPSAiYmxhY2siKSsNCiAgIyBnZW9tX3NmKGRhdGEgPSBzdWxfc2YsICBjb2xvciA9ICJibGFjayIsIHNpemUgPSAwLjIsICBmaWxsID0gInN0ZWVsYmx1ZSIpKw0KICBnZW9tX3BvbHlnb24oYWVzKGxvbmcsIGxhdC54LCBncm91cCA9aWQsIGZpbGwgPSBjb3VudCksIA0KICAgICAgICAgICAgICAgY29sb3IgPSBOQSkrDQogIGdlb21fc2YoZGF0YSA9IHN1bF9zZiwgIGNvbG9yID0gImJsYWNrIiwgc2l6ZSA9IDAuMiwgIGZpbGwgPSBOQSkrDQogICMgZ2VvbV9wb2ludChkYXRhID0gbWFwX2RhdGEsIGFlcyhsb24sIGxhdCksIHNpemUgPSAwLjEsIGNvbG9yID0gImJsYWNrIikrDQogIGdlb21fdGV4dChkYXRhID0gc3VsX3NmLCAjJT4lIA0KICAgICAgICAgICAgICAjZmlsdGVyKCFwb3N0YWwgJWluJSBjKCJTRSIsICJBTCIsIlBFIiwiUEIiLCJSTiIsIkVTIiwiUkoiKSksDQogICAgICAgICAgICBhZXMoeCA9IGxvbmdpdHVkZSwNCiAgICAgICAgICAgICAgICB5ID0gbGF0aXR1ZGUsDQogICAgICAgICAgICAgICAgbGFiZWwgPSBwb3N0YWwpLHNpemUgPSA1LA0KICAgICAgICAgICAgZm9udGZhY2UgPSAiYm9sZCIsIGNvbG9yID0gImJsYWNrIikrDQogIGNvb3JkX2VxdWFsKCkrDQogIHNjYWxlX2ZpbGxfZ3JhZGllbnQobG93PSAid2hpdGUiLCBoaWdoID0gInJlZCIsIG5hLnZhbHVlID0gIndoaXRlIiwgbGltaXRzID0gYygwLDE3KSkrDQogIHhsaW0oLTU3LjcsLTQ4KSsNCiAgeWxpbSgtMzMuNSwtMjIuNSkrDQogIGNvb3JkX3NmKCkrDQogIGxhYnMoeCA9ICJMb25naXR1ZGUiLA0KICAgICAgIHkgPSAiTGF0aXR1ZGUiLA0KICAgICAgIGZpbGwgPSAiTiIpKw0KICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDkwLCBoanVzdCA9IDEpLA0KICAgICAgICBsZWdlbmQucG9zaXRpb24gPSAiYm90dG9tIiwNCiAgICAgICAgcGFuZWwuZ3JpZCA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgICAgcGFuZWwuYmFja2dyb3VuZCA9IGVsZW1lbnRfcmVjdChmaWxsID0gInN0ZWVsYmx1ZSIpKSsNCiAgbm9ydGgoIGxvY2F0aW9uID0gImJvdHRvbXJpZ2h0Iiwgc2NhbGUgPSAwLjA4LCBzeW1ib2wgPSAxMCwgeC5taW49LTU4LCB4Lm1heD0tNDguOSwgeS5taW49LTMyLjksIHkubWF4PS0yMi4zKSsNCiAgZ2dzbjo6c2NhbGViYXIobG9jYXRpb24gPSAiYm90dG9tcmlnaHQiLCBkaXN0ID0gMTAwLA0KICAgICAgICAgICBkaXN0X3VuaXQgPSAia20iLCB0cmFuc2Zvcm0gPSBUUlVFLCANCiAgICAgICAgICAgeC5taW49LTU4LCB4Lm1heD0tNDguMiwgeS5taW49LTMzLjUsIHkubWF4PS0yMi4zLA0KICAgICAgICAgICBzdC5ib3R0b20gPSBGQUxTRSwgaGVpZ2h0ID0gMC4wMSwNCiAgICAgICAgICAgc3QuZGlzdCA9IDAuMDMsIHN0LnNpemUgPSAyKQ0KZ2dzYXZlKCJmaWdzL2ZpZzFfbWFwLnBuZyIsIGRwaSA9IDkwMCwgaGVpZ2h0ID0gNi41LCB3aWR0aCA9IDUpDQoNCmBgYA0KDQojIyMgY3VtdWxhdGl2ZSByZXBvcnRzDQoNCmBgYHtyfQ0KbW9udGhzID0gYygiU2VwIiwgIk9jdCIsICJOb3YiLCAiRGVjIiwgIkphbiIsICJGZWIiLCAiTWFyIiwiQXByIiwiTWF5IikNCm1vbnRocyA9IHVuaXF1ZShzYnJfcmVwJG1vbnRoKQ0Kc2JyX3JlcF9jdW1tbSA9IGRhdGEuZnJhbWUoKQ0KZm9yKGkgaW4gMToobGVuZ3RoKG1vbnRocykpKXsNCg0KY3VtdWxhdGl2ZSA9IHNicl9yZXAgJT4lDQogIHVuZ3JvdXAoKSAlPiUNCiAgICBmaWx0ZXIobW9udGggPD0gbW9udGhzW2ldKSAlPiUNCiAgICBkcGx5cjo6c2VsZWN0KHNlYXNvbiwgc3RhdGUsIFBoZW5fc3RhdGUsIGxhdF91dG0sIGxvbl91dG0sIGxhdCwgbG9uLCBkYXlzKSAlPiUNCiAgICBtdXRhdGUobW9udGggPSBtb250aHNbaV0pDQoNCnNicl9yZXBfY3VtbW0gPSBzYnJfcmVwX2N1bW1tICU+JQ0KICBiaW5kX3Jvd3MoY3VtdWxhdGl2ZSkNCn0NCnNicl9yZXBfY3VtbW0kbW9udGggPSBmYWN0b3Ioc2JyX3JlcF9jdW1tbSRtb250aCwgbGV2ZWxzID0gYygiU2V0IiwgIk9jdCIsICJOb3YiLCAiRGVjIiwgIkphbiIsICJGZWIiLCAiTWFyIiwiQXByIiwiTWF5IikpDQpgYGANCg0KDQoNCg0KDQoNCg0K</div>


Copyright 2017 Emerson Del Ponte


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("main_spatial.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
