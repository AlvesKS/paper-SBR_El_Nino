{"title":"Data analysis","markdown":{"yaml":{"title":"Data analysis"},"headingText":"Packages","containsRefs":false,"markdown":"\n\n\n::: callout-warning\n# R packages instalation\n\nMake sure to have all packages bellow instaled before reproducing the analysis. To install these packages, one can use the function `install.packages()`. However, for installing the INLA package, we recommend following the instruction provided the [INLA website](https://www.r-inla.org/download-install){target=\"_blank\"}.\n:::\n\n```{r warning=FALSE, message=FALSE}\nlibrary(tidyverse)\nlibrary(ggdist)\nlibrary(rgdal)\nlibrary(spdep)\nlibrary(INLA)\nlibrary(distributional)\nlibrary(viridis)\nlibrary(lubridate)\nlibrary(lemon)\nlibrary(ggthemes)\nlibrary(cowplot)\n\n```\n\n\n```{r eval=TRUE, include=FALSE}\n# code for printing df in a paged format\nlibrary(knitr)\nknit_print.data.frame <- function (x, options, ...) {\n  rmarkdown::paged_table(x, options) %>% \n    rmarkdown:::print.paged_df()\n}\nregisterS3method(\"knit_print\", \"data.frame\", knit_print.data.frame)\n```\n\n# Load SBR data\n\nThe data on SBR occurrences in Southern Brazil can be loaded as shown in the code chunk below. Notice that we performed the transformation on the type date column types to `date` format. The column `season` was also transformed to type `character`.\n\n```{r}\nsbr_rep = read.csv(\".data/sbr_rep.csv\") %>% \n  #removing ther X column \n  dplyr::select(-X) %>% \n  \n  # tranforming the date columns to type date\n  mutate(start_season = as.Date(start_season),\n         start_date = as.Date(start_date),\n         date_report = as.Date(date_report)) %>% \n  # tranforming the seasons column to type character\n  mutate(season = as.character(season))\n\n\n\n```\n\n# Summaries SBR occurrence\n\nIn this part we extract some sumaries from the SBR data set\n\n### Number of reports\n\n```{r}\nsbr_rep %>% \n  summarise(n_reports = length(date_report))\n  \n```\n\n### Number of reports by state\n\n```{r}\nsbr_rep %>% \n  group_by(state) %>%\n  summarise(n_reports = length(date_report))\n  \n```\n\n```{r}\nsbr_rep %>%\n  group_by(state) %>% \n  summarise(length(unique(location)))\n```\n\n### Number of reports by season\n\n```{r}\nsbr_rep %>% \n  group_by(season) %>%\n  summarise(n_reports = length(date_report)) %>% \n  arrange(n_reports)\n  \n```\n\n### Earliests reports per season\n\n```{r}\nsbr_rep %>% \n  group_by(season) %>% \n  filter(date_report == min(date_report)) %>% \n  arrange(days_sep15)\n```\n\n### Distribution of dates of SBR occurrences\n\n```{r}\nsbr_rep %>%\n  mutate(year_s = as.numeric(season)-2000,\n         year_date = year(date_report),\n         year_new = year_date-year_s,\n         month2 = month(date_report),\n         day = day(date_report)) %>%\n  unite(date_altered, year_new, month2, day, sep =\"-\") %>%\n  mutate(date_altered = as.Date(date_altered)) %>%\n  ggplot(aes(y= season, x = days)) +\n  stat_histinterval(aes(fill = stat(pdf)),\n                    slab_type = \"histogram\",\n                    geom = \"slab\",\n                    breaks = 20\n                    )+\n  geom_point(shape = \"|\", size =2)+\n  theme_half_open()+\n  background_grid(major = \"y\")+\n  scale_x_continuous(limits = c(0,215),\n                     labels = format(as.Date(c(seq(0,215, by = 50)+as.Date(\"2000-09-15\")),\n                               format = \"%d-%b-%Y\"),\"%b %d\")\n                     )+\n  scale_fill_gradient(low =\"#1e88e5ff\", high = \"#ff0d57ff\")+\n  labs(x = \"Dates\",\n       y = \"Season\")+\n \n  theme(axis.text.x = element_text(),\n        strip.background = element_blank(),\n        legend.position = \"none\"\n        )\n\nggsave(\".figs/histogram_dates.png\", dpi = 600, height = 10, width = 6)\n\n\n```\n\n# ENSO\n\n## Load ENSO data\n\nHere we load the data on Oceanic Niño Index (ONI)\n\n```{r}\nensodata2 =read.csv( \".data/enso_tidy.csv\") %>% \n  #removing ther X column \n  dplyr::select(-X) %>% \n  # reodering the enso column as \"Neutral\" > \"El Niño\" > \"La Niña\"\n  mutate(enso = factor(enso, c(\"Neutral\",\"El Niño\", \"La Niña\"))) %>% \n  # tranforming the seasons column to type character\n  mutate(season = as.character(season))\n```\n\n## Exploring ENSO data\n\n```{r}\nONI_trimesters = ensodata2 %>% \n  pivot_longer(1:12,\n               names_to = \"trimester\",\n               values_to = \"ONI\") %>% \n  mutate(trimester = factor(trimester,\n                            levels =c(\"DJF\",\"JFM\",\"FMA\",\"MAM\",\"AMJ\",\"MJJ\",\"JJA\",\"JAS\",\"ASO\",\"SON\",\"OND\",\"NDJ\" ) ))\nONI_trimesters\n```\n\n### ONI over time for each year (2004 to 2020)\n\n```{r}\nONI_trimesters %>% \n  ggplot(aes(trimester, ONI, group = season, color = enso))+\n  geom_hline(yintercept = 0, color = \"gray\")+\n  scale_color_colorblind()+\n  geom_vline(xintercept = \"OND\", color = \"gray\")+\nstat_summary(fun.y=sum, geom=\"line\")+\n  theme_half_open()\n  \n```\n\n### ONI for selected trimesters\n\n- January, February, and March (ONI~JFM~, prior to the growing season);\n- May, June, and July (ONI~MJJ~, prior to the growing season);\n- October, November, and December (ONI~OND~, within the growing season)\n\n```{r}\nONI_trimesters %>%  \n  filter(trimester %in% c(\"JFM\", \"MJJ\", \"OND\")) %>% \n  ggplot(aes( trimester, ONI, group = trimester, color = ONI))+\n  geom_hline(yintercept = 0, color = \"gray\")+\n  geom_errorbar(aes(ymin=0, ymax  = ONI), width = 0, color = \"black\")+\n  geom_line(aes(group = season), color=\"black\")+\n  geom_point(size = 3)+\n   \n  geom_segment(x = 2.7, y = 2.8, xend = 3.6, yend =2.8,\n               color = \"black\",\n               size =1,\n               arrow = arrow(length = unit(0.09, \"npc\")))+\n  annotate(geom =\"text\", x = 2.5, y =3.25 ,label = \"Growing season\", size = 2.5)+\n  scale_y_continuous(breaks = seq(-1.6, 2.4, by  = 0.8))+\n  scale_color_viridis()+\n  theme_half_open(font_size = 12)+\n  facet_rep_wrap(~season)+\n  labs(x = \"Trimester\",\n       y = \"Oceanic Niño Index (°C)\",\n       color = \"ENSO phase (OND)\")+\n  theme(strip.background = element_blank(),\n        \n        legend.position = \"none\")\n\nggsave(\".figs/ONItrimeter.png\", dpi = 600, height = 6.5, width = 9, bg = \"white\")\n```\n\n\n### ONI distribution per trimester\n\n- ONI values arranged from lowest to highest\n\n```{r}\nONI_trimesters%>% \n  filter(trimester %in% c(\"JFM\", \"MJJ\", \"OND\")) %>% \n  arrange(ONI)\n```\n\n- Boxplot\n\n```{r}\nONI_trimesters%>% \n  filter(trimester %in% c(\"JFM\", \"MJJ\", \"OND\")) %>% \n  ggplot(aes(trimester, ONI, color = ONI))+\n  geom_hline(yintercept = 0, linetype = 2, color=\"gray\")+\n  geom_boxplot(width = 0.2, alpha =0)+\n  geom_jitter(width = 0.1, size =2)+\n  scale_color_viridis()+\n  theme_half_open()+\n  labs(x = \"Trimester\",\n       y = \"Oceanic Niño index (ONI) (°C)\")+\n  theme(legend.position = \"none\")\n\nggsave(\".figs/ONIbox_plot.png\", dpi = 600, height = 4, width = 4, bg = \"white\")\n\n```\n\n- Summaries\n\n```{r}\nONI_trimesters%>% \n  filter(trimester %in% c(\"JFM\", \"MJJ\", \"OND\")) %>% \n  group_by(trimester) %>% \n  summarise(ONI_mean = round(mean(ONI),2),\n            ONI_sd = round(sd(ONI),2),\n            median(ONI),\n            min(ONI),\n            max(ONI))\n```\n\n\n\n# Modeling the effect of ONI\n\n## Cox Proportional Hazards Model\n\n### Data preparation\n\n#### SBR data\n\n```{r}\nsbr_rep_count = sbr_rep %>%\n  mutate(count =  1) %>% \n  mutate(season = as.character(season))\n```\n\n#### Loading shapefiles\n\nShape files will be used for the obtaining the spatial structure of municipalities\n\n```{r warning=FALSE, message=FALSE}\nshape_sul= readOGR(\".shapefiles/BR_MUN1997_S_region\",\"BR_MUN1997_S_region\" )\n\nshape_sul@data$id = rownames(shape_sul@data)\nsul_points = fortify(shape_sul)\nsul_df =plyr::join(sul_points, shape_sul@data, by=\"id\")\n\n```\n\nObtaining the names of the municipalities from the shape files (formatting in the municipalies names in SBR dataset and shape files were different).\n\n```{r}\nIDs = unique(sul_df$id)\nlocation2 = numeric(length(sbr_rep_count$lat))\nfor(i in 1:length(IDs)){\n qqq = sul_df %>%\n  filter(id == IDs[i])\n\ncity = as.character(unique(qqq$MUNIC_PIO))\n\n for(j in 1:length(sbr_rep_count$lat)){\n    pip = point.in.polygon(point.x = sbr_rep_count$lon[j],\n                           point.y = sbr_rep_count$lat[j],\n                           pol.x = qqq$long,\n                           pol.y = qqq$lat)\n\n      if(pip > 0){location2[j] = city}\n\n }\n}\nsbr_rep_count_new = sbr_rep_count %>%\n  mutate(MUNIC_PIO = location2)\n\n\n```\n\n#### INLA Data\n\nCreating the data set with new municipalities names\n\n```{r}\nmonths = c(\"Sep\", \"Oct\", \"Nov\", \"Dec\", \"Jan\", \"Feb\", \"Mar\",\"Apr\",\"May\")\ninla_data_geral = sbr_rep_count %>%\n  mutate(month = factor(month, levels = months)) %>% \n  full_join(sbr_rep_count_new %>% mutate(month = factor(month, levels = months))) %>% \n  full_join(data.frame(MUNIC_PIO = unique(sbr_rep_count_new$MUNIC_PIO)) %>% \n  mutate(S = 1:length(MUNIC_PIO)))\n```\n\n#### adding ONI values\n\n```{r}\ninla_data_enso = inla_data_geral %>% \n  full_join(ensodata2)\n```\n\n\n#### Neighbour by distance 200 km\n\n```{r}\nsul_locations = unique(sbr_rep_count_new$MUNIC_PIO)\n\nshape_sul_sub = subset(shape_sul, shape_sul$MUNIC_PIO%in%sul_locations )\n\ncoords_pr = coords <- coordinates(shape_sul_sub)\n\nIDs_pr <- row.names(as(shape_sul_sub, \"data.frame\"))\n\nlong = coords_pr[,1]\nlat = coords_pr[,2]\nxy <- data.frame(ID = 1:(length(lat)), long, lat)\n\ncoordinates(xy) <- c(\"long\", \"lat\")\nproj4string(xy) <- CRS(\"+init=epsg:4326\")\n\nres <- spTransform(xy, CRS(\"+proj=utm +zone=22 +south ellps=WGS84\"))\n\ncoords_grid = as.data.frame(res)\ncoords2 = as.matrix(coords_grid[,2:3])\ncolnames(coords2) <- c(\"x1\",\"x2\")\n\n\ndnear_dist_200 = dnearneigh(coords2, 0,200000, row.names=IDs_pr)\n\n# nb2INLA(\"./models/grid200.graph\",dnear_dist_200)\nW.pr_dist200 = inla.read.graph(\"./.models/grid200.graph\")\nplot(shape_sul_sub)\nplot(dnear_dist_200,coordinates(shape_sul_sub),col =\"red\", add = T)\n\n```\n\n\n### Model fitting\n\n-  PC priors\n\n```{r}\nu <- 0.2/0.31\nalpha <- 0.01\nphi.u <- 0.5\nphi.alpha <- 2/3\n```\n\n#### Model for OND\n\n```{r eval=FALSE, include=T}\nform_surv_ONI1 = inla.surv(days, count) ~ 1 + OND + \n  f(season, model = \"iid\", hyper = list(prec = list(param = c(0.001,0.001))))+\n  f(S, model = \"bym2\", graph = W.pr_dist200,\n    hyper = list(prec = list(param = c(0.001, 0.001)), \n                 phi = list(prior = \"pc\", \n                            param = c(phi.u, phi.alpha),\n                            initial = -3)))\n\n\nsurv_fit_ONI1 = inla(form_surv_ONI1,\n                        data = inla_data_enso,\n                        family = \"coxph\",\n                     control.fixed=list(prec.intercept=1),\n                      control.hazard = list(hyper = list(prec = list(param = c(0.001, 0.001)))),\n                        control.compute=list(dic=TRUE,\n                                             cpo=TRUE,\n                                             waic=TRUE,\n                                             openmp.strategy=\"huge\"))\n\n# saveRDS(surv_fit_ONI1, \"./.models/model_oni1.RDS\")\n```\n\n```{r include=FALSE, eval=TRUE}\nsurv_fit_ONI1 = readRDS(\"./.models/model_oni1.RDS\")\n```\n\n##### Model summary\n\n```{r}\nsummary(surv_fit_ONI1)\n```\n\n##### Parameters\n\n###### Posterior distribution summaries\n\n```{r}\npar_summ_ond = data.frame(surv_fit_ONI1$summary.fixed %>% \n             dplyr::select(`mean`,`0.5quant`,`mode`,`sd`) %>% \n             dplyr::rename(median = `0.5quant`))\n\n\n```\n\n###### HPD intervas\n\n```{r}\n# intercept(beta_0)\npar_hpd_ond=\nbind_rows(\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.fixed$`(Intercept)`)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.fixed$`(Intercept)`)[2],\n           row.names = \"(Intercept)\"),\n# slope (ONI)\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.fixed$OND)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.fixed$OND)[2],\n           row.names = \"OND\") \n)\n\n```\n\n```{r}\npar_ond = bind_cols(par_summ_ond ,par_hpd_ond)\npar_ond\n```\n\n##### Hyperparameters\n\n###### Posterior distribution summaries\n\n```{r}\nhyper_summ_ond = round(surv_fit_ONI1$summary.hyperpar, 3) %>% \n  dplyr::select(`mean`,`0.5quant`,`mode`,`sd`) %>% \n  dplyr::rename(median = `0.5quant`)\n```\n\n###### HPD intervas\n\n```{r}\nhyper_hpd_ond = \nbind_rows(\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.hyperpar$`Precision for season`)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.hyperpar$`Precision for season`)[2],\n           row.names = \"Precision for season\"),\n\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.hyperpar$`Precision for S`)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.hyperpar$`Precision for S`)[2],\n           row.names = \"Precision for S\"),\n\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.hyperpar$`Phi for S`)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.hyperpar$`Phi for S`)[2],\n           row.names = \"Phi for S\"),\n\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.hyperpar$`Precision for baseline.hazard`)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI1$marginals.hyperpar$`Precision for baseline.hazard`)[2],\n           row.names = \"Precision for baseline.hazard\")\n)\n```\n\n```{r}\nhyper_ond = bind_cols(hyper_summ_ond,hyper_hpd_ond)\n```\n\n```{r}\nbind_rows(par_ond,hyper_ond) %>% \n  rownames_to_column(\"parameter\") \n```\n\n#### Model for MJJ\n\n```{r eval=FALSE, include=T}\nform_surv_ONI2 = inla.surv(days, count) ~ 1 + MJJ +\n  f(season, model = \"iid\", hyper = list(prec = list(param = c(0.001,0.001))))+\n  f(S, model = \"bym2\", graph = W.pr_dist200,\n    hyper = list(prec = list(param = c(0.001, 0.001)), \n                 phi = list(prior = \"pc\", \n                            param = c(phi.u, phi.alpha),\n                            initial = -3)))\n\n\nsurv_fit_ONI2 = inla(form_surv_ONI2,\n                        data = inla_data_enso,\n                        family = \"coxph\",\n                     control.fixed=list(prec.intercept=1),\n                     control.hazard = list(hyper = list(prec = list(param = c(0.001, 0.001)))),\n                        control.compute=list(dic=TRUE,\n                                             cpo=TRUE,\n                                             waic=TRUE,\n                                             openmp.strategy=\"huge\"))\n\n# saveRDS(surv_fit_ONI2, \"./.models/model_oni2.RDS\")\n```\n\n```{r include=FALSE, eval=TRUE}\nsurv_fit_ONI2 = readRDS(\"./.models/model_oni2.RDS\")\n```\n\n##### Model summary\n\n```{r}\nsummary(surv_fit_ONI2)\n\n```\n\n##### Parameters\n\n###### Posterior distribution summaries\n\n```{r}\npar_summ_mjj = \ndata.frame(surv_fit_ONI2$summary.fixed %>% \n             dplyr::select(`mean`,`0.5quant`,`mode`,`sd`) %>% \n             dplyr::rename(median = `0.5quant`))\n\n```\n\n###### HPD intervas\n\n```{r}\npar_hpd_mjj = \n# intercept(beta_0)\nbind_rows(\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.fixed$`(Intercept)`)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.fixed$`(Intercept)`)[2],\n           row.names = \"(Intercept)\"),\n# slope (ONI)\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.fixed$MJJ)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.fixed$MJJ)[2],\n           row.names = \"MJJ\") \n)\n\n```\n\n```{r}\npar_mjj = bind_cols(par_summ_mjj,par_hpd_mjj)\n```\n\n##### Hyperparameters\n\n###### Posterior distribution summaries\n\n```{r}\nhyper_summ_mjj = \nround(surv_fit_ONI2$summary.hyperpar, 3) %>% \n  dplyr::select(`mean`,`0.5quant`,`mode`,`sd`) %>% \n  dplyr::rename(median = `0.5quant`)\n```\n\n###### HPD intervas\n\n```{r}\nhyper_hpd_mjj = \nbind_rows(\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.hyperpar$`Precision for season`)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.hyperpar$`Precision for season`)[2],\n           row.names = \"Precision for season\"),\n\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.hyperpar$`Precision for S`)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.hyperpar$`Precision for S`)[2],\n           row.names = \"Precision for S\"),\n\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.hyperpar$`Phi for S`)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.hyperpar$`Phi for S`)[2],\n           row.names = \"Phi for S\"),\n\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.hyperpar$`Precision for baseline.hazard`)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI2$marginals.hyperpar$`Precision for baseline.hazard`)[2],\n           row.names = \"Precision for baseline.hazard\")\n)\n```\n\n```{r}\nhyper_mjj = bind_cols(hyper_summ_mjj,hyper_hpd_mjj)\nhyper_mjj\n```\n\n#### Model for  JFM\n\n```{r eval=FALSE, include=T}\nform_surv_ONI3 = inla.surv(days, count) ~ 1 + JFM + \n  f(season, model = \"iid\", hyper = list(prec = list(param = c(0.001,0.001))))+\n  f(S, model = \"bym2\", graph = W.pr_dist200,\n    hyper = list(prec = list(param = c(0.001, 0.001)), \n                 phi = list(prior = \"pc\", \n                            param = c(phi.u, phi.alpha),\n                            initial = -3)))\n\n\nsurv_fit_ONI3 = inla(form_surv_ONI3,\n                        data = inla_data_enso,\n                        family = \"coxph\",\n                     control.fixed=list(prec.intercept=1),\n                     control.hazard = list(hyper = list(prec = list(param = c(0.001, 0.001)))),\n                        control.compute=list(dic=TRUE,\n                                             cpo=TRUE,\n                                             waic=TRUE,\n                                             openmp.strategy=\"huge\"))\n\n# saveRDS(surv_fit_ONI3, \"./.models/model_oni3.RDS\")\n```\n\n```{r include=FALSE, eval=TRUE}\nsurv_fit_ONI3 = readRDS(\"./.models/model_oni3.RDS\")\n```\n\n\n##### Model summary\n\n```{r}\nsummary(surv_fit_ONI3)\n```\n\n##### Parameters\n\n###### Posterior distribution summaries\n\n```{r}\npar_summ_jfm = \n data.frame(surv_fit_ONI3$summary.fixed %>% \n             dplyr::select(`mean`,`0.5quant`,`mode`,`sd`) %>% \n             dplyr::rename(median = `0.5quant`))\n\n```\n\n###### HPD intervas\n\n```{r}\npar_hpd_jfm = \n# intercept(beta_0)\nbind_rows(\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.fixed$`(Intercept)`)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.fixed$`(Intercept)`)[2],\n           row.names = \"(Intercept)\"),\n# slope (ONI)\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.fixed$JFM)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.fixed$JFM)[2],\n           row.names = \"JFM\") \n)\n\n```\n\n```{r}\npar_jfm = bind_cols(par_summ_jfm,par_hpd_jfm)\n```\n\n##### Hyperparameters\n\n###### Posterior distribution summaries\n\n```{r}\nhyper_summ_jfm = \nround(surv_fit_ONI3$summary.hyperpar, 3) %>% \n  dplyr::select(`mean`,`0.5quant`,`mode`,`sd`) %>% \n  dplyr::rename(median = `0.5quant`)\n```\n\n###### HPD intervas\n\n```{r}\nhyper_hpd_jfm = \nbind_rows(\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.hyperpar$`Precision for season`)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.hyperpar$`Precision for season`)[2],\n           row.names = \"Precision for season\"),\n\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.hyperpar$`Precision for S`)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.hyperpar$`Precision for S`)[2],\n           row.names = \"Precision for S\"),\n\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.hyperpar$`Phi for S`)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.hyperpar$`Phi for S`)[2],\n           row.names = \"Phi for S\"),\n\ndata.frame(HPD_lower = inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.hyperpar$`Precision for baseline.hazard`)[1],\n           HPD_upper = inla.hpdmarginal(0.95, surv_fit_ONI3$marginals.hyperpar$`Precision for baseline.hazard`)[2],\n           row.names = \"Precision for baseline.hazard\")\n)\n```\n\n```{r}\nhyper_jfm = bind_cols(hyper_summ_jfm,hyper_hpd_jfm)\n```\n\n\n\n### Full table of Bayesian estimators\n\n\n```{r}\nfull_table_oni = bind_rows(\nbind_rows(par_jfm,hyper_jfm) %>% \n  rownames_to_column(\"parameter\") %>%\n  mutate(trimester = \"JFM\") ,\n\nbind_rows(par_mjj,hyper_mjj) %>% \n  rownames_to_column(\"parameter\")%>%\n  mutate(trimester = \"MJJ\"),\n\nbind_rows(par_ond,hyper_ond) %>% \n  rownames_to_column(\"parameter\")%>%\n  mutate(trimester = \"OND\")) %>% \n  relocate(trimester) %>% \n  mutate(mean = ifelse(mean<10,round(mean,2), format(round(mean,2), digits = 3, scientific = T)),\n         \n         median = ifelse(median<10, round(median,2), format(round(median,2), digits = 3, scientific = T)),\n         \n         mode = ifelse(mode<10,round(mode,2), format(round(mode,2), digits = 3, scientific = T)),\n         \n         sd = ifelse(sd<10,round(sd,2),format(round(sd,2), digits = 3, scientific = T)),\n         \n         HPD_lower = ifelse(HPD_lower<10,round(HPD_lower,2), format(round(HPD_lower,2), digits = 3, scientific = T)),\n         \n         HPD_upper = ifelse(HPD_upper<10 ,round(HPD_upper,2), format(round(HPD_upper,2), digits = 3, scientific = T))\n         )\n\n```\n\n```{r}\nfull_table_oni\n```\n```{r include=FALSE}\nfile = \"main_enso_onset_files/desktop.ini\"\nif (file.exists(file)) {\n unlink(file)\n cat(\"The file is deleted\")\n}\n```"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"error":false,"eval":true,"cache":false,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","self-contained":true,"css":["styles.css"],"toc":true,"output-file":"main_enso_onset.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"0.9.370","theme":{"light":"flatly","dark":"darkly"},"editor":"source","smooth-scroll":true,"title":"Data analysis"},"extensions":{"book":{"multiFile":true}}}}}